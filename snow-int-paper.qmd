---
title: "Snow Interception Relationships with Meteorology and Canopy Density in a Subalpine Forest"
format: 
  docx:
    reference-doc: ../config/snow-int-paper_NEW2_comp.docx
    number-sections: true
    toc: false
  # pdf:
  #   pdf-engine: latexmk
  #   pdf-engine-opt: -xelatex
  #   colorlinks: false
  #   keep-tex: true
  #   # latex-clean: false # keeps log file
  #   number-sections: true
  #   toc: false
  #   fig-pos: H # makes figs appear in the location specified. without this they sometimes appear in the middle of a paragraph.
    # linestretch: 1.5 # set inline instead
  # html:
  #   toc: false
  #   self-contained: true
# crossref:
#   tbl-prefix: Tbl     # (default is "Table")
#   fig-prefix: Fig
editor: source
bibliography: ../../papers/bibtex/zotero-library.bib
csl: '../../papers/bibtex/csl-styles/apa-disable-disambiguate-add-names.csl'
header-includes:
  - \usepackage[left]{lineno}
  - \linenumbers
  - \usepackage{xcolor}
  - \usepackage{float} # allow tables after section header
  - \floatplacement{table}{H} # allow tables after section header
  - \usepackage{setspace}
---
\setstretch{1.5} 

<!-- From https://onlinelibrary.wiley.com/page/journal/10991085/homepage/forauthors.html - Papers submitted for publication should be concise and not exceed the 7500 word limit. The following sections are included as part of the word count: abstract; main text; and the acknowledgements. The following sections are excluded: title page, including author list and affiliations; bibliography; figure legends and supporting information. Figures and supporting information should be supplied as separate files. -->

```{r, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message=FALSE, warning=FALSE, fig.align='center')

source('scripts/manuscript_values.R')
```

**Authors:**

Alex C. Cebulski^1^ (ORCID ID - 0000-0001-7910-5056)

John W. Pomeroy^1^ (ORCID ID - 0000-0002-4782-7457)

^1^Centre for Hydrology, University of Saskatchewan, Saskatoon, Saskatchewan, Canada

**Corresponding Author:** A.C. Cebulski, alex.cebulski@usask.ca

**Abstract:** Snow accumulation models differ in how snow interception and ablation processes are represented and thus their application to diverse climates and forest types is uncertain. Existing parameterizations of initial snow interception before unloading include inherently coupled canopy snow accumulation and ablation processes. This leads to difficulty in diagnosing processes and adding possible errors to simulations when incorporated as canopy interception routines in models that already account for canopy snow ablation. This study evaluates the theory underpinning parameterizations of initial snow interception using high-temporal resolution and fine-scale measurements of throughfall for events with minimal snow ablation and redistribution in both the canopy and on the ground. The relationship between these throughfall measurements, event meteorology, and a novel lidar-based canopy density measurement are assessed in two subalpine forest plots in the Canadian Rockies. Contrary to existing theories, no association of canopy snow load or air temperature with interception efficiency was observed. Instead, snow-leaf contact area emerged as the primary factor governing snow accumulation. A wind-driven snowfall event demonstrated that non-vertical hydrometeor trajectories can significantly increase snow-leaf contact area, thereby enhancing initial interception before ablation. Prediction of interception efficiency for this event was improved when adjusted for hydrometeor trajectory angle based on a wind speed at one-third of the canopy height. Snow-leaf contact area showed a high sensitivity to wind speed, increasing by up to `r round(ft_frac_inc * 100, 0)`% with a 1 m s^-1^ wind speed. The study proposes a new parameterization that calculates throughfall, independent of processes that ablate snow from the canopy, as a function of snowfall, canopy cover, wind speed, and hydrometeor fall velocity. This new parameterization successfully estimated subcanopy snow accumulation for a snowfall event at two forest plots with different canopy density and structure. By separating canopy snow ablation from snow interception processes, this new model offers potentially improved prediction of subcanopy snow accumulation when combined with canopy snow ablation parameterizations.

**Keywords:** snow interception, throughfall, ablation, forest, snowpack, lidar, process-based modelling

# Introduction

Over half of North America's snow-covered zone is covered by forests [@Kim2017], significantly impacting the accumulation and redistribution of snowpacks and subsequent snowmelt runoff. @Essery2003 estimated that 25–45% of annual snowfall may be lost to the atmosphere due to sublimation of snow intercepted in forest canopies globally. Snow intercepted in the canopy can sublimate and melt at much higher rates than the subcanopy snowpack [@Lundberg1994; @Pomeroy1998b; @Katsushima2023], reducing the amount of snow available for runoff. Canopy density is one of the primary factors controlling the partitioning of snowfall into throughfall and interception [@Hedstrom1998; @Staines2023], and thus governs the quantity of snow subject to sublimation from the canopy. Canopy structure metrics retried such as distance to canopy edge and total gap area have also shown strong correlations to throughfall measurements at the event-based [@Moeser2015b] and seasonal [@Mazzoti2019] timescales though their applicability is limited to regions with fine-scale canopy observations. Despite these relationships, forest thinning efforts aimed at limiting sublimation losses to increase snowmelt runoff do not always lead to a corresponding increase in spring streamflow [@Golding1978; @Harpold2020; @Troendle1983; @Pomeroy2012]. This may be due to increased ablation rates when forest cover is reduced, desynchronization of snowmelt, and sub-surface hydrology interactions [@Ellis2013; @Musselman2015a; @Pomeroy1997; @Varhola2010; @Safa2021]. Given the significant impact of forest cover on snowpacks, along with the limited or absent monitoring networks for subcanopy snow accumulation [@Vionnet2021; @Rittger2020], land management, ecological conservation, and water resource decisions depend on reliable models of snow redistribution.

@Hedstrom1998, working in the cold continental boreal forest, proposed that initial snow interception efficiency was controlled by the maximum canopy load which itself was a function of leaf area index and new snow density. Unloading was found to be an exponential function of time that was observed only days or weeks after the interception event. @Storck2002, working in temperate coastal forests, emphasized the role of leaf area index and air temperature in controlling the maximum canopy snow load. @Gelfan2004 demonstrated accurate subcanopy snowpack simulations at study sites in Russia by treating the @Hedstrom1998 and @Storck2002 parameterizations separately while using a step-based function to choose either parameterization based on air temperature. A similar parameterization in the Cold Regions Hydrological Model [@Pomeroy2022] has shown strong performance at sites across Canada, northern United States, Switzerland, and Spain. However, overestimation of subcanopy snow accumulation was reported by @Lundquist2021 and @Lumbrazo2022 when combining the @Hedstrom1998 routine with ablation parameterizations from different studies [e.g., @Roesch2001]. The coupling of ablation processes within existing snow interception models [@Hedstrom1998; @Storck2002] may contribute to overestimates of throughfall, canopy snow unloading, and canopy snow melt when combined with other canopy snow ablation parameterizations [@Cebulski2025]. Additional observations of snow interception that exclude ablation processes could help determine the applicability of the interception theories proposed by @Hedstrom1998 and @Storck2002. Hedstrom & Pomeroy’s (1998) theory also suggests that moderate wind speeds, which can result in more horizontal hydrometeor trajectories, increasing snow-leaf contact area and interception efficiency at the plot scale. This association has also been shown in rainfall interception studies to decrease throughfall of rain [@Herwitz1995; @VanStan2011]. However, the relationship proposed by @Hedstrom1998, is typically not included in snow accumulation models as empirical testing of this relationship is lacking.

The objective of this paper is to evaluate the theories underlying existing snow interception models using high spatial and temporal resolution measurements of subcanopy snow accumulation for events with minimal canopy snow ablation. These new observations are investigated to address the following research questions: 

  1. Are the existing theories regarding the relationships between meteorology and canopy density and initial snow interception supported by in-situ observations collected in the Canadian Rockies?

  2. Is snow interception influenced by non-vertical hydrometeor trajectory angles over a wind-driven snowfall event? 

  3. To what extent can these findings inform the development of a new parameterization for snow interception?

# Theory

## Canopy snow mass balance

The change in canopy snow load over time, $\frac{dL}{dt}$ (mm s^-1^), can be estimated from the mass balance:

$$
\frac{dL}{dt} = 
[q_{sf} - q_{tf} + q_{ros}] - q_{unld} - q_{drip} - q_{wind}^{veg} - q_{sub}^{veg}
$$ {#eq-canopy-mass-bal}

where $q_{sf}$ is the snowfall rate (mm s^-1^), $q_{ros}$ (mm s^-1^) is the rate of rainfall falling on snow intercepted in the canopy, $q_{tf}$ (mm s^-1^) is the throughfall rate (mm s^-1^), $q_{unld}$ is the canopy snow unloading rate (mm s^-1^), $q_{drip}$ is the canopy snow drip rate due to canopy snowmelt (mm s^-1^), $q_{wind}^{veg}$ is the wind transport rate in or out of the control volume (mm s^-1^), and $q_{sub}^{veg}$ is the intercepted snow sublimation rate (mm s^-1^). Figure 1 in @Cebulski2025 presents a visual representation of this mass balance. 

Interception efficiency, $\frac{I}{P}$ (-), which is the fraction of snowfall intercepted over $\Delta t$ before ablation, can be calculated as:

$$
\frac{I}{P} = \frac{\Delta L}{\overline{q_{sf}} \Delta t}
$$ {#eq-ip}

During periods with low air temperatures and low wind speeds, $q_{ros}$, $q_{unld}$, $q_{drip}$, $q_{wind}^{veg}$, and $q_{sub}^{veg}$ can be assumed negligible and thus the right side of @eq-canopy-mass-bal can be simplified and used as an approximation of $\Delta L$ to calculate $\frac{I}{P}$ as:

$$
\frac{I}{P} = \frac{(q_{sf} - q_{tf})\Delta t}{q_{sf} \Delta t}
$$ {#eq-ip2}

## Hydrometeor trajectory angle

@Herwitz1995 calculate the trajectory angle of a hydrometeor, $\theta_h$, as the departure in degrees (°) from a vertical plane as:

$$
\theta_h = \arctan \left(\frac{x_h(u_z)}{v_h(D_h)}\right)*\frac{180}{\pi}
$${#eq-ta}

where $v_h(D_h)$ is the terminal fall velocity of the hydrometeor (m s^-1^), which is a function of the hydrometeor diameter, $D_h$ and $x_h(u_z)$ is the horizontal velocity of the hydrometeor (m s^-1^) which is a function of the within canopy wind speed, $u_z$ at height above ground, $z$. In the absence of hydrometeor velocity observations, $v_h(D_h)$ may be approximated from values in the literature (e.g., 0.8 m s^-1^ in @Isyumov1971) and $x_h(u_z)$ can be approximated by the horizontal wind speed. This assumes the hydrometeors are following fluid points in the atmosphere.

## Within-canopy wind flow

@Cionco1965 show that, $u_z$ may be approximated using the exponential formula:

$$
u_z = u\cdot exp\left[a\cdot\left(\frac{z}{h_c}-1\right)\right]
$${#eq-cionco}

where $u$ is the horizontal wind speed at the top of the canopy (m s^-1^), $a$ is an attenuation coefficient, $z$ is the height above ground (m), and $h_c$ is the average height of the canopy elements. @Parviainen2000 provided a method to calculate $a$ using observations from two jack pine stands, which was applied in this study.

# Data and methods

## Study site

This study was conducted at Fortress Mountain Research Basin (FMRB), Alberta, Canada, -115° W, 51° N, a continental headwater basin in the Canadian Rockies (@fig-site-map). Data from this study was collected between October 2021 and July 2023 within and surrounding two forest plots adjacent to the FMRB Powerline Station (PWL) and Forest Tower Station (FT) at ~2100 m above sea level as shown in @fig-site-map. The average annual precipitation at PWL Station from 2013 to 2023 was 1045 mm, with the peak annual snow water equivalent (SWE) reaching 465 mm, typically occurring in late April. The PWL plot is adjacent to PWL station and the FT plot surrounds FT station and both include discontinuous stands of 70% subalpine fir (Abies lasiocarpa) and 30% Engelmann spruce (Picea engelmannii) [@Langs2020]. The canopy closure of the two forest plots are `r pwl_cc_nadir` and `r ft_cc_nadir` and the winter leaf area indices are 2.07 and 1.66 for PWL and FT respectively. The average height of the canopy within the PWL plot is `r pwl_mean_ht` m and within the FT plot is `r ft_mean_ht` m. In August of 1936, the majority of vegetation in FMRB burned during a large forest fire that affected most of the Kananaskis Valley [@Fryer1988]. Following the fire, the forest within the PWL and FT forest plots has naturally regenerated, though some trees have been removed for road clearing and creation of a snow study plot.

![Map showing the location of forest plots, flux towers, subcanopy lysimeter instruments (SCL), and survey transects. The inset map on the lower right shows the regional location of Fortress Mountain Research basin.](figs/maps/site_map_inset.png){#fig-site-map}

## Meteorological measurements

Measurements of air temperature and relative humidity (Vaisala model HMP155A), wind speed and direction (RM Young model 86000 2-D ultrasonic anemometer) were made 4.3 m above the ground at FT station (@fig-site-map). Wind speed measurements from a 3-cup anemometer (Met One model 014A), installed adjacent to the 2-D ultrasonic anemometer at 4.3 m, were used to fill data gaps in the 2-D ultrasonic anemometer records. 

At PWL station, the snowfall rate was measured by an Alter-shielded OTT Pluvio weighing precipitation gauge 2.6 m above ground, corrected for undercatch following phase correction by @Harder2013 and catch efficiency by @Smith2007. The instrument accuracy of the OTT Pluvio specified in the instrument manual is +/- 0.1 mm or 0.2% (whichever is larger). Wind speed for undercatch correction was measured by a 3-cup anemometer (Met One model 014A) at a height of 2.6 m at PWL station. An optical disdrometer (OTT Parsivel2) provided measurements of hydrometeor particle size and vertical velocity. All measurements were recorded at 15-min intervals using Campbell Scientific dataloggers, except the Parsivel2 which was recorded at 1-minute intervals by an onsite computer.

## Lysimeter measurements

Three subcanopy lysimeters (SCLs) were installed surrounding the FT Station (@fig-site-map) to provide measurements of throughfall for 26 distinct snowfall events, where canopy snow ablation rates were deemed negligible. The SCL instrument design was adapted from @MacDonald2010 and consisted of a plastic horse-watering trough with an opening of 0.9 m^2^ and depth of 20 cm suspended from a load cell (Intertechnology 9363-D3-75-20T1) attached to an aluminum pipe connected between two trees (@fig-scl-imgs). The manufacturer-specified combined error of full scale output for the load cells is +/- 0.02% with a temperature sensitivity of +/- 0.001%/5°C. The throughfall rate was calculated by dividing the weight of snow in the SCL by the cross-sectional area of the opening and determining the rate of change at 15-minute intervals. Canopy snow load was estimated using @eq-canopy-mass-bal, incorporating cumulative throughfall measurements from the SCLs and cumulative snowfall measurements from the PWL gauge for each of the 26 events. Interception efficiency was calculated using @eq-ip2 and accumulated measurements of snowfall and throughfall at both hourly intervals and within bins of air temperature, wind speed, and initial canopy snow load measured from the weighed tree. The hourly interval measurements resulted in lower accumulations of snowfall and throughfall within each interval and thus had higher relative error compared to the binned measurements. To evaluate the association of hourly interception efficiency with these three variables linear models were fitted using ordinary least squares regression. The non-parametric Wilcoxon signed-rank test was also applied to compare the distribution of hourly interception efficiency measurements across differing groups of air temperature, wind speed, and initial canopy snow load. Timelapse imagery, mass change on a weighed tree lysimeter [@Pomeroy1993a], and in-situ observations were used to ensure unloading, melt, and wind redistribution of canopy snow was minimal over each interval. Additionally, the throughfall measurements were filtered to include observations that coincided with a snowfall rate > 0 mm hr^-1^ and a snowfall rate that exceeded the SCL measured throughfall rate. While these careful manual mitigation and automated filtering strategies substantially reduce the contribution of unloading in the SCL throughfall measurements, a small contribution is still possible.

The SCLs were installed to limit preferential throughfall and unloading by choosing locations with relatively uniform distribution of canopy elements and away from large branches which could preferentially unload snow. The canopy surrounding the SCLs led to reduced wind speeds and reduced the potential for gauge undercatch by the SCLs. The "mixed" canopy SCL had a slight canopy opening, shown in @fig-scl-imgs, orientated towards the prevailing wind direction observed during the study period which allowed some preferential measurement of throughfall for snowfall trajectories aligned with this gap. Photographs of the three SCLs and surrounding canopy are shown in @fig-scl-imgs. Measurements of canopy density including leaf area index and canopy closure were provided for each SCL and are presented in @tbl-scl-lai-cc. A viewing angle from zenith to 60° was selected to describe the SCLs, as a range in hydrometeor trajectory angles were expected to influence the measurements at these locations. The canopy density metrics were measured using hemispherical photography (Nikon Coolpix 4500 and EC-F8 hemispherical lens) for a snow free canopy and analyzed with the hemispheR R package @Chianucci2023.

The weighed tree lysimeter, a live subalpine fir (Abies lasiocarpa) tree suspended from a load cell (Artech S-Type 20210-100) measured the weight of canopy snow load (kg). This weight was scaled to an areal estimate of canopy snow load ($L$, mm) using measurements of areal throughfall (mm) from in-situ snow surveys and snowfall from the PWL Station snowfall gauge, following the method described in @Pomeroy1993a. Three sets of in-situ snow survey locations were selected for scaling, each with a mean canopy closure corresponding to one of the SCLs. This resulted in three datasets of canopy snow load from the weighed tree, each reflecting the canopy density of a respective SCL. Variations in the weighed tree mass was attributed to intercepted snowfall, canopy snow sublimation, unloading, and melt. Since the subcanopy lysimeter estimates of canopy snow load are not influenced by sublimation, they provided a measurement of interception efficiency with less uncertainty and thus were used for the interception efficiency analyses.

```{r scl, echo=FALSE}
#| label: tbl-scl-lai-cc
#| tbl-cap: "Leaf area index (LAI) and canopy closure of the three subcanopy lysimeters (SCL) located proximal to the FT Station."

scl_lai_cc |> 
  arrange(cc) |> 
  mutate(cc = round(cc, 2)) |> 
  filter(vza == 60) |> 
  select(Name = trough_name, `LAI (-)` = Le, `Canopy Closure (-)` = cc) |> 
  knitr::kable(#booktabs = TRUE,
               #format = 'latex'
               )
```

![Images of the three subcanopy lysimeters (SCL) and surrounding canopy located in sparse (a), mixed (b), and dense (c) canopy. The top row presents a side view of each SCL and the bottom row shows hemispherical photographs. These hemispherical images are oriented with north at the top and have been mirrored to provide a view from above (e.g., east is on the right side of each image). See @tbl-scl-lai-cc for the canopy density measurements above each SCL.](figs/site-photos/scl_w_fisheye_textnew.png){#fig-scl-imgs}

## UAV-Lidar data collection and processing

The UAV (FreeFly Alta X) payload included a REIGL miniVUX-2 airborne laser scanner, an Applanix APX-20 inertial measurement unit (IMU) and global navigation satellite system (GNSS). The UAV was flown 90 m above the ground at a speed of 3 m s^-1^ following the path shown in @fig-site-map. The methods outlined by @Harder2020 and @Staines2023 were incorporated to reconcile survey lidar, IMU and GNSS data. A systematic vertical bias of up to 6 cm between UAV-lidar flight lines was observed in the resulting point clouds on March 13^th^ and 14^th^, 2024 and was attributed to IMU position drift. After strip alignment, the mean elevation bias in the point clouds compared to the GNSS data was 0.000 m and the RMS error declined from 0.055 m to 0.038 m on March 13^th^ and changed from 0.033 m to 0.029 m on March 14^th^. The point cloud density ranged from ~1200 returns m^2^ in sparse forest to ~2200 returns m^2^ in open clearings. Quality control, ground classification, calculation of surface elevation change was conducted on the point cloud data and then converted to 0.05 m resolution rasters. Further quality control was conducted on the 0.05 m raster data to remove values that exceeded the .999th quantile and then resampled to 0.25 m grid cell resolution by taking the median. A detailed description of the UAV, payload, flight settings, and software packages used is provided in the supporting information.

## Snow surveys

### In-situ snow depth and density

Event-based snow surveys provided measurements of subcanopy throughfall depth and density at 30 locations following the transects shown in @fig-site-map. These measurements were used to upscale the weighed tree from weight to weight per unit area, assess the accuracy of lidar derived snow depth measurements, and provide a fresh snow density for the calculation of SWE (mm) from the snow depth measurements. Minimal ablation and redistribution of both the surface snowpack and/or snow intercepted in the canopy was crucial to ensure the snow survey measurements were attributed to throughfall. Therefore, only snowfall events with minimal canopy snow ablation as determined through in-situ observations, analysis of timelapse imagery, and mass change on the weighed tree lysimeter were selected. A 1000 cm^3^ Perla snow density wedge sampler (RIP Cutter, https://snowmetrics.com/shop/rip-1-cutter-1000-cc/) was used to measure the density of the fresh snow layer, $\overline{\rho_{tf}}$ (kg m^-3^) from snow pits. Throughfall depth measurements, $\Delta HS$ were converted to SWE using the following equation:

$$
\Delta SWE_{tf} = \Delta HS \cdot \overline{\rho_{tf}}
$${#eq-swe-tf}

If a pre-event crust layer was present, the depth of post event fresh snow accumulation above the crust layer was interpreted as throughfall over the event. In the absence of a defined crust layer, the difference in pre- and post-event snow depth to ground was interpreted as event throughfall.

### UAV-Lidar snow depth

Two uncrewed aerial vehicle (UAV) lidar surveys were conducted before and after a 24-hour snowfall event that occurred between March 13–14^th^, 2023 to facilitate the measurement of snow accumulation and canopy density within the FT and PWL forest plots. This period was selected based on two criteria: 1) it provided sufficient cumulative snowfall to result in a low relative error in UAV-lidar measured throughfall, and 2) minimal snow redistribution and ablation was observed, as confirmed by the SCLs, weighed tree, and time-lapse imagery. The change in surface elevation between the two UAV-lidar point clouds was interpreted as the increase in snow accumulation, $\Delta HS$, over the snowfall event. $\Delta SWE_{tf}$ was calculated using @eq-swe-tf together with in-situ measurements of $\overline{\rho_{tf}}$. The measurement error of the UAV-lidar derived $\Delta HS$ was assessed using the in-situ snow depth observations which is shown in the supporting information. Spatially distributed measurements of $\frac{I}{P}$, were then determined using @eq-ip2 by using $\Delta SWE_{tf}$ as the throughfall component ($q_{tf} \Delta t$) and the snowfall accumulation to the open ($q_{sf} \Delta t$) measured between the two lidar surveys at PWL station.

## UAV-Lidar canopy metrics

The canopy of the study site was characterized from two UAV-lidar point clouds (March 13^th^ and March 14^th^) using the voxel ray sampling (VoxRS) methodology for lidar data analysis, as developed by @Staines2023. This method was chosen for its ability to provide canopy metrics that are less sensitive to the inherent non-uniform nature of lidar sampling data, which often results from beam occlusion in vegetation and leads to reduced points near the ground. Using this method radiation transmittance, $\tau$ (-), was measured across the hemisphere at a 1° step, e.g., azimuth angles (0°, 1°, ..., 359°) and zenith angles (0°, 1°, ..., 90°) for each 0.25 m grid cell within the FT and PWL forest plots. The fraction of snow-leaf contact area per unit area of ground proposed by @Hedstrom1998, and hereafter called leaf contact area ($C_p$), was then calculated as:

$$
C_p(C_c, \theta_h) = 1-\tau
$${#eq-lca}

$$
C_p(C_c, \theta_h) = \begin{cases}
    1-\tau,& \text{if } \theta_h> 0°\\
    1-\tau \approx C_c ,              & \theta_h= 0°
\end{cases}
$${#eq-tf-ode}

where $C_p$ is a function of the canopy cover ($C_c$) and hydrometeor trajectory angle ($\theta_h$). $C_c$ is the fraction of canopy area to total ground area when viewed from above, which differs from canopy closure, an angular-derived metric usually measured from the ground perspective. 

To determine how $C_p$ was associated with interception efficiency at different azimuth and zenith angles over the March 13–14^th^ snowfall event, the entire hemisphere at each grid location was considered. The relationship between interception efficiency and $C_p$ was found to be linear and thus the Pearson Correlation Coefficient ($\rho_p$) was used. The $\rho_p$ was computed between a single raster of interception efficiency and each of the 32,760 rasters of $C_p$ measured on March 13^th^, representing locations across the hemisphere (azimuth [0°, 1°, ..., 359°], zenith angle [0°, 1°, ..., 90°]) at 0.25 m grid cells spanning the FT and PWL forest plots. 

The pair of azimuth and zenith angles corresponding to the $C_p$ that had the highest correlation with interception efficiency was selected for further analysis. This involved aggregating the interception efficiency and selected $C_p$ rasters from a 0.25 m resolution to 5 m, followed by fitting an ordinary least squares regression between these two variables. The regression was constrained to pass through the origin based on the theoretical principle that the dependent variable must equal zero when the independent variable is zero. To appropriately account for this constraint, the *R*^2^ values were adjusted according to Equation 10 presented in @Kozak1995. The relationship between leaf contact area and simulated trajectory angle was investigated by fitting non-linear models using a non-linear least squares regression. All statistical analyses were performed using the R 'stats' package [@R2024].

# Results

## The influence of meteorology on snow interception

Canopy snow load estimated from the SCLs and weighed tree increased linearly with cumulative event snowfall without evidence of reaching a maximum for 26 snowfall events (@fig-scl-w-sf). Over these events, air temperature ranged from `r sf_event_t_range[1]`°C to `r sf_event_t_range[2]`°C, wind speeds at 4.3 m height ranged from calm to `r sf_event_u_range[2]` m s^-1^ (@tbl-sf-event-met), and wind direction was predominately from the southwest during snowfall (@fig-wind-rose). Missing canopy snow load measurements, as shown in @fig-scl-w-sf for certain events, were caused by wiring damage from animals and heavy snow loads. Some of the variability in interception rates within and between different events may be attributed to small amounts of canopy snow unloading and melt, which could not be fully accounted for through the manual and automated filtering mitigation strategies in both the SCL and weighed tree measurements. 

![Plot showing the cumulative event snowfall versus canopy snow load calculated using the mean of the three subcanopy lysimeters (left) and weighed tree lysimeter (right) for each of the 26 snowfall events. Both datasets represent canopy snow load for a canopy closure of `r scl_cc_mean` corresponding to the mean of the three SCL canopies. ](figs/automated_snowfall_event_periods/cuml_event_snowfall_canopy_storage_avg_of_scls_and_w_tree.png){#fig-scl-w-sf}

\pagebreak
\setstretch{1.0} 
```{r tbl-sf-event-met, echo=FALSE}
#| label: tbl-sf-event-met
#| tbl-cap: "Meteorology of the 26 snowfall events. Air temperature and wind speed were measured at FT station. Interception efficiency is estimated from cumulative snowfall measured at PWL station and the average cumulative throughfall of all three SCLs located within the FT forest plot."

pretty_table <- readRDS('data/event_avgs_maxmin_pretty_gt_table.rds')
pretty_table
# gt::as_raw_html(pretty_table)

# knitr::include_graphics('figs/event_avgs_maxmin_pretty_gt_table_screenshot.png')
```
\setstretch{1.5}

![Wind rose showing the frequency of wind speed and direction over the 26 snowfall periods for the ultrasonic anemometer 4.3 m above ground at FT station.](figs/automated_snowfall_event_periods/ft_wind_rose_allevents_snowing_custom_dimensions.png){#fig-wind-rose width=60%}

<!-- bins stats calculated as: max(c(at_ip_smry$bin_del_tf, ws_ip_smry$bin_del_tf, w_ip_smry$bin_del_tf)) -->

The linear regression analysis revealed no relationship between hourly interception efficiency (from the SCLs) and variables of air temperature, wind speed or canopy snow load, either due to non-significant relationships (*p* < 0.05) and/or weak predictive power (*R*^2^ < 0.05) (@tbl-lysimeter-hourly-stats). The Wilcoxon rank-test indicated that the difference in hourly interception efficiencies for air temperatures above and below -5°C was not significant (*p* > 0.05, @tbl-scl-hrly-stats). Additionally, the average interception efficiency across differing bins of air temperature also does not show any systematic pattern (@fig-scl-ip-bins). Although @fig-scl-ip-bins indicates potentially higher interception efficiency in sparse and mixed canopies at air temperatures below -10°C, these measurements have substantial uncertainty due to heightened instrument error associated with minimal accumulated snowfall and throughfall within these temperature ranges.

When examining wind speed effects, hourly interception efficiency was found to be significantly higher (*p* < 0.05, @tbl-scl-hrly-stats) during periods when wind speeds exceeded 1 m s^-1^ compared to calmer conditions in the sparse and closed canopies using the Wilcoxon rank-test. The binned data also show an increase in interception efficiency with increasing wind speed for these two canopy types (Figure 6b). (@fig-scl-ip-bins). In contrast, the mixed canopy, which had a canopy opening towards the prevailing wind direction (@fig-scl-imgs), exhibited no significant difference (*p* > 0.05, @tbl-scl-hrly-stats). Binned measurements of interception efficiency corresponding to wind speed bins above 2 m s^-1^ (@fig-scl-ip-bins) contained considerable uncertainty resulting from lower snowfall and throughfall accumulation, reducing confidence in these particular findings across all three canopy environments.

A significantly higher hourly interception efficiency (*p* < 0.05, @tbl-scl-hrly-stats) was found for initial canopy snow loads below 10 mm compared to heavier snow loads across all three canopy types using the Wilcoxon rank-test. Additionally, the sparse and mixed canopies exhibited significantly lower interception efficiency (*p* < 0.05) for snow loads below 5 mm compared to those between 5–10 mm. The closed canopy displayed a similar initial increase for the binned data visible in @fig-scl-ip-bins, but this was not statistically significant for the hourly data (*p* > 0.05, @tbl-scl-hrly-stats). For the sparse and closed canopies, a slight increase in binned interception efficiency was observed as snow load increased up to 10 mm, followed by a decline when snow loads exceeded 10 mm (@fig-scl-ip-bins). For snow loads exceeding 15 mm, @fig-scl-ip-bins reveals decreasing interception efficiency in the sparse and closed canopies, while the mixed canopy showed an increase; however, these measurements carried high uncertainties due to lower accumulated snowfall and throughfall in these higher snow load bins. The differences between the relationships observed in the hourly-interval and binned interception efficiency measurements can be attributed to two factors: greater instrument uncertainty in the hourly measurements, and the potential for the dependent and independent variables to be non-stationary over the hourly interval.

```{r tbl-lysimeter-hourly-stats, echo=FALSE}
#| label: tbl-lysimeter-hourly-stats
#| tbl-cap: "Statistics corresponding to the ordinary least squares linear regression test between hourly interval measurements of independent variables: mean air temperature, mean wind speed, and initial canopy snow load and the dependent variable mean interception efficiency. The test was run separately for three levels of canopy coverage ($C_c$)."

lysimeter_hourly_mod_smry |> 
  select(-r.squared) |> 
  mutate(across(where(is.numeric), round, 3),
         # trough_name = factor(trough_name, levels = c('sparse', 'mixed', 'closed')),
         cc = round(cc, 2),
         pretty_name = ifelse(
           pretty_name == 'Initial Canopy Snow Load (kg m⁻²)',
           'Initial Canopy Snow Load ($\\text{kg m}^{-2}$)',
           pretty_name)) |>
  arrange(pretty_name, trough_name) |>  # Order by trough_name
  knitr::kable(
    col.names = c(
    "Dependent Variable",
    "SCL Name",
    "$C_c$",
    # "$R^2$",
    "Adjusted $R^2$",
    "$p$-value",
    "$n$"
  )
)

```

![Scatter plots showing the interception efficiency calculated from accumulated snowfall (Pluvio) and throughfall (SCL) measurements for bins of air temperature, wind speed, and initial canopy snow load (the snow load observed by the weighed tree at the beginning of the timestep) over the 26 snowfall events. The error bars represent the estimated combined instrument error of the snowfall gauge and SCLs.](figs/automated_snowfall_event_periods/troughs_met_vs_IP_accumulated_bin.png){#fig-scl-ip-bins}

```{r tbl-scl-hrly-stats, echo=FALSE}
#| label: tbl-scl-hrly-stats
#| tbl-cap: "Results of the Wilcoxon signed-rank tests comparing interception efficiency (IP) measured by the SCLs for differing groups of air temperatures (Ta), wind speeds (u), and initial canopy snow loads (L). The table reports the canopy corresponding to the SCL (Canopy), null hypothesis ($H_0$), $p$-value, and sample size ($n$) and median IP for for the 'low' group (e.g., Ta < -5°C) and 'high' group (e.g., Ta ≥ -5°C). The null hypothesis was rejected based on $\\alpha = 0.05$."
#| tbl-colwidths: [12, 30, 12, 18, 15, 13]

scl_hourly_stats  |>
  mutate(n_samples_low_high = paste0(n_samples_low, ' / ', n_samples_high),
         median_ip_low_high = paste0(median_low, ' / ', median_high)) |> 
  select(trough_name:p.value, n_samples_low_high, median_ip_low_high, reject_null_hyp) |> 
  knitr::kable(
    # digits = 2,
      col.names = c(
      # "Test",
      "Canopy",
      "Null Hypothesis ($H_0$)",
      "$p$-value",
      "$n$ (low / high)",
      "median I/P (low / high)",
      "Reject $H_0$"
    )
  )
```

## The influence of canopy density on snow interception

UAV-lidar measurements of throughfall and canopy density provide insights on how the forest canopy influenced subcanopy snow accumulation during a wind-driven snowfall event between March 13–14^th^. This event totaled `r event_sf` mm of snowfall at PWL station and was characterized by a transition from low rates of snowfall and air temperatures near 0°C to higher rates of snowfall by late afternoon on March 13^th^ coinciding with air temperatures around -2.5 °C. An average wind speed of 1.3 m s^-1^ and direction of 188° was observed 4.3 m above the ground at FT Station. The mean observed hydrometeor terminal velocity observed over the event was 0.9 m s^-1^.

The throughfall depth measured by UAV-lidar aligned with the in-situ manual measurements resulting in a mean bias of -0.001 m and RMSE of 0.024 m. More details on the accuracy of UAV-lidar snow depth measurements are provided in the supporting information section. @fig-lidar-tf-ip shows the spatial distribution of throughfall and interception efficiency at the PWL and FT forest plots. Reduced throughfall and greater interception efficiency was observed on the north (lee) side of individual trees, which may be due to non-vertical hydrometeor trajectories caused by the steady southerly winds observed over this event. Transparent areas within the forest plots in @fig-lidar-tf-ip represent grid cells that did not have any lidar ground returns (e.g., under dense canopy proximal to tree trunks) or were masked due to disturbance (e.g., walking paths in clearings). Visual observations on March 13^th^ and 14^th^ confirmed non-vertical hydrometeor trajectories and increased canopy snow loads were observed on the windward side of individual trees. This effect is shown in @fig-lidar-tf-ip to be more apparent in the PWL forest plot than the FT forest plot. This may be attributed to the taller trees and higher canopy cover of the PWL forest plot compared to the FT forest plot, as for the same trajectory angle a taller tree will produce a larger downwind footprint.

![UAV-lidar measurements of the change in snow water equivalent, SWE (mm) and interception efficiency, I/P (-), over the March 13–14^th^ 24-hour snowfall event for the FT and PWL forest plots at a 0.25 m resolution. See the location of the two forest plots in @fig-site-map.](figs/external_figures/facet_ft_pwl_23_072_23_073_v2.0.0_saswe_and_ip_normalised_resample_0.25.png){#fig-lidar-tf-ip}

The VoxRS measurements of $C_p$ on March 13^th^ were selected for analysis and represent the canopy of both forest plots without snow. Little difference in $C_p$ was observed between the March 13^th^ and March 14^th^ VoxRS measurements. @fig-hemi-ip-cc shows a strong linear correlation between $C_p$ measured on March 13^th^ and interception efficiency towards the southern portion of the hemisphere, aligning with the average event wind direction. For the PWL forest plot, the upper 97.5^th^ percentile of the Pearson Correlation Coefficient ($\rho_p$) values shown in @fig-hemi-ip-cc, were found between azimuth angles of `r pwl_theta_from`°–`r pwl_theta_to`°. Similarly, for the FT forest plot, the upper 97.5^th^ percentile of $\rho_p$ was found between azimuth angles of `r ft_theta_from`°–`r ft_theta_to`°. The zenith angle found to have the highest correlation over this azimuth range was `r pwl_best_phi`° ($\rho_p$ = `r pwl_best_phi_rho`) and `r ft_best_phi`° ($\rho_p$ = `r ft_best_phi_rho`) for PWL and FT respectively. The high correlation coefficients found for non-vertical zenith angles for both PWL and FT are hypothesized to result from non-vertical hydrometeor trajectories.

![The Pearson Correlation Coefficient between rasters (0.25 m resolution) of interception efficiency and leaf contact area (measured on March 13th) for each grid cell across the study site for each azimuth angles (0°, 1°, ..., 359°) and zenith angles (0°, 1°, ..., 90°) for the FT (left) and PWL (right) forest plots.](figs/external_figures/full_hemi_rho_p_cor_lca_ip_23_072_vox_len_0.25m_sa_gridgen_v2.0.0_sa_ft_pwl_.png){#fig-hemi-ip-cc}

An estimate of $C_p$ that represented the event was selected from the VoxRS measurements based on the vector corresponding to the azimuth and zenith angles observed to have the highest $\rho_p$ in @fig-hemi-ip-cc. The spatial distribution of the selected VoxRS $C_p$ measurements is shown in @fig-lidar-cc-cp and generally aligns with the spatial distribution of interception efficiency and throughfall shown in @fig-lidar-tf-ip.

![UAV-lidar VoxRS measurements of leaf contact area measured on March 13^th^ for the PWL and FT forest plots for zenith angles (PWL = 22°, FT = 21°) and azimuth angles (PWL = 167°, 178°, ... 217°; FT = 171°, 172°, ... 223°).](figs/external_figures/facet_ft_pwl_23_072_vox_len_0.25m_sa_gridgen_v2.0.0_sa__leaf_contact_area_event_traj_25cm.png){#fig-lidar-cc-cp}

@fig-lca-vs-ip shows the correlation between interception efficiency (@fig-lidar-tf-ip) and $C_p$ (@fig-lidar-cc-cp), resampled to a 5 m grid resolution, was higher compared to the association with leaf contact angle measured at a zenith angle of 0°. The stronger association for the vector-based calculation suggests that adjusted $C_p$ is a useful predictor of interception efficiency before ablation. An ordinary least squares linear regression forced through the origin was fit to the observed data points using the following equation:

$$
  \frac{I}{P} = C_p(C_c, \theta_h) \cdot \alpha
$${#eq-lca-ip}

where $\alpha$ is an efficiency constant which determines the fraction of snowflakes that contact the $C_p$ elements and are stored in the canopy (i.e., intercepted) before canopy snow unloading or ablation processes begin.

![Scatter plots showing the relationship between leaf contact area and interception efficiency rasters resampled to a 5 m grid cell resolution. The left plot (nadir) shows leaf contact area measured from a zenith angle of 0°. The right plot (Vector Based) shows the leaf contact area averaged over rasters with zenith angles (PWL = 22°, FT = 21°) and azimuth angles (PWL = 167°, 178°, ... 217°; FT = 171°, 172°, ... 223°). The solid lines (Model fit) show an ordinary least squares linear regression forced through the origin and fitted to the PWL (red) and FT (black) data and the light grey dotted line shows a 1:1 line. The *R*^2^ values for the four different models are shown in the upper left of each panel calculated following the methods outlined in @Kozak1995.](figs/external_figures/pwl_ft_lca_vs_ip_phi_nadir_adjusted_resample_w_mods_5m.png){#fig-lca-vs-ip}

For the vector-based model, the relationship between interception efficiency and $C_p$ results in *R*^2^ values of `r pwl_r2_val` and `r ft_r2_val` for PWL and FT respectively. The increase in interception efficiency with $C_p$ follows a reduced slope compared to the nadir models with $\alpha$ values of `r pwl_a_val` and `r ft_a_val` for the PWL and FT vector-based models respectively. The reduced slope for the vector-based models may be due to snowflakes that weaved through and/or bounced off branch elements in addition to UAV-lidar throughfall measurement uncertainty which may have been slightly affected by unloading and redistribution. These processes would have reduced the fraction of snowfall that was stored in the canopy. Model error statistics are presented in @tbl-ip-mod-err for the nadir and vector-based models and show the vector-based model provided a better prediction of interception efficiency. Some of the scatter observed in the nadir model shown in @fig-lca-vs-ip may be explained by grid cells within canopy gaps which observed a greater interception efficiency compared to the corresponding canopy cover. Conversely, grid cells where interception efficiency is less than the canopy cover, may be affected by non-vertical trajectory hydrometeors making their way underneath the canopy as observed by the reduced interception efficiency on the windward edges of individual trees in @fig-lidar-tf-ip. The latter may explain the non-linear relationship observed for the PWL nadir calculation in @fig-lidar-tf-ip. 

\pagebreak

```{r tbl-ip-mod-err, echo=FALSE}
#| label: tbl-ip-mod-err
#| tbl-cap: "Model error statistics for predictions of interception efficiency using @eq-lca-ip and for different $a$ values, as shown in the Model Slope column. Statistics are provided for the PWL and FT forest plots, using leaf contact area canopy metrics adjusted to zenith angles of (0°, 1°, ... 30°) and azimuth angles (170°, 171°, ... 220°) and nadir zenith angle of 0°. The Mean bias is the difference in the model and observed values, MAE is the mean of the absolute error, RMS Error is the root mean squared error, *R*^2^ is the coefficient of determination adjusted using Equation 10 in @Kozak1995."
#| tbl-colwidths: [10, 25, 15, 15, 10, 12, 13]

mod_error |> 
  rename(`R^2` = R2_adj,
         `Mean Bias (-)` = `Mean Bias`,
         `MAE (-)` = MAE,
         `RMS Error (-)` = `RMS Error`,
         `Canopy Calculation` = `Canopy Metrics`) |> 
  mutate(`R^2` = round(`R^2`, 2),
         `R^2` = ifelse(`R^2`<0, NA, `R^2`),
         `Model Slope` = round(`Model Slope`, 2)) |>
  select(-R2_base) |> 
  knitr::kable(
     col.names = c(
    "Plot Name",
    "Canopy Calculation",
    "Model Slope (-)",
    "Mean Bias (-)",
    "MAE (-)",
    "RMS Error (-)",
    "$R^2$"))

```

## The combined influence of trajectory angle and canopy density on snow interception

@fig-lca-ht-ws shows that $C_p$, measured from VoxRS prior to snowfall on March 13^th^, increases substantially with simulated hydrometeor trajectory angle and corresponding simulated wind speed. The standard deviation in VoxRS measured $C_p$, illustrated by the shaded area in @fig-lca-ht-ws, exhibits the broad range in values for individual grid cells across each forest plot. Despite this large scatter, a systematic increase in the mean $C_p$ across both forest plots results from a rise in the number of canopy elements for more horizontal angles, when averaged across each forest plot, over all azimuth angles (see top left panel @fig-lca-ht-ws). This results in a large rise in $C_p$ over relatively common wind speeds. For example, with a wind speed of `r select_wind_speed` m s^-1^ and estimated trajectory angle of `r ta |> round(0)`°, $C_p$ would increase by `r pwl_inc |> round(2)` and `r ft_inc |> round(2)` for the PWL and FT forest plots respectively (@fig-lca-ht-ws). This is a fractional increase in the plot $C_p$ from nadir of `r round(pwl_frac_inc, 2)` and `r round(ft_frac_inc, 2)` for PWL and FT respectively. The increase in $C_p$ from $C_c$, with increasing trajectory angle is shown on the bottom row of @fig-lca-ht-ws and exhibits a similar relationship for both forest plots FT and PWL until trajectory angles reach approximately 60°. Beyond 60°, the PWL rate of increase slows as the $C_p$ approaches 1.0, while the FT plot, which has lower $C_c$, continues to rise until around 75° as a $C_p$ of 1.0 is approached. $C_p$ was also quantified across trajectory angles for both PWL and FT on March 14^th^, post snowfall, and showed a negligible increase in $C_p$ compared to $C_p$ measured on March 13^th^ without snow in the canopy. 

<!-- These figures are generated under the lidar-processing project using scripts 11-13. Recently sped up the processing for these and can now be run locally. See https://github.com/acebulsk/lidar-processing -->

![Plots showing the relationship between hydrometeor trajectory angle (left column) and wind speed (right column) with mean plot-wide snow-leaf contact area, $C_p$ (top row) and the increase in mean plot-wide $C_p$, i.e., $C_p - C_c$ (bottom row). The simulated hydrometeor trajectory angle is measured as degrees from zenith. Simulated wind speed was calculated as a function of hydrometeor trajectory angle by rearranging @eq-ta and an observed event hydrometeor fall velocity of 0.9 m s^-1^. The solid lines (VoxRS) represent the mean $C_p$ (top row) or increase in mean $C_p$ (bottom row) for a single zenith angle observed from VoxRS across all grid cells for each forest plot and across all azimuth angles. The shaded area represents 1 standard deviation above and below the observed VoxRS mean. The dashed lines (Fitted) represent predictions from @eq-lca-ac (top row) and @eq-lca-inc (bottom row). The dotted lines (HP98) represent the predictions from Equation 10 in @Hedstrom1998. A forested downwind distance of 100 m was assumed for the HP98 calculation.](figs/external_figures/WITH_TREEWELLS_traj_angle_and_wind_single_zenith_1_thetaby_1_traj_angle_wind_speed_vs_cowplot_lca_and_inc_w_mods_mean_sd_23_072.png){#fig-lca-ht-ws}

A function is proposed here to calculate plot-scale leaf contact area, $C_p$ (-):

$$
C_p = C_c + C_{inc}(\theta_h, C_c)
$${#eq-lca-ac}

where $C_{inc}$ represents the increase in leaf contact area from $C_c$, and it is a function of $\theta_h$ and $C_c$. To estimate $C_{inc}$ in the absence of detailed canopy measurements, the following function is proposed:

$$
C_{inc} = (1-C_c)\cdot f(\theta_h)
$${#eq-lca-inc}

where $1-C_C$ quantifies the available void space within the canopy and $f(\theta_h)$ represents the fraction of that space that contributing to increased leaf contact area. Here, $f(\theta_h)$ is approximated as:

$$
f(\theta_h) = b \cdot\text{sin}(\theta_h)^2
$${#eq-f-theta}

where $b$ is a fitting coefficient, estimated to be ~`r nls_sin_coefs[['b']]` through a non-linear least squares regression fit to the VoxRS measurements at both FT and PWL. The term $\text{sin}(\theta_h)^2$ reflects the relative increase in snow-leaf contact area, which in turn leads to a proportional decrease in the canopy void space ($1-C_c$). Thus, for $\theta_h$ of 0°, $C_p$ is equal to the canopy cover. In contrast, for $\theta_h$ close to 90°, $C_p$ approaches a value of 1.0. The assumptions of @eq-f-theta include that $C_c$ represents a measurement of continuous canopy cover without large open areas many times greater than the mean canopy height; and that snowfall trajectories are linear.

Simulated $C_p$ using @eq-lca-ac is shown in the dashed lines in the top row of @fig-lca-ht-ws and follows the VoxRS-measured mean $C_p$ closely. Model error statistics shown in @tbl-lca-mod-err demonstrate that @eq-lca-inc performed well, with a mean bias and RMSE of `r pwl_errs_nls$MB` (-) and `r pwl_errs_nls$RMSE` (-) for PWL, and `r ft_errs_nls$MB` (-) and `r ft_errs_nls$RMSE` (-) for FT respectively. In contrast, @tbl-lca-mod-err reveals that the @Hedstrom1998 method produced significantly less accurate estimates of $C_p$, with a mean bias and RMSE of `r pwl_errs_hp$MB` (-) and `r pwl_errs_hp$RMSE` (-) for PWL, and `r ft_errs_hp$MB` (-) and `r ft_errs_hp$RMSE` (-) for FT respectively.

<!-- These figures are generated under the lidar-processing project using scripts 11-13. The original version generated 100 of GB of ram but now has been optimised and can run locally.  -->
```{r tbl-lca-mod-err, echo=FALSE}
#| label: tbl-lca-mod-err
#| tbl-cap: "Model error statistics calculated for the prediction of leaf contact area from trajectory angle using @eq-lca-inc (Eq. 11) and Equation 10 from @Hedstrom1998 (HP98) for the PWL and FT forest plots. Mean bias is the difference in the model and observed values, MAE is the mean of the absolute error, RMS Error is the root mean squared error and *R*^2^ is the coefficient of determination. The units for all metrics are dimensionless. A forested downwind distance of 100 m was used for the HP98 calculation."
#| tbl-colwidths: [15, 17, 17, 15, 20, 17]

lca_mod_error |> 
  rename(`R^2` = `r^2`,
         `Mean Bias (-)` = `Mean Bias`,
         `MAE (-)` = MAE,
         `RMS Error (-)` = `RMS Error`) |> 
  knitr::kable(
        digits = 2,
        col.names = c(
      "Model",
      "Plot Name",
      "Mean Bias (-)",
      "MAE (-)",
      "RMS Error (-)",
      "$R^2$"
    )
  ) 
  # knitr::kable(booktabs = TRUE,
  #              format = 'latex')
```

## Throughfall model performance

The performance of the interception efficiency (@eq-lca-ip) and leaf contact area (@eq-lca-ac) parameterizations in estimating event throughfall was assessed against UAV-lidar measurements of throughfall at the plot scale for the March 13–14^th^ snowfall event. In this assessment, the hydrometeor trajectory angle was approximated using @eq-ta combined with the mean event wind speed at one-third the mean canopy height (estimated from @eq-cionco and the observed wind speed at FT station) and hydrometeor terminal velocity (measured at PWL station). Leaf contact area was then estimated using @eq-lca-ac for the PWL and FT plots, incorporating the approximated hydrometeor trajectory angle and observed canopy cover ($C_c$) from the VoxRS dataset. Interception efficiency was calculated using @eq-lca-ip with the estimated leaf contact area from @eq-lca-ac and accumulated snowfall measured at PWL station for the event. An $\alpha$ value, used in @eq-lca-ip, of `r alpha_plot_scale` (-) was found through calibration which provided the best fit between observed and simulated interception efficiency at the plot scale for both FT and PWL.

@fig-event-tf illustrates that the new vector-based parameterization closely matches UAV-lidar measurements of throughfall. Modelled throughfall from the vector-based model was `r pwl_vb_tf_mod` mm compared to the measured throughfall of `r pwl_vb_tf_obs` mm for PWL. For FT, the vector-based modelled throughfall was `r ft_vb_tf_mod` mm, while the measured values where `r ft_vb_tf_obs` mm. @tbl-vb-plot-err presents both observed and modelled values for interception efficiency and throughfall, along with corresponding error statistics. The vector-based model shows a lower mean bias of `r pwl_vb_bias` mm for PWL and `r ft_vb_bias` mm for FT, in contrast to the nadir-based model, which overestimated throughfall for both plots. This overestimation occurred because the nadir-based model approximated leaf contact area directly from canopy cover measurements (i.e., was not adjusted using @eq-lca-ac), resulting in a lower estimated contact area and consequently less snow intercepted in the canopy.

![Bar chart comparing the observed and modelled mean change in throughfall ($\Delta \text{SWE}$, mm) over the March 13-14^th^ snowfall event averaged over forest plots FT and PWL. The 'Nadir-model' used @eq-lca-ip not adjusted for trajectory angle (e.g., $C_c$) and the Vector-based 'VB-model' which uses @eq-lca-ip with $C_p$ adjusted for trajectory angle. 'UAV-lidar' corresponds to throughfall calculated using @eq-swe-tf incorporating UAV-lidar snow depth and snow density from in-situ snow pits. The black horizontal dashed line shows the accumulated SWE (mm) over the snowfall event to the PWL station open clearing.](figs/lidar_periods/23_072_23_073_event_throughfall_totals_obs_vs_vb_vs_nadir.png){#fig-event-tf}

\pagebreak 

```{r tbl-vb-plot-err, echo=FALSE}
#| label: tbl-vb-plot-err
#| tbl-cap: "Model error statistics for model estimates of snow interception efficiency (I/P) and throughfall (TF) compared to measurements of I/P and TF using UAV-lidar averaged over the FT and PWL forest plots. Units for I/P are (-) and TF are (mm). The vector-based model utilized @eq-lca-ip with $C_p$ adjusted for trajectory angle. The nadir model also utilized @eq-lca-ip but was not adjusted for trajectory angle and thus $C_c$ was used instead of $C_p$. The 'Obs. Value' column contains measurements from UAV-lidar while the 'Mod. Value' column contains the modelled values. The mean bias was calculated as observed minus modelled and percent error is the percent error between predicted and observed values."
#| tbl-colwidths: [12, 12, 12, 10, 10, 10,10 ,10 ]

vb_plot_scale_err  |>
  # mutate(Units = ifelse(val_name == 'ip', '-', '$\\text{kg m}^{-2}$'),
  mutate(Units = ifelse(val_name == 'ip', '-', 'mm'),
         val_name = ifelse(val_name == 'ip', 'I/P', 'TF')) |> 
  select(Plot = plot,
         `Model Type` = mod_type, 
         `Value Name` = val_name,
         Units,
         `Obs. Value` = obs_val,
         `Mod. Value` = mod_val, 
         `Mean Bias`,
         `Perc. Error`
         ) |> 
  knitr::kable(
    digits = 2
  )
```

# Discussion

The point scale observations presented in @fig-scl-ip-bins indicate that air temperature had little influence on initial interception efficiency during periods where melt and unloading of snow were less likely. This finding aligns with @Storck2002, who observed that variations in air temperature did not significantly affect initial interception efficiency. While other studies have reported both positive [@Andreadis2009; @Roth2019; @Katsushima2023] and negative [@Schmidt1991; @Hedstrom1998] relationships between air temperature and snow interception, the limited association observed here may be explained by competing temperature-dependent processes. Warmer temperatures simultaneously increase branch flexibility (reducing $C_p$) [@Schmidt1991] and enhance snow cohesion and adhesion (increasing interception efficiency) [@Kobayashi1987; @Pfister1999; @Katsushima2023].

Initial interception efficiency was found to increase with wind speed at two locations which were sheltered from the predominant wind direction (@fig-scl-ip-bins). This is hypothesized to be due to an increase in $C_p$ associated with non-vertical hydrometeor trajectories, as demonstrated by observations during a wind-driven snowfall event (@fig-lidar-tf-ip) and analysis of canopy density data (@fig-lca-ht-ws). These findings are also consistent with observations by @Schmidt1989 who observed a slight increase in snowfall interception with increasing wind speeds up to 6 m s^-1^, @Staines2023 who observed reduced canopy transmittance with increasing angle from zenith, and studies of rainfall interception by @Herwitz1995 and @VanStan2011. 

The slight increase in interception efficiency for smaller canopy snow loads and decline for larger canopy snow loads is attributed to the influence of canopy snow load on $C_p$ (@fig-scl-ip-bins). While small, this effect is consistent with the theory proposed by @Satterlund1967 that interception efficiency increases as the canopy fills with snow bridging gaps in the canopy, while later declining due to branch bending and decreased canopy cover. However, at the plot-scale, @Staines2023 showed that these two processes may partially compensate for each other as $C_p$ increases for closed canopies, as new snow bridges gaps, but decreases in partially open canopy due to branch bending [i.e., Fig. 2 in @Schmidt1991]. Still, the increase in $C_p$ resulting from snow load in @Staines2023 was small compared to the substantial rise in $C_p$ due to trajectory angle presented in their study; which corroborates with the plot-scale observations of $C_p$ in this study (@fig-lca-ht-ws). Additional observations by @Watanabe1964, @Calder1990, and @Storck2002 support the findings in @fig-scl-w-sf showing a linear increase in canopy snow load with increasing snowfall. Further evidence in support of the relatively small influence of canopy snow load on $C_p$, is provided by @Lundquist2021 who reported improved simulation of subcanopy snow accumulation without the use of a maximum canopy snow load, when linked with a comprehensive canopy snow ablation routine. The low sensitivity to canopy snow load found here may result from reduced inclusion of ablation processes in our measurements, limited influence of snow load on $C_p$ at this site, and/or the compensatory effects described by @Satterlund1967.

The limited influence of air temperature and canopy snow load on initial interception reported here differs from the theories underpinning existing snow interception parameterizations [@Hedstrom1998; @Andreadis2009; @Satterlund1967; @Moeser2015]. @Cebulski2025 highlights that studies that have identified a relationship between air temperature and/or snow load and interception efficiency [@Schmidt1991; @Roth2019; @Katsushima2023] did not specifically examine initial interception prior to canopy snow ablation. In addition, since a canopy snow load capacity was not observed in this study, the air temperature dependent canopy snow load capacities included in the @Hedstrom1998 and @Andreadis2009 models were not applicable. Since canopy snow ablation is strongly correlated with air temperature and snow load [@Roesch2001; @Ellis2010; @Floyd2012; @Hedstrom1998] some of the previously observed relationships related to these variables may be explained by changes in ablation rather than initial interception. The coupling of ablation processes within existing models may contribute to overestimates of throughfall and canopy snow unloading when combined with other canopy snow ablation parameterizations [@Cebulski2025]. 

To address these issues, a new vector-based snow interception parameterization is presented (@eq-lca-ip) which calculates initial interception efficiency as a function of $C_p$ and $\alpha$. This new parameterization allows for canopy snow loading processes to be isolated from canopy snow ablation processes and is consistent with current rainfall interception theory [@Valante1997; @Zhong2022]. @eq-lca-ip differs only slightly from the original @Hedstrom1998 parameterization (see Equation 6 in Hedstrom & Pomeroy 1998), in that it does not calculate interception efficiency as a function of canopy snow load and from the @Storck2002 parameterization who found interception efficiency to be constant. Further research is needed to explore how processes such as the increased cohesion and adhesion of snowfall to the canopy at warm temperatures, as observed by @Kobayashi1987, @Pfister1999, as well as hydrometeor velocity, particle size, and shape suggested by [@Katsushima2023], may influence the $\alpha$ parameter, although these effects were not observed in this study. Since @eq-lca-ip intentionally excludes processes attributed to canopy snow ablation that were previously included in earlier snow interception models, these ablation processes must be incorporated in canopy snow ablation parameterizations to fully represent the canopy snow mass balance. 

The exponential relationship proposed by @Hedstrom1998 to scale $C_p$ with wind speed failed to reproduce the observations presented in @fig-lca-ht-ws. Instead, plot-wide $C_p$ was found to increase as function of hydrometeor trajectory angle and canopy cover. However, the large scatter in $C_p$ measurements shown in @fig-lca-ht-ws suggests @eq-lca-inc is only applicable at the forest stand scale, or larger, where the sub-metre variability in $C_p$ resulting from directional differences averages out. Canopy cover measurements at larger scales may lack sufficient resolution to identify large open areas, where the assumptions of @eq-lca-ac would not be valid, and $C_p$ should be estimated using horizontal canopy cover without adjusting for snowfall trajectory angle. If fine-scale canopy observations are available, canopy structure metrics such as the gap area indices described in @Moeser2015b could be helpful for identifying large gaps in the canopy. It was found that the mean event hydrometeor trajectory angle, required for @eq-lca-inc, could be approximated from @eq-ta using the observed mean hydrometeor fall velocity and the mean horizontal wind speed selected at one-third of the canopy height above the ground. This is consistent with @Katsushima2023, who also proposed using a wind speed at one-third the canopy height for modelling unloading of canopy snow. The transferability of the snow-leaf contact area equation (@eq-lca-inc) remains uncertain, as it has only been tested at a single site with two tree species, and the relationship of $C_p$ with environmental factors is expected to vary across different climate conditions, canopy structures, densities, species, and ages. Additionally, @eq-ta assumes a linear hydrometeor trajectory, and does not consider non-linear patterns such as wind flow directions around tree elements, turbulent flow, or differences in wind speed with height. @Staines2023 showed that backflows and large eddies that occur within the canopy can contribute to mixed responses. Therefore, further testing and modification of @eq-lca-inc is needed in diverse forest environments.

Although the vector-based model showed relatively modest improvement over the nadir model, it is preferred due to its lower error compared to the UAV-lidar measurements and better representation of physical processes. Developed and tested at the forest plot scale (hectares), the vector-based model is suitable for hydrological models at this scale discretized by forest density, though we expect the relationship between snow interception and snow-leaf contact area to be applicable at larger scales. Previous subcanopy snow accumulation models were developed based on process understanding at varying scales: @Hedstrom1998 used snow survey transects at the forest plot scale with observations at intervals ranging from days to weeks, while @Storck2002 relied on point-scale lysimetry observations at 30-minute intervals. Recent evidence from @Staines2023 and the results presented here suggest that some of the process understanding developed in previous studies may not be applicable at larger extents or finer temporal resolutions. The theoretical basis of the vector-based model is supported by observations across a broad range of meteorological conditions and forest densities and aligns with globally tested rainfall interception models [e.g., @Valante1997; @Zhong2022], suggesting potential broader applicability, though further validation is required. 

# Conclusions

New observations of initial snow interception, collected over a wide range of meteorological conditions and canopy densities indicate that leaf contact area is the primary factor influencing subcanopy snow accumulation. At the point scale, measurements revealed no evidence of a maximum canopy snow load, even for event snowfalls up to 45 mm, nor was there any indication of air temperature influencing the cohesion and adhesion of snowfall to the canopy. Instead, wind speed was found to influence interception efficiency by changing the hydrometeor trajectory angle, which lead to a substantial increase in snow-leaf contact area.

At the forest plot scale, UAV-lidar measurements of throughfall aligned with the point-scale observations demonstrating that leaf contact area was strongly associated with interception efficiency at a particular site. Leaf contact area, which incorporates changes in canopy density with hydrometeor trajectory angle, proved to be a better predictor of interception efficiency compared to nadir-calculated canopy cover. When averaged across each forest plot, leaf contact area was shown to be highly sensitive to trajectory angle, increasing by `r round(pwl_frac_inc * 100, 0)`–`r round(ft_frac_inc * 100, 0)`% for trajectory angles associated with a 1 m s^-1^ wind speed. An existing theoretical relationship failed to adequately represent the measured increase in leaf contact area with simulated trajectory angles. As a result, a new relationship is proposed as a function of canopy cover and hydrometeor trajectory angle (approximated from wind speed and hydrometeor terminal fall velocity), which demonstrated good performance at this study site. 

The weak association between air temperature and canopy snow load with initial interception efficiency, as presented here and in earlier studies, coupled with novel insights on the influence of wind speed on leaf contact area, suggests the potential benefits of a new snow interception parameterization. A new parameterization is proposed that calculates initial interception as a function of snowfall and leaf contact area. This parameterization is consistent with rainfall interception studies, which also separate canopy loading and ablation processes, and calculate interception as a function of canopy cover. Additionally, a second equation is proposed to estimate leaf contact area as a function of hydrometeor trajectory angle and nadir canopy cover. This updated snow interception parameterization performed well in the subalpine forest studied here at the forest plot scale. However, further validation is necessary in a range of climates, forests, and spatial extents.

# Acknowledgments

We wish to acknowledge financial support from the University of Saskatchewan Dean’s Scholarship, Natural Sciences and Engineering Research Council of Canada, Global Water Futures Programme, Environment and Climate Change Canada, Alberta Innovates, Canada Foundation for Innovation, and the Canada Research Chairs Programme. We thank Madison Harasyn, Hannah Koslowsky, Kieran Lehan, Lindsey Langs and Fortress Mountain Resort for their help in the field. Jacob Staines, Madison Harasyn, Alistair Wallace, and Rob White contributed to developing the UAV-lidar processing workflow.

# Data Availability

The data that support the findings in this study are available at https://doi.org/10.5281/zenodo.14018893.

\pagebreak

# References
