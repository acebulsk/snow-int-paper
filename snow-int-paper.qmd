---
title: "Decoupling Snow Interception and Ablation Parameterizations: Insights from High-Frequency and Fine-Scale Observations from a Subalpine Forest"
format: 
  docx:
    reference-doc: ../config/word_template_hp.docx
    number-sections: true
    toc: false
  # pdf
  html:
    toc: false
    self-contained: true
editor: source
bibliography: ../../papers/bibtex/library.bib
csl: '../../papers/bibtex/csl-styles/apa-disable-disambiguate-add-names.csl'
---

<!-- From https://onlinelibrary.wiley.com/page/journal/10991085/homepage/forauthors.html - Papers submitted for publication should be concise and not exceed the 7500 word limit. The following sections are included as part of the word count: abstract; main text; and the acknowledgements. The following sections are excluded: title page, including author list and affiliations; bibliography; figure legends and supporting information. Figures and supporting information should be supplied as separate files. -->

```{r, include=FALSE}
library(tidyverse)
library(ggpubr)

knitr::opts_chunk$set(echo = FALSE, message=FALSE, warning=FALSE, fig.align='center')

# source('scripts/00_define_global_attributes.R')
# source('scripts/01_plot_theory_examples.R')
# source('scripts/01_plot_binned_met_trough_IP.R')
# source('scripts/01_plot_forest_snow_survey_IP.R')
# source('scripts/01_plot_snowfall_interception_w_tree.R')
```

**Authors:**

A. Cebulski^1^ (ORCID ID - 0000-0001-7910-5056)

J.W. Pomeroy^1^ (ORCID ID - 0000-0002-4782-7457)

^1^USask Coldwater Laboratory, University of Saskatchewan, Canmore, Canada

**Corresponding Author:** A. Cebulski, alexcebulski@gmail.com

**Abstract:** Existing models of subcanopy snow accumulation differ in their representation of snow interception and ablation processes, and their applicability across diverse climates and forest types, as well as their compatibility among differing parameterizations, remains uncertain. These models need to be revisited in the context of more diverse study sites and modern methodologies. To facilitate this, in-situ observations of meteorology, high frequency point scale measurements of throughfall, and fine-scale UAV-lidar measurements of throughfall and canopy metrics were collected across two forest plots in a subalpine forest in the transitional climate of the Canadian Rockies. The theory underpinning existing snow interception models such as the influence of canopy snow load or air temperature on interception were not observed in the data collected from this study site. The association between fine-scale measurements of canopy structure and throughfall reveal that at the forest plot scale, UAV-lidar measurements forest structure is the most important factor governing snow accumulation. Throughfall measurements from a wind-driven snowfall event illustrate that improved prediction of interception efficiency was found when adjusted for hydrometeor trajectory angle. Leaf contact area was found to be very sensitive to wind speed, increasing by up to 95% with a horizontal wind velocity of 1 m s^-1^ and resulting in a significant reduction in throughfall observed across two forest plots. These effects are combined into two new equations which model snow interception efficiency as a function of leaf contact area adjusted for hydrometeor trajectory angle. This new method proved successful in estimating interception efficiency for a snowfall event with R^2^ values of 0.70 and 0.61 for the two forest plots in this study. This new interception model minimizes the inclusion of ablative processes in its parameterization, improving compatibility when combined with additional ablative parameterizations available in the literature.

**Keywords:** snow, interception, throughfall, forest, snowpack, lidar

# Introduction

Over half of North America's snow covered zone is covered by forests [@Kim2017], significantly impacting the accumulation and redistribution of subcanopy snowpacks and subsequent snowmelt runoff. Researchers have estimated that across the globe, 25–45% of annual snowfall may be lost to the atmosphere due to sublimation of snow intercepted in the canopy [@Essery2003]. Snow intercepted in the canopy can sublimate and melt at much higher rates compared to the subcanopy snowpack [@Lundberg1994; @Pomeroy1998b; @Floyd2012], reducing the amount of snow available for runoff. Forest thinning efforts aimed at limiting sublimation losses and increase snow accumulation by [@Golding1978; @Harpold2020; @Troendle1983] sometimes have unintended consequences for snowmelt runoff. This may be due to increased ablation rates when forest cover is reduced and a limited process understanding [@Ellis2013; @Musselman2015a; @Pomeroy1997; @Varhola2010; @Safa2021]. Vegetation structure controls the partitioning of snowfall into throughfall and interception, and thus governs the quantity of snow subject to sublimation [@Hedstrom1998a; @Storck2002]. The time that snow resides in the canopy, and is available for high rates of sublimation depends on unloading rates [@Hedstrom1998a; @Roesch2001], canopy snowmelt [@Mahat2014], and wind redistribution [@Wheeler1987]. Due to the significant impact of forest cover on snow accumulation and ablation, and the absence of a regional scale monitoring network of forest snow accumulation [@Vionnet2021; @Rittger2020], land management, ecological conservation and water resource decisions rely on robust models of snow redistribution to estimate past, current and future subcanopy snowpacks. Such models require a comprehensive understanding of snow interception and ablation processes. 

Numerous field-based studies have developed methodologies to improve snow interception process understanding. These methods, discussed in detail in @Cebulski2024b, include snow surveys mass balance [@Hedstrom1998a], tree weighing [@Satterlund1967; @Schmidt1991; @Lundberg1993; @Hedstrom1998a; @Storck2002; @Katsushima2023], gamma ray attenuation [@Calder1990], subcanopy lysimeters [@Storck2002] and time-lapse imagery analysis [@Floyd2008; @Lumbrazo2023]. @Cebulski2024b noes the care needed in using these methods to isolate interception from ablative processes. As a result, existing parameterizations for snow interception are coupled to ablative processes [e.g., @Hedstrom1998a; @Katsushima2023] and may not be directly compatible when combined with additional ablative process representations [@Clark2020; @Wheater2022; @Verseghy2017]. Previous studies have collected measurements of interception efficiency over timesteps ranging from hourly [@Storck2002] to weekly [@Hedstrom1998a]. The varying measurement time intervals affect the duration during which ablative processes may have influenced these measurements and resulting models, leading to potential underestimations of the fraction of snow intercepted in the canopy.

The coupling of ablation processes within in existing snow interception models may explain the over estimation of subcanopy snow accumulation reported by @Lundquist2021 and @Lumbrazo2022 when combining the @Hedstrom1998a routine with ablation parameterizations from different studies [e.g., @Roesch2001]. However, @Gelfan2004 demonstrated accurate subcanopy snowpack simulations at study sites across the globe by treating the @Hedstrom1998a and @Storck2002 parameterizations separately while using a step-based function to choose either parameterization based on temperature. Additional observations of snow interception that minimize the inclusion of ablative processes are required to determine if the theory in @Hedstrom1998a and @Storck2002 is valid for these measurements.

Previous studies have found differing relationships of the canopy snow storage capacity with air temperature [see Figure 6 in @Cebulski2024b]. However, @Lundquist2021 found improved subcanopy snowpack simulations when they omitted the canopy snow storage capacity from @Hedstrom1998a, while utilizing a complete representation of ablation processes. This, combined with studies which have not observed a canopy snow storage capacity [@Storck2002; @Calder1990; @Katsushima2023], and the potential explanation of decreased interception at higher canopy snow loads in [@Hedstrom1998a; @Satterlund1967; @Moeser2015] attributed to ablative processes, suggests the canopy snow storage capacity may be much higher than existing models predict. It may also be beneficial to include this process representation within ablative parameterizations for consistency with the rainfall interception literature [e.g., @Valante1997]. This could also help process representation particularly in regions that are prone to rime-ice formation, which can limit canopy snow ablation [@Lumbrazo2022] and can lead to heavy snow loads causing stem breakage [@Lehtonen2014; @Lehtonen2016].

The extent that processes observed at the point scale, such as bridging of gaps in canopy elements [@Satterlund1967], or branch bending [@Schmidt1991; @Pomeroy1995; @Hedstrom1998a], influence snow accumulation at the forest plot scale remain uncertain. Fine-scale observations of throughfall have only recently become feasible at the plot scale [@Harder2020; @Staines2023], presenting an opportunity to provide more definitive answers to how interception processes vary across differing spatial scales. Existing theory proposed by @Hedstrom1998a suggests that moderate wind speeds, which result in horizontal hydrometeor trajectories, can increase leaf contact area and increase interception efficiency at the plot scale. This association has been shown in rainfall interception studies [i.e., @Herwitz1995; @VanStan2011] to have a significant influence on observed throughfall. Despite this importance for rainfall, this relationship proposed by @Hedstrom1998a, is typically ignored in models [e.g., @Mahat2014; @Clark2020], as empirical support for this relationship is lacking and also exhibits a relatively low sensitivity [see Figure 8 in @Cebulski2024b]. New methods developed by @Staines2023 to characterize the canopy at a high angular and spatial resolution have the potential to better understand the relationship between snow interception and forest structure spatially and also across differing trajectory angles.

The objective of this paper is to evaluate the theory underlying existing snow interception models using high-frequency point scale and high spatial resolution measurements of subcanopy snow accumulation that attempt to minimize inclusion of ablative processes. These new observations are investigated to address the following research questions: 1) Are the existing theories regarding the relationship between meteorology and forest structure on interception efficiency and canopy snow storage capacity supported by in-situ observations? 2) How is snow interception influenced by non-vertical hydrometeor trajectory angles over a wind-driven snowfall event? 3) To what extent can these findings inform the development of a new parameterization for snow interception?

# Theory

The trajectory angle, $\theta_h$ of a hydrometeor as the departure in degrees (°) from a vertical plane (i.e., 0° for vertical snowfall), is shown in @Herwitz1995 to be calculated as:

$$
\theta_h = \arctan \left(\frac{x_h(u_z)}{v_h(D_h)}\right)*\frac{180}{\pi}
$${#eq-ta}

where $v_h(D_h)$ is the terminal fall velocity of the hydrometeor (m s^-1^), which is a function of the hydrometeor diameter, $D_h$ and $x_h(u_z)$ is the horizontal change in the hydrometeor (m s^-1^) which is a function within canopy wind speed, $u_z$ at height above ground, $z$. 

Above the top of the canopy, wind flow is approximately logarithmic with height. @Cionco1965 show that, $u_z$ may be approximated using the exponential formula:

$$
u_z = u(u^*,z,z_o,d)\cdot exp\left[a\cdot\left(\frac{z_c}{h_c}-1\right)\right]
$${#eq-uz}

where $u$ is the horizontal wind speed at the top of the canopy which is a function of the friction velocity $u^*$, height above ground, $z$, roughness length, $z_o$, and the displacement height of the canopy, $d$. $a$ is an attenuation coefficient that increases with increasing leaf area and decreases as the mean distance between individual trees increases, $z_c$ is the height above ground of $u_z$, and $h_c$ is the average height of the canopy elements. @Cionco1972 suggest values for $a$ of 1.01 for small needleleaf trees, @Zhu2001 provide methods to calculated $a$ based on canopy density and @Parviainen2000 provide a method to calculate $a$ using observations from two jack pine (*Pinus banksiana*) stands. @fig-ws-vs-ta shows the increase in trajectory angle calculated using @eq-ta with a constant hydrometeor velocity of 1 m s^-1^ and a horizontal velocity equal to mid-canopy wind speeds ranging from 0-20 m s^-1^. 

![Plot showing the relationship of hydrometeor trajectory angle (departure from zenith) with increasing horizontal velocity from @eq-ta. The three different lines represent fall velocities of 0.5 m s^-1^ (purple), 1 m s^-1^ (green), 1.5 m s^-1^ (yellow).](figs/examples/wind_speed_vs_traj_angle.png){#fig-ws-vs-ta width="400"}

# Data and Methods

## Study Site

This study was conducted at Fortress Mountain Research Basin (FMRB), AB, -115° W, 51° N, a continental headwater basin situated within the Canadian Rocky Mountains (@fig-site-map). Data from this study was collected between October 2021 and July 2023 within and surrounding two forest plots adjacent to the FMRB Powerline Station (PWL) and Forest Tower Station (FT) at ~2100 m asl. (@fig-site-map). The average annual precipitation at PWL Station from 2013 to 2023 is 1045 mm, with the peak annual snow water equivalent (SWE) reaching 465 mm, typically occurring in late April. The PWL and FT forest plots include discontinuous stands of subalpine fir (Abies lasiocarpa) and Engelmann spruce (Picea engelmannii) trees, with a proportion of 70% and 30% respectively [@Langs2020]. In the early 1900s the majority of vegetation in the FMRB burned during a large forest fire that affected most of the Kananaskis Valley. Following the fire, the forest within the the PWL and FT forest plots has naturally regenerated with minimal disturbance. 

## Meteorological Measurements

A flux tower at the FT Station provided measurements of air temperature (Campbell Scientific HMP155A), relative humidity (Campbell Scientific HMP155A), wind speed (Campbell Scientific Ultrasonic-86000 & Metone 014A) and wind direction (Campbell Scientific Ultrasonic-86000) at 15-min time intervals 4.3 m above the ground (@fig-site-map). The PWL station, located 120 m to the northwest of FT station in a forest clearing shown in @fig-site-map provided measurements of snowfall rate, additional wind speed measurements and hydrometeor size and velocity. The snowfall rate was measured using a weighing precipitation gauge 2.6 m above ground (OTT Pluvio) corrected for undercatch following phase correction by @Harder2013 and catch efficiency by @Macdonald2007a. A Metone 014A anemometer provided wind speed measurements at a height of 2.6 m, while the RM Young anemometer recorded wind speed and wind direction at a height of 5.2 m. A disdrometor (OTT Parsivel2) provided measurements of hydrometeor particle size and velocity. 

![Map showing the location of forest plots, flux towers, SCL instruments and survey transects. Inset map on the lower right shows the regional location of Fortress Mountain Research basin.](figs/maps/site_map_inset.png){#fig-site-map}

## Lysimeter Data

Three subcanopy lysimeters (SCL) were installed surrounding the FT Station to provide fifteen minute interval measurements of throughfall and unloading (see locations in @fig-site-map). The SCLs consisted of a plastic trough with an opening of 0.9 m ^2^ and depth of 20 cm suspended from a load cell (Intertechnology 9363-D3-75-20T1) attached to an aluminum pipe connected between two trees. The load cell which measures kilograms was scaled to kg m^-2^ by dividing by the cross-sectional area of the SCL opening. For select time periods where ablative processes including, unloading, drip and wind redistribution could be considered negligible, the subcanopy lysimeters were inferred to provide measurements of throughfall [see method described in @Cebulski2024b]. Interception efficiency was calculated using @eq-ip, throughfall from the SCLs and snowfall from the PWL snowfall gauge. For each of the 26 snowfall events the average interception efficiency over each event was calculated for each 15-minute timestep within the 26 snowfall events. Timelapse imagery, a weighed tree and in-situ observations were used to ensure the ablation of snow intercepted in the canopy or snow on the ground was minimal over each of the selected events. The canopy structure surrounding three SCLs and was measured using hemispherical photography (Nikon Coolpix 4500 and EC-F8 hemispherical lens) and the hemispheR R package @Chianucci2023 and is shown in @tbl-scl-lai-cc. 

```{r scl, echo=FALSE}
#| label: tbl-scl-lai-cc
#| tbl-cap: "Canopy structure of the three subcanopy lysimeters (SCL) located proximal to the FT Station. Leaf area index (LAI) and Canopy Coverage was measured using hemispherical photo analysis with the R package hemispheR."
#| 
scl_lai_cc <- read.csv('~/local-usask/analysis/interception/data/lai/scl_canopy_metrics.csv') 

scl_lai_cc$Name <- c('SCL Med', 'SCL Low', 'SCL High')

scl_meta <- read.csv('~/local-usask/analysis/interception/data/loadcell/calibrations/load_cell_meta_ac_fortress.csv')

scl_lai_cc |> 
  arrange(cc) |> 
  mutate(cc = round(cc, 2)) |> 
  select(Name, `LAI (-)` = Le, `Canopy Coverage (-)` = cc) |> 
  knitr::kable(#booktabs = TRUE,
               #format = 'latex'
               )
```

A weighed tree lysimeter, measured the weight of canopy snow load, $L_{wt}$ (kg). A live subalpine fir (Abies lasiocarpa) tree was cut and suspended from a load cell (Artech S-Type 20210-100) at the beginning of the 2022 and 2023 water years which recorded the weight of the tree. The bottom of the tree was sealed to limit some transpiration and to prevent spinning and abrupt impacts of the free-hanging tree, the base of the tree was attached to a support system that allows for vertical movement but limits abrupt horizontal movements. The weight of snow in the weighed tree in kg was scaled to an areal estimate of canopy snow load ($L$, kg m^-2^) using measurements of areal throughfall (kg m^-2^) from manual snow surveys and snowfall from the PWL Station snowfall gauge [see description of method in @Hedstrom1998a].

## UAV Data Processing

Two uncrewed aerial vehicle (UAV) lidar surveys were conducted before and after a 24 hour snowfall event that occurred between March 13th and March 14th, 2023. These surveys were undertaken to facilitate the measurement of snow accumulation and canopy structure metrics. The UAV (FreeFly Alta X) was equipped with a REIGL miniVUX-2 airborne laser scanner payload, an Applanix APX-20 inertial measurement unit (IMU) and global navigation satellite system (GNSS). The UAV was flown 90 m above the ground at a speed of 3 m s^-1^ following a preprogrammed flight trajectory shown in @fig-site-map. 

The REIGL miniVUX-2 laser operates at a near infrared wavelength with a laser beam footprint of 0.160 m x 0.05 mm (at 100 m above ground). The accuracy and precision of the miniVUX-2 is described by REIGL for a lab environment of 0.015 m and 0.01 m respectively (at 50 m above ground). The miniVUX-2 was configured with a laser pulse repetition rate of 200 kHz, field of view of 360°, scan speed of 31.09 revolutions s^-1^ and an angular step width of 0.0558°, resulting in an expected an average point cloud density of 107 returns m^-2^ for each flight path.

Georeferenced point clouds with x, y, and z coordinates for each laser return were generated following methods outlined by @Harder2020 and @Staines2023 to reconcile survey lidar, IMU and GNSS data. A ground based GNSS system was positioned on a permanent monument during each survey and underwent precise point positioning (PPP) correction by @ppp2024. Differential GNSS correction of the UAV trajectory was conducted using the ground based PPP GNSS observations and the POSPac UAV software. The UAV-lidar point clouds were then transformed from a sensor referenced coordinate system to a georeferenced coordinate system (EPSG:32611 - WGS 84 / UTM zone 11N) using the RIEGL Riprocess Software. A vertical offset of up to 6 cm between UAV-lidar flight lines was observed in the resulting point clouds on March 13th and 14th, 2024 and was attributed to IMU position drift. This offset between flight lines was corrected using the BayesStripAlign software v2.24 [@BayesMap2024], which reduces relative and absolute uncertainties in the vertical elevation of the point cloud using the ground control points (GCP) collected across the study site using a differential GNSS rover. After strip alignment, the mean elevation bias (lidar minus GCP) was 0.000 m and the RMS error changed from 0.055 m to 0.038 m March 13^th^ and changed from 0.033 m to 0.029 m on March 14^th^. The point cloud density ranged from ~1200 returns m^2^ in open clearings to ~2200 m^2^ in sparse forest for both the March 13 and 14th surveys after all flight paths were combined. 

Quality control, ground classification and calculation of the change in between two UAV-lidar point clouds was conducted using the LAStools software package [@LAStools2024]. The ground classification was conducted using the "lasground_new" function [@LAStools2024] for both the pre and post snowfall event point clouds, with a step size set to 2 m and 8 substeps (ultra_fine setting). The offset and spike options were set to remove points that are more than 0.1 m above or below the initial ground surface estimate surface which "lasground_new" fits to the last returns. This function is based on an algorithm outlined by @Axelsson2000, describing the process of making the initial ground surface element.

## Snow Surveys

### In-situ Snow Depth and Density

```{r, include=FALSE}
lai_measurements <- read.csv('../../analysis/interception/data/lai/results/2023_compiled_lai_vza_15_60.csv')  |>
  filter(vza == 60) 

cc_range <- paste(round(min(lai_measurements$cc), 2), '–', round(max(lai_measurements$cc), 2))
lai_range <- paste(round(min(lai_measurements$Le), 2), '–', round(max(lai_measurements$Le), 2))
```

In-situ fresh snow surveys provided measurements of subcanopy throughfall following the transects shown in @fig-site-map. Twelve fresh snow surveys (six pre and post snowfall event pairs) at 30 stations were selected, which had minimal ablation and redistribution between pre and post surveys, to scale the weighed tree following methods outline in @Hedstrom1998a. When conditions allowed for a UAV-lidar flight, the in-situ snow surveys were conducted following the UAV-lidar flight to assess the accuracy of throughfall measurements, and to provide a fresh snow density for the calculation of SWE (kg m^-2^). Differential GNSS rover coordinates, with ± 2.5 cm 3D uncertainty, were taken at each snow sampling location so the locations could be queried later from the UAV-lidar rasters. If a pre event crust layer was present the depth of post event fresh snow accumulation above the crust layer were interpreted as throughfall over the event. In the absence of a defined crust layer, the difference in pre and post event snow depth to ground was interpreted as event throughfall. A 1000 cm^3^ snow density wedge sampler (RIP Cutter, https://snowmetrics.com/shop/rip-1-cutter-1000-cc/) was used to measure the density of the fresh snow layer, $\overline{\rho_{tf}}$ (kg m^-3^). The throughfall depth measurements, $\Delta HS$ were converted to SWE using the following equation:

$$
\Delta SWE_{tf} = \Delta HS \cdot \overline{\rho_{tf}}
$${#eq-swe-tf}

where $\Delta SWE_{tf}$ (kg m^-2^) is the change in SWE over a discrete time interval. 

### UAV-Lidar Snow Depth

Two UAV-lidar surveys were conducted over the study area, one prior to a snowfall event on March 13, 2023 at 10:00 CST and another following snowfall on March 14, 2023 at 11:00 CST. These two surveys enables fine-scale analysis of snow accumulation and canopy structure within the FT and PWL forest plots. This snowfall event was selected based on two criteria: 1) it provided sufficient cumulative snowfall to result in a low relative error in UAV-LiDAR measured throughfall, and (2) minimal redistribution and ablation were observed over the event, as confirmed by SCL, weighed tree, and time-lapse imagery. The change in elevation between the two UAV-lidar surveys was interpreted as the increase in snow accumulation, $\Delta HS$ over the snowfall event. This change was calculated using a point-to-grid subtraction method, using the "lasheight" function from the @LAStools2024 software, as in @Deems2013 and @Staines2023. The pre snowfall event point cloud from "lasground_new" by "lasheight" to construct a "ground" TIN. Subsequently, the height of each post snowfall event point above the ground TIN, resulting in a point cloud representing $\Delta HS$. This point cloud was then converted into a raster of $\Delta HS$ with a grid cell resolution of 5 x 5 cm using the "las2dem" function. Further quality control and resampling of the 5 cm raster of $\Delta HS$ was conducted using the R package Terra @Hijmans2024. Regions that were disturbed over the snowfall event during the in-situ snow survey and values that exceeded the .999th quantile were removed. To help remove any remaining noise a 25 cm $\Delta HS$ raster was generated by computing the median of the 5 cm $\Delta HS$ values within each 25 cm grid cell.

## Snow Interception

During calm snowfall periods, where ablative processes could be assumed negligible, the amount of snow intercepted in the canopy was estimated as:

$$
\frac{dL}{dt} = q_{sf}-q_{tf}
$$ {#eq-dwdt-ode}

where ($q_{sf}$) is the snowfall rate (kg m^-2^ s^-1^) and $q_{tf}$ is the throughfall rate (kg m^-2^ s^-1^). This method was preferred, compared to direct measurements from the weighed tree lysimeter, as the subcanopy lysimeters were not influenced by sublimation losses from snow intercepted in the canopy. For a complete description of the canopy snow mass and energy balance see @Cebulski2024b.

Over a discrete time interval, $\Delta t$, the change in canopy snow load, $\Delta L$ (kg m^-2^) was calculated as:

$$
\frac{\Delta L}{\Delta t} = \overline{q_{sf}}-\overline{q_{tf}} = \Delta SWE_o - \Delta SWE_{tf}
$${#eq-dwdt-discrete}

where $\overline{q_{sf}}$ and $\overline{q_{tf}}$ are the average snowfall and throughfall rate over $\Delta t$. $\Delta SWE_o$ is the change in SWE to the open (kg m^-2^) over $\Delta t$.

Interception efficiency, $\frac{I}{P}$ (-), which is the fraction of snow intercepted over $\Delta t$ was calculated as:

$$
\frac{I}{P} = \frac{\Delta L}{\overline{q_{sf}} \Delta t} 
$$ {#eq-ip}

## UAV-Lidar Canopy Metrics

The point cloud and trajectory data aquired from the two UAV-lidar surveys were also utilized to characterize the canopy structure of the FT and PWL forest plots. To characterize the canopy structure, the voxel ray sampling (VoxRS) methodology for lidar data analysis was employed, as outlined by @Staines2023. This method was chosen for its ability to provide canopy metrics that are less sensitive to non-uniform lidar sampling, which often results from beam occlusion in vegetation and leads to reduced points near the ground. The VoxRS algorithm is publicly available at https://github.com/jstaines/VoxRS. The canopy products produced from VoxRS here include: canopy contact number, the mean theoretical number of canopy contacts for a given ray, and radiation transmittance ($\tau$) all with units (-). See supporting information in @Staines2023 for details on how these metrics are computed. The fraction of snow-leaf contact area per unit area of ground used in @Hedstrom1998a, and hereafter called leaf contact area ($C_p$), was calculated as:

$$
C_p(C_c, \theta_h, L) = 1-\tau
$${#eq-lca}

$$
C_p(C_c, \theta_h, L) = \begin{cases}
    1-\tau,& \text{if } \theta_h> 0°\\
    1-\tau \approx C_c ,              & \theta_h= 0°
\end{cases}
$${#eq-tf-ode}

where $C_p$ is a function of the canopy coverage $C_c$, $\theta_h$ and $L$. $C_p$ is approximately equal to canopy coverage ($C_c$) for vertical snowfall. However, for non-vertical snowfall $1 > C_p > C_c$.

## Statistics

To determine how forest structure was associated with interception efficiency at different azimuth and zenith angles over the March 13-14 snowfall event, each portion of the hemisphere at each grid location was considered. The relationship between interception efficiency and canopy contact number was found to be linear and thus the Pearson Correlation Coefficient, $\rho_p$ was calculated using the 'stats' package in R [@R2022] to quantify the association between a single raster of interception efficiency and the 32'760 rasters containing the canopy contact number hemisphere for each portion of the hemisphere (azimuth [0°, 1°, ..., 359°], zenith angle [0°, 1°, ..., 90°]) for each of the 25 cm grid cells across the FT and PWL forest plots. 

Linear and non-linear models, based on observed data and theoretical justification presented in this study, were developed and assessed using the 'stats' package in R [@R2022]. Linear models were fitted using ordinary least squares regression via the 'lm' function to analyze two relationships: (1) between interception efficiency and leaf contact area, and (2) between leaf contact area and trajectory angle. Both models were forced through the origin based on the theoretical justification that the dependent variable should be zero when the independent variable is zero. To assess the performance of the linear models, we calculated four metrics comparing observed and modelled values: mean bias, mean absolute error (MAE), root mean square error (RMSE), and the coefficient of determination (R^2^). Following @Kozak1995, we recognized that the default R^2^ value provided for least squares models forced through the origin by many statistical packages can be misleading. Therefore, we adjusted these R^2^ values using Equation 10 in @Kozak1995. Although we had theoretical justifications for forcing the intercept through the origin, we also employed two statistical tests as described by @Kozak1995 to verify whether a no-intercept model (forced through the origin) was appropriate for our data compared to a with-intercept model (including an intercept). The first test evaluated if the intercept of the with-intercept was significantly different from zero using p-value provided by the 'summary' function from the 'stats' package in R. The second test examined if there was a significant difference between the no-intercept and with-intercept models by testing if the residual sum of squares was different between the no-intercept and full model, assessed via Equation 15 in @Kozak1995. If the first test indicated a significant difference, and the second did not, the no-intercept model could be deemed statistically justified [@Kozak1995]. Non-linear models were fitted using non-linear least squares regression via the 'nls' function in 'stats' package in R. The non-linear models were assessed by comparing predicted values to observed values using three metrics: mean bias, mean absolute error (MAE), and root mean square error (RMSE).

# Results

## The influence of meteorology on snow interception

@fig-scl-w-sf depicts the state of canopy snow load with increasing cumulative snowfall, measured for 26 snowfall events using the three SCLs and the PWL snowfall gauge. Canopy snow load was observed in @fig-scl-w-sf to increase linearly with increasing snowfall without evidence of reaching a maximum canopy storage capacity. Variation in the slope of each line in @fig-scl-w-sf, is attributed to differences in the meteorology and antecedent canopy snow load within and between the individual events. Variations in the canopy structure surrounding the SCL instruments as shown in @tbl-scl-lai-cc, also contributed to the difference in slope. The absence of canopy snow load measurements in @fig-scl-w-sf for certain troughs during specific events was caused by damage to the subcanopy lysimeter wiring due to animal interference and snow load.

![Plot showing the cumulative event snowfall versus the corresponding state of canopy snow load calculated using the SCLs for each of the 26 snowfall events. The SCLs are denoted by a distinct colour (grey, yellow, and green), correspond to varying canopy coverage (0.73, 0.78, and 0.82, respectively).](figs/automated_snowfall_event_periods/cuml_event_snowfall_canopy_storage_sep_scl.png){#fig-scl-w-sf}

@fig-lai-met-ip illustrates the average interception efficiency calculated over each 15-minute interval of the 26 snowfall events. Air temperature and relative humidity measured at FT station was observed to have little influence over interception efficiency measured using the SCL and PWL snowfall gauge (@fig-lai-met-ip, A & B). Wind speed measured at FT Station showed a positive association with interception efficiency. Between wind speed bins of 0.25 and 1.25 m s^-1^ interception efficiency increased from 0.56 to 0.62 (@fig-lai-met-ip, C). This is interpreted to be due to an associated increase in canopy contact area as hydrometeor trajectory becomes more horizontal with increasing wind speed. For wind speeds above 2 m s^-1^, interception efficiency was observed to decline, to a minimum of 0.48 for the 3.75 m s^-1^ wind speed bin. This decline in interception efficiency at higher wind speeds is interpreted to be due to to some unloading and wind redistribution of canopy snow into the SCLs. The canopy snow load, measured at the beginning of each timestep, had a positive association with interception efficiency as the canopy filled with snow. An increase in interception efficiency was observed from 0.57 for snow loads near 0 mm to 0.66 for snow loads around 7 mm. This was followed by a gradual decline in interception efficiency for snow loads greater than 7 mm to a minimum of 0.48 at snow loads above 18 mm (@fig-lai-met-ip, C). The SCLs were located within gaps in the canopy and may have contributed to these instruments being more sensitive to branch bending compared to increases in leaf contact area due to increasing snow load. Hydrometeor diameter and hydrometeor velocity observed at the PWL Station disdrometer did not have a strong association with interception efficiency (@fig-lai-met-ip, E & F).

![Scatter plots of discrete observations (blue dots) and binned data (black dots with error bars) of meteorology, canopy load, and hydrometeor characteristics versus snow interception efficiency. Panels show (A) air temperature, (B) relative humidity, (C) wind speed, (D) initial canopy snow load (the snow load observed at the beginning of the timestep), (E) hydrometeor diameter, (F) hydrometeor velocity. The black open circles show the mean of each bin and the error bars represent the standard deviations. The data were filtered to include observations with a snowfall rate > 0 mm/hr, throughfall rate > 0.05 mm/hr to minimize noise and a snowfall rate > the subcanopy lysimeter throughfall rate to minimize observations with unloading. Periods of unloading and melt were also removed through careful analysis of the weighed tree, subcanopy lysimeters, and timelapse imagery.](figs/automated_snowfall_event_periods/troughs_met_vs_IP_bin.png){#fig-lai-met-ip}

## The influence of forest structure on snow interception

```{r, include=FALSE}
# returns angle in degrees from zenith
traj_angle_deg <- function(wind_speed, velocity){
  slope <- wind_speed/velocity
  angle_deg <- atan(slope) * 180 / pi

  return(angle_deg)
}
# MET
snowing_met <- readRDS('data/event_met/lidar_events_met_avgs_snowing.rds') |> 
  filter(event_id == '2023-03-14')

ft_ws_avg <- snowing_met |> 
  pull(`mean FT Wind Speed (m/s)`) |> 
  round(2)
pwl_ws_avg <- snowing_met |> 
  pull(`mean PWL Wind Speed (m/s)`) |> 
  round(2)
wd <- snowing_met |> 
  pull(`mean FT Wind Dir. (°)`) |> 
  round()
hm <- 0.9 # mean measured event parsivel
ft_ta <- traj_angle_deg(ft_ws_avg, hm) |> 
  round(0)
pwl_ta <- traj_angle_deg(pwl_ws_avg, hm) |> 
  round(0)

# CANOPY 
ft_mean_ht <- readRDS('../../analysis/lidar-processing/data/lidR_canopy_metrics/frs_s_mean_tree_height.rds') |> 
  round(2)

pwl_e_mean_ht <- readRDS('../../analysis/lidar-processing/data/lidR_canopy_metrics/pwl_e_mean_tree_height.rds') |> 
  round(2)

# HEMI STATS
vox_config_id <- "23_072_vox_len_0.25m_sa_gridgen_v2.0.0_sa"
pwl_hemi_stat <-
  readRDS(
  paste0(
    '../../analysis/lidar-processing/data/hemi_stats/hemi_raw_theta_phi_for_rho_s_upper_2_5th_percentile_',
    vox_config_id,
    "_",
    'PWL_E',
    '.rds'
  ))

ft_hemi_stat <-
  readRDS(
  paste0(
    '../../analysis/lidar-processing/data/hemi_stats/hemi_raw_theta_phi_for_rho_s_upper_2_5th_percentile_',
    vox_config_id,
    "_",
    'FSR_S',
    '.rds'
  ))

pwl_phi_to <- max(pwl_hemi_stat$phi_d) |> round()
ft_phi_to <- max(ft_hemi_stat$phi_d) |> round()
pwl_theta_to <- max(pwl_hemi_stat$theta_d) |> round()
ft_theta_to <- max(ft_hemi_stat$theta_d) |> round()
pwl_theta_from <- min(pwl_hemi_stat$theta_d) |> round()
ft_theta_from <- min(ft_hemi_stat$theta_d) |> round()

# model error stats
mod_error <- readRDS('../../analysis/lidar-processing/data/models/lca_vs_ip_model_error_ft_pwl_nadir_adj.rds')

ft_a_val <- mod_error$`Model Slope`[mod_error$`Plot Name` == 'FT' & mod_error$`Canopy Metrics` == 'Adjusted'] |> round(2)
pwl_a_val <- mod_error$`Model Slope`[mod_error$`Plot Name` == 'PWL' & mod_error$`Canopy Metrics` == 'Adjusted'] |> round(2)
```

UAV-lidar measurements of interception efficiency and canopy structure metrics collected across the study site, provided insights on how the forest canopy influenced subcanopy snow accumulation during the March 13-14 snowfall event. This event totalled 28.4 mm at the PWL snowfall gauge and was characterized by a transition from low rates of snowfall and air temperature near 0°C to higher rates of snowfall late afternoon on March 13 coinciding with air temperatures around -2.5 °C. An average wind speed of `r ft_ws_avg` m s^-1^ and direction of 188° was observed 4.2 m above the ground at FT Station. UAV-lidar measurements of throughfall, used in the calculation of interception efficiency over this event, aligned well with 28 in-situ manual throughfall measurements with a mean bias of -0.001 m and RMSE of 0.024 m. @fig-lidar-ip shows the spatial distribution of interception efficiency across the study site, calculated using @eq-ip and $\Delta SWE_{tf}$ from UAV-lidar measurements, along with $\Delta sf$ from the PWL snowfall gauge. Greater interception efficiency is observed on the north (lee) side of individual trees, which is interpreted to be a result of non-vertical hydrometeor trajectories caused by the steady southerly winds observed over this event. This effect is more apparent within the PWL forest plot, compared to the FT forest plot (@fig-lidar-ip). The average height of the canopy surrounding the plot to the east of the PWL station is `r pwl_e_mean_ht` m and surrounding the forest plot around the FT Station is `r ft_mean_ht` m.

![UAV-lidar interception efficiency calculated over the March 13, 2023 24 hr snowfall event for the FT (left) and PWL forest plots (right) at a 25 cm resolution. Transparent areas represent grids that did not have any lidar ground returns (i.e., under dense canopy proximal to tree trunks) or have been masked due to disturbance and thus have no throughfall measurement for the interception efficiency calculation. See the location of the two forest plots within FMRB in @fig-site-map.](../../analysis/lidar-processing/figs/maps/facet_ft_pwl_23_072_23_073_v2.0.0_saip_normalised_resample_0.25.png){#fig-lidar-ip}

@fig-hemi-ip-cc presents two hemisphere plots illustrating the relationship between $C_p$ and interception efficiency for both the FT and PWL forest plots. These plots demonstrate a strong correlation between $C_p$ and interception efficiency towards the southern portion of the hemisphere, aligning with the average wind direction observed during the event. For the PWL forest plot, the upper 97.5th percentile of $\rho_p$, was found between zenith angles of 0° – `r pwl_phi_to`° and azimuth angles of `r pwl_theta_from`° – `r pwl_theta_to`°. Similarly, for the FT forest plot, strong correlation was observed between ranges of zenith angles of 0° – `r ft_phi_to`° and azimuth angles of `r ft_theta_from`° – `r ft_theta_to`°. The high correlation coefficients found for non-vertical zenith angles of up to 30° for both PWL and FT are interpreted to be a result of inclined hydrometeor trajectories. At near-nadir zenith angles, @fig-hemi-ip-cc illustrates slightly lower $\rho_p$. This is because $\rho_p$ could not be calculated for some areas directly under the canopy due to missing limited interception efficiency values proximal to the trunks of individual trees as shown in @fig-lidar-ip. Higher $\rho_p$ values at near-nadir trajectory angles would be expected if throughfall measurements were available proximal to the tree trunks. However, this limitation does not significantly alter the interpretation of the results. The predicted hydrometeor trajectory angle of the event, calculated using @eq-ta, was `r ft_ta`°, considering an event measured wind speed of `r ft_ws_avg` m s^-1^ at FT Station and hydrometeor velocity of 0.9 m s^-1^ from PWL Station. This predicted hydrometeor trajectory angle is 25° more horizontal compared to the area of the hemisphere observed to have high correlation between $C_p$ and interception efficiency in @fig-hemi-ip-cc. 

![The Pearson Correlation Coefficient between rasters (25 cm resolution) of interception efficiency and leaf contact area for each grid cell across the study site for each azimuth angles (0°, 1°, ..., 359°) and zenith angles (0°, 1°, ..., 90°) for the FT (left) and PWL (right) forest plots.](../../analysis/lidar-processing/figs/voxrs/hemis/full_hemi_rho_p_cor_lca_ip_23_072_vox_len_0.25m_sa_gridgen_v2.0.0_sa_ft_pwl_.png){#fig-hemi-ip-cc}

@fig-lca-vs-ip shows that the linear relationship between $C_p$ and interception efficiency, resampled to a 5 m resolution, is stronger when $C_p$ is adjusted for the observed shift in hydrometeor trajectory, with zenith angles (0° – 30°) and azimuth angles (170° – 220°), compared to the nadir leaf contact angle (zenith angle of 0°). The strong association between adjusted $C_p$ has the potential to be a predictor of interception efficiency, before ablation. An equation to represent this linear relationship is proposed here as:

$$
  \frac{I}{P} = C_p(C_c, \theta_h, L) \cdot \alpha
$${#eq-lca-ip}

where $\alpha$ is an efficiency constant which determines the fraction of snowflakes that contact the canopy and are stored in the canopy (i.e., intercepted).

Model error statistics are presented in @tbl-ip-mod-err, calculated between the predicted interception efficiency using @eq-lca-ip with different values of $\alpha$, and observed interception efficiency. In the interception efficiency observations collected over the March 13th snowfall event, $\alpha$ values of `r pwl_a_val` and `r ft_a_val` provided the best fit for the PWL and FT plots respectively when using $C_p$ values adjusted to the trajectory angle of the event [@tbl-ip-mod-err]. The vector based model, adjusted for the hydrometeor trajectory angle, had R^2^ values of 0.69 and 0.47 for the FT and PWL forest plots, respectively. The vector based model represents a significant improvement from the nadir models, which had an R^2^ of 0.37 and -0.29, for the FT and PWL forest plots respectively. An ordinary least squares linear regression was also run using @eq-lca-ip with an intercept and showed that all models, aside from the vector based model at FT, had intercepts which were significantly different from 0 (p-value < 0.05). The vector based model for the FT forest plot was slightly different from 0 (p-value < 0.1). The difference in the residual sum of squares between the intercept and no-intercept (forced through the origin) models were found to be insignificant for the vector based FT model (p-value > 0.05), and the remaining three models were found to be significantly different (p-value < 0.001). Based on these two statistical tests suggested by @Kozak1995, forcing the intercept through the origin was not statistically justified for any of the four models. 

![Scatter plots showing the relationship between leaf contact area and interception efficiency rasters resampled to a 5 m grid cell resolution. The left plot (Nadir) shows leaf contact area measured from a zenith angle of 0°. The right plot (Vector Based) shows the leaf contact area averaged over rasters with zenith angles (0°, 1°, ... 30°) and azimuth angles (170°, 171°, ... 220°). The solid lines show the ordinary least squares linear regression forces through the origin and fit to the observed data for the PWL (red) and FT (black) forest plots and the light grey dotted line shows a 1:1 line. The R^2 values for the four different models are shown in the upper right of each panel calculated following the methods outlined in @Kozak1995.](../../analysis/lidar-processing/figs/voxrs/scatter/pwl_ft_lca_vs_ip_phi_nadir_adjusted_resample_w_mods_5m.png){#fig-lca-vs-ip}

```{r tbl-ip-mod-err, echo=FALSE}
#| label: tbl-ip-mod-err
#| tbl-cap: "Model error statistics provided for predictions of interception efficiency using @eq-lca-ip and for different $a$ values, as shown in the Model Slope column. Statistics are provided for the PWL and FT forest plots, using leaf contact area canopy metrics adjusted to zenith angles of (0°, 1°, ... 30°) and azimuth angles (170°, 171°, ... 220°) and nadir zenith angle of 0°. The Mean bias is the difference in the model and observed values, MAE is the mean of the absolute error, RMS Error is the root mean squared error and r^2 is the coefficient  of determination."

mod_error |> 
  knitr::kable()
  # knitr::kable(booktabs = TRUE,
  #              format = 'latex')

```

## Combined Effects of Meteorology and Forest Structure

```{r, include=FALSE}
library(dplyr)
hemi_stats <- readRDS('../../analysis/lidar-processing/data/hemi_stats/full_voxrs_not_filtered_to_swe_traj_angle_w_lca_23_072.rds') |> 
  mutate(find_wind = abs(1-wind_speed))

select_wind_speed <- 1
pwl <- hemi_stats |> filter(plot_name == 'PWL')
ft <- hemi_stats |> filter(plot_name == 'FT')
pwl_inc <- pwl$lca_inc[which.min(abs(select_wind_speed-pwl$wind_speed))]
ft_inc <- ft$lca_inc[which.min(abs(select_wind_speed-ft$wind_speed))]
ta <- pwl$traj_angle[which.min(abs(select_wind_speed-pwl$wind_speed))]

pwl_nadir <- pwl$lca_nadir |> unique()
ft_nadir <- ft$lca_nadir |> unique()
pwl_perc_inc <- pwl_inc / pwl_nadir * 100
ft_perc_inc <- ft_inc / ft_nadir * 100

nls_coefs <- readRDS('../../analysis/lidar-processing/data/models/ta_vs_lca_nls_coefs.rds')
```

The observed increase in $C_p$, prior to snowfall on March 13th for trajectory angles [0°, 1°, ..., 90°] and wind speeds [0 – 10 (m s^-1^)] is shown in @fig-finclca-ht-ws. Increasing the hydrometeor trajectory angle results in a substantial rise in the observed $C_p$. For example, with a wind speed of `r select_wind_speed` m s^-1^ which leads to a trajectory angle of `r ta |> round(0)`° using @eq-ta, the $C_p$ increased by a fraction of `r pwl_inc |> round(2)` and `r ft_inc |> round(2)` for the PWL and FT forest plots respectively in @fig-lca-ht-ws (right panel). This is a percent increase in the plot $C_p$ from nadir of `r pwl_perc_inc |> round(0)`% and `r ft_perc_inc |> round(0)`% for PWL and FT respectively. $C_p$ was also quantified across trajectory angles for both PWL and FT on March 14th, post snowfall, and showed a negligible effect of canopy snow load on $C_p$.

<!-- These figures are generated under the lidar-processing project using scripts 11-13. This generates 100's of GB of data on RAM and therefore scripts 11 and 12 are run on copernicus and the resulting df is sent over to local to run script 13. Can run this locally if we use a larger step across phi and theta angles.  -->

![Plots showing the increase in measured leaf contact area prior to snowfall (March 13th) with hydrometeor trajectory angle (left) and mid canopy wind speed (right). Hydrometeor trajectory angle is measured as degrees from zenith. Mid canopy wind speed was calculated as a function of hydrometeor trajectory angle by rearranging @eq-ta. The solid lines (obs) represent the observed leaf contact area from VoxRS, the dashed lines (mod) represent predictions from a non-linear least squares regression (nls, blue) and ordinary least squares regression (lm, green) on the VoxRS observed data, and the dotted lines (HP98) represent the predictions from Equation 10 in @Hedstrom1998a. A forested downwind distance of 100 m was used for the HP98 calculation. The line colour represents the forest plot, FT (black), PWL (red) and the non-linear least squares regression fit to both plots in (green).](../../analysis/lidar-processing/figs/voxrs/scatter/WITH_TREEWELLS_traj_angle_and_wind_phiby_1_thetaby_2_traj_angle_wind_speed_vs_fractional_inc_lca_snow_off_w_mods_hp98_mean_sd_23_072.png){#fig-finclca-ht-ws}

The rise of $C_p$ with increasing trajectory angle, shown in @fig-finclca-ht-ws, is similar for both forest plots FT and PWL until trajectory angles reach approximately 60°. Beyond 60°, the PWL rate of increase slows as the $C_p$ approaches one, while the FT plot, which has lower nadir $C_c$, continues to rise until around 75°. A non-linear least squares regression using a logistic function and a ordinary least squares regression using a linear function were fit to the FT and PWL observations and are shown in @fig-finclca-ht-ws. The @Hedstrom1998a increase in $C_p$ with trajectory shown in @fig-finclca-ht-ws fails to represent the VoxRS observations. The logistic function used to model the observations is:  

$$
C_{inc} = \left(
\frac{C^{max}_{inc}}{1 + e ^ {\left(\frac{\theta_0 - \theta_h}{\text{k}}\right)}} - \frac{C^{max}_{inc}}{1 + e ^ {\left(\frac{\theta_0}{\text{k}}\right)}}
\right)
$${#eq-lca-inc}

where, $C_{inc}$ is the increase in leaf contact area, $C^{max}_{inc}$ is the maximum value of $C_{inc}$, $\theta_0$ is the x value of the sigmoid midpoint and $k$ is the logistic growth rate or steepness of the curve. Resulting coefficients for $LCA_{max}$, $\theta_0$ and $k$ derived across the VoxRS observations from the PWL and FT forest plots were `r nls_coefs['Asym'] |> as.numeric() |> round (3)`, `r nls_coefs['xmid'] |> as.numeric() |> round (3)` and `r nls_coefs['scal'] |> as.numeric() |> round (3)` respectively. A logistic function was selected to model this relationship, as its shape was deemed most appropriate to represent the change in $C_p$ with trajectory angle. This choice reflects the expected slow increase in $C_p$ due to the conical shape of the trees, which have less leaf area near the top. The logistic function also captures the non-linear increase at more horizontal trajectory angles, where snowflakes encounter more canopy area in the middle and lower section of individual trees. Additionally, the function effectively represents the gradual levelling off of $C_p$ as it approaches full coverage (value of one).

$$
C_p = C_c + C_{inc}
$${#eq-lca-ac}

Simulated $C_p$ using the logistic function in @eq-lca-ac is shown in @fig-lca-ht-ws for trajectory angles [0°, 1°, ..., 90°] and wind speeds [0 – 10 (m s^-1^)] and is shown to align well with the VoxRS observations for trajectory angles below 60°. Model error statistics shown in @tbl-lca-mod-err, indicate that @eq-lca-ac demonstrated slightly better performance with a mean bias and RMSE of -0.005 and 0.033 respectively, compared to the linear regression, with a mean bias of 0.006 and an RMSE of 0.044. The @Hedstrom1998a method exhibited very poor estimates of $C_p$.

<!-- These figures are generated under the lidar-processing project using scripts 11-13. This generates 100's of GB of data on RAM and therefore scripts 11 and 12 are run on copernicus and the resulting df is sent over to local to run script 13. Can run this locally if we use a larger step across phi and theta angles.  -->

![Plots showing the relationship between hydrometeor trajectory angle (left) and mid canopy wind speed (right) with leaf contact area. Hydrometeor trajectory angle is measured as degrees from zenith. Mid canopy wind speed is calculated as a function of hydrometeor trajectory angle by rearranging @eq-ta. The solid lines (obs) represent the observed leaf contact area from VoxRS, the dashed lines (mod) represent predictions from @eq-lca-ac, and the dotted lines (HP98) represent the predictions from Equation 10 in @Hedstrom1998a. A forested downwind distance of 100 m was used for the HP98 calculation. The line colour represents the forest plot, FT (black), PWL (red) and the non-linear least squares regression fit to both plots in (green).](../../analysis/lidar-processing/figs/voxrs/scatter/WITH_TREEWELLS_traj_angle_and_wind_phiby_1_thetaby_2_traj_angle_wind_speed_vs_lca_w_mods_w_hp98_mean_sd_23_072.png){#fig-lca-ht-ws}

```{r tbl-lca-mod-err, echo=FALSE}
#| label: tbl-lca-mod-err
#| tbl-cap: "Model error statistics calculated for the prediction of leaf contact area from trajectory angle using @eq-lca-inc (nls), using a linear function from the observations in this study (lm), and Equation 10 from @Hedstrom1998a. Mean bias is the difference in the model and observed values, MAE is the mean of the absolute error, RMS Error is the root mean squared error and r^2 is the coefficient of determination."

mod_error <- readRDS('../../analysis/lidar-processing/data/models/lca_obs_mod_error_tbl.rds')

mod_error |> 
  knitr::kable()
  # knitr::kable(booktabs = TRUE,
  #              format = 'latex')
```

# Discussion

At the point scale, relatively little influence of meteorology on interception efficiency was found in the observations collected from this discontinuous subalpine forest. A slight increase in interception efficiency was observed at the SCLs with increasing wind speeds below 1.5 m s^-2^ and canopy snow loads below 7 kg m^-2^ and is attributed to an associated increase in the $C_p$ [@fig-lai-met-ip, C & D]. At wind speeds above 2 m s^-1^, interception efficiency was observed to decline by a maximum of 0.1 (-) and could be attributed to increasing hydrometeor velocity leading to increased bouncing of snowflakes off branches and wind-induced unloading [@Roesch2001; @Lumbrazo2022; @Katsushima2023]. The increase in interception efficiency up to canopy snow loads of 7 kg m^-2^ and then subsequent decline is attributed to the position of the SCLs within forest gaps. Timelapse imagery showed that branches surrounding the SCLs compressed at snow loads above 7 kg m^-2^ reducing the canopy coverage above the instruments. This is similar to the theory proposed by @Satterlund1967 that interception efficiency increases as the canopy fills with snow bridging gaps in the canopy, while later declining due to branch bending and decreased canopy coverage. @Hedstrom1998a and @Storck2002 did not observe this initial increase, but are consistent in declining interception efficiency at high snow loads. The observations presented in @fig-lai-met-ip, differ from the @Satterlund1967, @Hedstrom1998a, @Storck2002 and @Moeser2015 theories, in that the decline in interception efficiency at high canopy snow loads was at a rate much slower than has been observed by these studies. The strong exponential decline in interception efficiency observed with increasing event snowfall in Satterlund1967, @Hedstrom1998a, @Storck2002 and @Moeser2015 (see fig X in @Cebulski2024b) may be a result of increased unloading rates as branches compress with heavy snow loads. The longer duration between site visits in [@Satterlund1967; @Hedstrom1998a; @Moeser2015] increase the likelihood of canopy snow ablation in their throughfall measurements compared to the automated 15 minute measurements in this study. This potential inclusion of canopy snow ablation within the interception parameterizations provided in [@Hedstrom1998a; @Satterlund1967; @Moeser2015; @Storck2002] may lead to double counting of unloading when combined with an additional unloading parameterizations.

The observations presented in this study deviate from the relationships outlined in @Hedstrom1998a and @Storck2002 which suggested either a positive [@Storck2002] or negative [@Hedstrom1998a] association of air temperature with the canopy snow storage capacity (see fig. X @Cebulski2024b). Specifically, the increase in canopy snow load with increasing snowfall shown in @fig-scl-w-sf, did not show evidence of reaching a canopy snow storage capacity. The ablation of canopy snow at higher canopy snow loads prevented the observation of a maximum canopy snow storage capacity. @Lundquist2021 reported improved simulation of subcanopy snow accumulation without the use of a maximum canopy snow storage capacity when combined with ablation process representations for canopy snow melt, sublimation, wind-induced unloading and temperature induced unloading. However, @Lehtonen2016 note that in northern Finland heavy canopy snow loads have been observed to continue increasing until stem breakage, under the air temperature, humidity and wind conditions favourable for the formation of significant rime-ice accretion and limited ablation. While further research is required to understand the canopy snow load required to cause stem breakage across different tree species, additional research on canopy snow ablation processes could better represent the decline in interception efficiency with increasing canopy snow loads that has been observed by @Satterlund1967, @Schmidt1990, @Hedstrom1998a and @Moeser2015. 

Empirical evidence to support the theory of increased in canopy contact area with increased wind speed [@Hedstrom1998a] has not been provided in the literature. Measurements of interception efficiency collected by UAV-lidar surveys for a snowfall event with a `r ft_ws_avg` m s^-1^ average wind speed showed a large fraction of snow intercepted on the lee side of individual trees as shown in @fig-lidar-ip due to predominately non-vertical hydrometeor trajectory angles. A greater footprint of increased interception efficiency was observed across the PWL study site and is attributed to the large difference in canopy coverage between the two plots rather than localized wind flow patterns. Despite the difference in interception efficiency observed across the two forest plots, a similar zone of high correlation between $C_p$ and interception efficiency was found in the hemisphere plots shown in @fig-hemi-ip-cc. Using the average wind speed observed at FT station, @eq-ta predicted a trajectory angle that was more horizontal compared to the observations from the hemisphere plots. This may be partially explained by three factors, 1) the height of the wind speed measurement at 4.2 m may be higher than the dominant wind flow important for controlling hydrometeor trajectory and subsequent interception (i.e., the conical shape of needleleaf trees have a larger surface area closer to the ground), 2) extrapolating wind speed measured within sparse canopy (FT Station) to regions characterized by higher stem density across the study site, where wind speed may have been lower leading to more vertical trajectory angles, and 3) the theory proposed in @eq-ta assumes a linear hydrometeor trajectory, and does not consider non-linear patterns such as wind flow wrapping around tree elements, turbulent flow, or differences in wind speed with height. Future use of @eq-ta should therefore utilize wind speeds scaled down to a lower height above ground using @eq-uz, such as 1/3 the canopy height as suggested by @Katsushima2023. Wind speed and direction were shown to be important factors influencing the portion of the hemisphere that governed snow accumulation [@fig-hemi-ip-cc]. However, at the forest plot scale, directional differences are expected to be negligible compared to the increase in leaf contact area with trajectory angle. At this scale, @eq-lca-inc, which uses trajectory angle alone, could be sufficient to determine $C_{inc}$.

This study, in agreement with previous research [@Calder1990; @Lundquist2021], did not observe an association between canopy snow load and interception efficiency. These findings challenge the theoretical basis of the existing snow interception parameterizations [@Hedstrom1998a; @Storck2002; @Satterlund1967; @Moeser2015], and suggest these models may need revision. To address this a new snow interception parameterization, @eq-lca-ip, is presented which calculates interception efficiency as a function of $C_p$ and $\alpha$. This new parameterization allows for canopy snow loading processes to be isolated from canopy snow ablation processes following suggestions in @Cebulski2024b to be more consistent with the rainfall interception literature [@Valante1997]. @eq-lca-ip differs only slightly from the original @Hedstrom1998a parameterization (see Equation 6 in @Hedstrom1998a), in that it does not calculate interception efficiency as a function of canopy snow load and from the @Storck2002 parameterization who found interception efficiency to be a constant. The theoretical basis of the $\alpha$ value in @eq-lca-ip is that the association between $C_p$ and interception efficiency, as shown in @fig-lca-vs-ip, does not follow a 1:1 line as snow flakes may bounce off the canopy elements. Some minor redistribution of snow during between UAV-lidar scans may have lowered the $a$ value and in reality may be slightly higher if considering measurements of interception efficiency without unloading. Although, no relationship was found between interception efficiency and air temperature in this study [@fig-lai-met-ip], @Lundquist2021 discuss that the cohesion and adhesion of individual snowflakes to canopy elements is a function of air temperature and may influence the $a$ value. This new snow interception parameterization, is also consistent with @Lundquist2021 who showed success using a constant interception efficiency value for a point location. However, since $C_c$ is a canopy metric typically available across the globe, @eq-lca-ip, when combined with @eq-lca-ac and @eq-lca-inc, provides a way to determine interception efficiency spatially across the landscape. This method is also similar to the rainfall interception literature, which calculate throughfall as a function of $C_c$ [i.e., @Valante1997], and minimizes the mixing of ablation and interception processes. However, in @Valante1997, rainfall interception is assumed to be completely efficient (i.e., $\alpha$ = 1). Moreover, the use of $C_c$ in @Valante1997 to calculate rainfall interception is not adjusted for hydrometeor trajectory angle. While the higher terminal fall velocity of rainfall compared to snow would result in a smaller sensitivity of $\theta_h$ to wind speed for rainfall [@fig-ws-vs-ta], this still may result in an underestimate of rainfall interception [@Herwitz1995; @VanStan2011]. The large sensitivity of $C_p$ to hydrometeor trajectory angle and the associated implications for subcanopy snow accumulation shown in this study, resulting from relatively common wind speeds of 1-2 m s^-1^, suggests that this may be an important process to consider, especially in snow dominated basins. 

A substantial increase in plot scale $C_p$ was shown as a result of increasing hydrometeor trajectory angle which led to an increase in the number of contacts with needleleaf canopy elements. Compared to this, the influence of canopy snow load on interception efficiency at the point scale in @fig-lai-met-ip was relatively small. The negligible change in $C_p$ observed at the plot scale after a large snowfall event suggests incorporating canopy snow load in interception efficiency parameterizations may not be necessary for this study site. This is interpreted to be due to compensatory effects, where snow load may increase the $C_p$ for vertical zenith angles in grid cells beneath the canopy as snow bridges gaps in the canopy elements. However, branch bending may also lead to a decrease in $C_p$ for grid cells within gaps between the canopy or for non-vertical trajectory angles. @Staines2023, showed a slight increase from $C_p$ calculated from snow-off conditions from a single UAV-lidar scan compared to snow-on conditions derived from a combination of three UAV-lidar scans. The higher forest density in the @Staines2023 study resulted in more of their study area beneath canopy elements, and was not as influenced by branch bending, resulting in a slightly higher influence of snow load on $C_p$. Still, the increase in $C_p$ resulting from snow load in @Staines2023 was smaller compared to the substantial rise in $C_p$ due to trajectory angle. An existing method proposed in @Hedstrom1998a to scale canopy coverage with wind speed failed to reproduce the observation presented in @fig-lca-ht-ws. A new method is proposed, @eq-lca-inc, which uses logistic function to calculate $C_{inc}$ as a function of $\theta_h$ and $C_c$. There was only a slight improvement in the non-linear formulation of @eq-lca-inc compared to the linear equation, however, the non linear function provided a better balance between the two forest plots as shown in @fig-finclca-ht-ws, and is more physically realistic in providing a method to slow the initial increase and limit the increase in $C_p$ as it approaches one. Further work is required to refine the relationship proposed in @eq-lca-inc across a range of tree species and densities, determine how to calculate the canopy snow storage capacity, reassess canopy snow ablation parameterizations of the new snow interception routine.

# Conclusions

-   No influence of air temperature, relative humidity, hydrometeor velocity, or hydrometeor diameter on interception efficiency was observed from the high-frequency point scale measurements. These measurements also showed interception efficiency increased slightly with wind speed and low-moderate canopy snow loads as a result of increasing the leaf contact area. A slight decline in interception efficiency at higher canopy snow loads was observed at the point scale and was attributed to branch bending reducing the canopy coverage of the instruments.  
-   At the forest plot scale, UAV-lidar measurements showed leaf contact area is the main factor governing the fraction of intercepted snowfall at a particular site. At this scale the decline in interception efficiency in forest gaps due to branch bending appeared to be balanced by the increase in leaf contact area within the canopy due to increased snow load. Snow accumulation and canopy structure metrics from a wind-driven snowfall event revealed canopy structure metrics adjusted for trajectory angle provided an improved predictor of interception efficiency compared to nadir canopy coverage. 
-   Leaf contact area was observed to double for wind speeds of 1 m s^-1^ in the discontinuous subalpine forest in this study. The effect of wind on leaf contact area can have large implications for the amount of snow intercepted in the canopy and thus subject to sublimation back to the atmosphere. An existing theoretical relationship failed to represent the increase in leaf contact area with wind speed at this site.
-   A new snow interception parameterization has been presented which calculates initial interception, before canopy snow ablation, as a function of snowfall rate and leaf contact area which is consistent with the rainfall interception literature and other recent observations of snow interception. 
-   A second equation is proposed to estimate the increase in leaf contact area from nadir canopy coverage as a function of hydrometeor trajectory angle. This relationship was shown to follow a relatively similar relationship at two forest plots with differing canopy structure and could be represented by a single parameterization. 
-   Good performance of this updated snow interception parameterization has been shown in this subalpine forest, but further validation should be conducted in a range of climates, forest species and structures. Caution should be taken in using this updated interception routine with existing canopy snow ablation parameterizations as they were developed using earlier snow interception routines that also included ablative processes. Future work will involve revising canopy snow ablation routines to work with this new snow interception routine.

# Acknowledgments

We wish to acknowledge financial support from the University of Saskatchewan, Natural Sciences and Engineering Research Council of Canada, Global Water Futures Programme, Alberta Innovates and the Canada Research Chairs Programme. We thank Madison Harasyn, Hannah Koslowsky, Kieran Lehan, Lindsey Langs and Fortress Mountain Resort for their help in the field. Madison Harasyn, Alistair Wallace, and Rob White contributed to developing the UAV-lidar processing workflow.

# Data Availability

The authors declare there are no competing interests.

\pagebreak

# References
