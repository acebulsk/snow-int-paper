---
title: "Snow Interception Relationships with Meteorology and Canopy Structure in a Subalpine Forest"
format: 
  # docx:
  #   reference-doc: ../config/word_template_hp.docx
  #   number-sections: true
  #   toc: false
  pdf:
    colorlinks: false
    keep-tex: true
    number-sections: true
    toc: false
    # linestretch: 1.5 # set inline instead
  # html:
  #   toc: false
  #   self-contained: true
# crossref:
#   tbl-prefix: Tbl     # (default is "Table")
#   fig-prefix: Fig
editor: source
bibliography: ../../papers/bibtex/library.bib
csl: '../../papers/bibtex/csl-styles/apa-disable-disambiguate-add-names.csl'
nocite: |
  @Cionco1965
header-includes:
  - \usepackage[left]{lineno}
  - \linenumbers
  - \usepackage{xcolor}
  - \usepackage{float} # allow tables after section header
  - \floatplacement{table}{H} # allow tables after section header
  - \usepackage{setspace}
---
\setstretch{1.5} 

<!-- From https://onlinelibrary.wiley.com/page/journal/10991085/homepage/forauthors.html - Papers submitted for publication should be concise and not exceed the 7500 word limit. The following sections are included as part of the word count: abstract; main text; and the acknowledgements. The following sections are excluded: title page, including author list and affiliations; bibliography; figure legends and supporting information. Figures and supporting information should be supplied as separate files. -->

```{r, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message=FALSE, warning=FALSE, fig.align='center')

source('scripts/manuscript_values.R')
```

**Authors:**

A. Cebulski^1^ (ORCID ID - 0000-0001-7910-5056)

J.W. Pomeroy^1^ (ORCID ID - 0000-0002-4782-7457)

^1^Centre for Hydrology, University of Saskatchewan, Canmore, Canada

**Corresponding Author:** A. Cebulski, alexcebulski@gmail.com

**Abstract:** Snow accumulation models differ in how snow interception and ablation processes are represented and thus their application to diverse climates and forest types is uncertain. Existing parameterizations of initial snow interception before unloading include inherently coupled canopy snow accumulation and ablation processes. This leads to difficulty in diagnosing processes and adding possible errors to simulations when incorporated as canopy interception routines in models that already account for canopy snow ablation. This study evaluates the theory underpinning these parameterizations using high-temporal resolution and fine-scale measurements of throughfall for events with minimal snow ablation and redistribution in both the canopy and on the ground. The relationship between these throughfall measurements, event meteorology, and a novel lidar-based measurement of canopy structure are assessed in two subalpine forest plots in the Canadian Rockies. Contrary to existing theories, no association of canopy snow load or air temperature with interception efficiency was observed. Instead, canopy structure emerged as the primary factor governing snow accumulation. A wind-driven snowfall event demonstrated that non-vertical hydrometeor trajectories can significantly increase snow-leaf contact area, thereby enhancing initial interception before ablation. Prediction of interception efficiency for this event improved dramatically when adjusted for hydrometeor trajectory angle based on a wind speed at one-third of the canopy height. Snow-leaf contact area showed a high sensitivity to wind speed, increasing by up to `r round(ft_frac_inc * 100, 0)`% with a 1 m s^-1^ wind speed. The study proposes a new parameterization that calculates throughfall, independent of processes that ablate snow from the canopy, as a function of snow-leaf contact area adjusted for hydrometeor trajectory angle. This new parameterization successfully estimated subcanopy snow accumulation for a snowfall event at two forest plots measured using lidar and snow surveys. By separating canopy snow ablation from snow interception processes, this new model offers potentially improved prediction of subcanopy snow accumulation when combined with canopy snow ablation parameterizations.

**Keywords:** snow interception, throughfall, ablation, forest, snowpack, lidar, process-based modelling

# Introduction

Over half of North America's snow-covered zone is covered by forests [@Kim2017], significantly impacting the accumulation and redistribution of snowpacks and subsequent snowmelt runoff. @Essery2003 estimated that 25–45% of annual snowfall may be lost to the atmosphere due to sublimation of snow intercepted in forest canopies globally. Snow intercepted in the canopy can sublimate and melt at much higher rates than the subcanopy snowpack [@Lundberg1994; @Pomeroy1998b; @Floyd2012b], reducing the amount of snow available for runoff. Vegetation structure is one of the primary factors controlling the partitioning of snowfall into throughfall and interception, and thus governs the quantity of snow subject to sublimation from the canopy [@Hedstrom1998a; @Storck2002]. However, forest thinning efforts aimed at limiting sublimation losses to increase snowmelt runoff do not always lead to a corresponding increase in spring streamflow [@Golding1978; @Harpold2020; @Troendle1983; @Pomeroy2012]. This may be due to increased ablation rates when forest cover is reduced, desynchronization of snowmelt, and sub-surface hydrology interactions [@Ellis2013; @Musselman2015a; @Pomeroy1997; @Varhola2010; @Safa2021]. Due to the significant impact of forest cover on snow accumulation and ablation, and sparse or absent monitoring networks for subcanopy snow accumulation [@Vionnet2021; @Rittger2020], land management, ecological conservation and water resource decisions rely on robust models of snow redistribution to estimate past, current and future subcanopy snowpacks.

@Hedstrom1998a, working in the cold continental boreal forest, proposed that initial snow interception efficiency was controlled by the maximum canopy load which itself was a function of leaf area index and air temperature. Unloading was found to be an exponential function of time and observed only days or weeks after the interception event. @Storck2002, working in temperate coastal forests, emphasized the role of air temperature in controlling the maximum canopy snow load. @Gelfan2004 demonstrated accurate subcanopy snowpack simulations at study sites in Russia by treating the @Hedstrom1998a and @Storck2002 parameterizations separately while using a step-based function to choose either parameterization based on temperature. A similar parameterization in the Cold Regions Hydrological Model [@Pomeroy2022] has shown strong performance at sites across Canada, northern United States, Switzerland, and Spain. However, overestimation of subcanopy snow accumulation was reported by @Lundquist2021 and @Lumbrazo2022 when combining the @Hedstrom1998a routine with ablation parameterizations from different studies [e.g., @Roesch2001]. The coupling of ablation processes within existing snow interception models [@Hedstrom1998a; @Storck2002] may contribute to overestimates of throughfall, canopy snow unloading, and canopy snow melt when combined with other canopy snow ablation parameterizations. Additional observations of snow interception that exclude ablation processes could help determine the applicability of the interception theories proposed by @Hedstrom1998a and @Storck2002. Hedstrom & Pomeroy’s (1998) theory also suggests that moderate wind speeds, which can result in more horizontal hydrometeor trajectories and increase the snow-leaf contact area and interception efficiency at the plot scale. This association has also been shown in rainfall interception studies to decrease throughfall of rain [@Herwitz1995; @VanStan2011]. Despite this importance for rainfall, the relationship proposed by @Hedstrom1998a, has typically not been included in snow accumulation models [@Mahat2014; @Clark2020] and empirical testing of this relationship is lacking.

The objective of this paper is to evaluate the theories underlying existing snow interception models using high spatial and temporal resolution measurements of subcanopy snow accumulation for events with minimal canopy snow ablation. These new observations are investigated to address the following research questions: 

  1. Are the existing theories regarding the relationships between meteorology and forest structure and snow interception supported by in-situ observations?

  2. Is snow interception influenced by non-vertical hydrometeor trajectory angles over a wind-driven snowfall event? 

  3. To what extent can these findings inform the development of a new parameterization for snow interception?

# Theory

## Snow Interception

The canopy snow load, $L$ (kg m^-2^) can be estimated from the mass balance:

$$
\frac{dL}{dt} = 
q_{sf} - q_{tf} - q_{unld} - q_{drip} - q_{wind}^{veg} - q_{sub}^{veg}
$$ {#eq-canopy-mass-bal}

where $q_{sf}$ is the snowfall rate (kg m^-2^ s^-1^), $q_{tf}$ is the throughfall rate (kg m^-2^ s^-1^), $q_{unld}$ is the canopy snow unloading rate (kg m^-2^ s^-1^), $q_{drip}$ is the canopy snow drip rate due to canopy snowmelt (kg m^-2^ s^-1^), $q_{wind}^{veg}$ is the wind transport rate in or out of the control volume (kg m^-2^ s^-1^), and $q_{sub}^{veg}$ is the intercepted snow sublimation rate (kg m^-2^ s^-1^).

During periods with low air temperatures and low wind speeds, $q_{unld}$, $q_{drip}$, $q_{wind}^{veg}$, and $q_{sub}^{veg}$ can be assumed negligible. Interception efficiency, $\frac{I}{P}$ (-), which is the fraction of snowfall intercepted over $\Delta t$ before ablation, can then be calculated during these periods as:

$$
\frac{I}{P} = \frac{\Delta L}{\overline{q_{sf}} \Delta t}
$$ {#eq-ip}

and throughfall, $q_{tf}$ can be calculated as:

$$
q_{tf} = \left(1 - \frac{I}{P} \right) \cdot q_{sf}
$$ {#eq-event-tf}

## Hydrometeor Trajectory Angle

The trajectory angle, $\theta_h$ of a hydrometeor as the departure in degrees (°) from a vertical plane, is shown in @Herwitz1995 to be calculated as:

$$
\theta_h = \arctan \left(\frac{x_h(u_z)}{v_h(D_h)}\right)*\frac{180}{\pi}
$${#eq-ta}

where $v_h(D_h)$ is the terminal fall velocity of the hydrometeor (m s^-1^), which is a function of the hydrometeor diameter, $D_h$ and $x_h(u_z)$ is the horizontal velocity of the hydrometeor (m s^-1^) which is a function of the within canopy wind speed, $u_z$ at height above ground, $z$. This assumes the hydrometeors are following fluid points in the atmosphere.

# Data and Methods

## Study Site

This study was conducted at Fortress Mountain Research Basin (FMRB), Alberta, Canada, -115° W, 51° N, a continental headwater basin in the Canadian Rockies (@fig-site-map). Data from this study was collected between October 2021 and July 2023 within and surrounding two forest plots adjacent to the FMRB Powerline Station (PWL) and Forest Tower Station (FT) at ~2100 m above sea level as shown in @fig-site-map. The average annual precipitation at PWL Station from 2013 to 2023 was 1045 mm, with the peak annual snow water equivalent (SWE) reaching 465 kg m^-2^, typically occurring in late April. The PWL and FT forest plots include discontinuous stands of 70% subalpine fir (Abies lasiocarpa) and 30% Engelmann spruce (Picea engelmannii) [@Langs2020]. The PWL plot is located 120 m to the northwest of FT station and contains a forest clearing with a diameter of ~12 m, surrounded by a closed canopy. The canopy coverages of the two forest plots are `r pwl_cc_nadir` and `r ft_cc_nadir` and the winter leaf area indices are 2.07 and 1.66 for PWL and FT respectively. The average height of the canopy surrounding the plot to the east of the PWL station is `r pwl_mean_ht` m and surrounding the forest plot around the FT Station is `r ft_mean_ht` m. The forest of the FT plot has a discontinuous canopy without artificial clearings. In August of 1936, the majority of vegetation in FMRB burned during a large forest fire that affected most of the Kananaskis Valley [@Fryer1988]. Following the fire, the forest within the PWL and FT forest plots has naturally regenerated, though some trees have been removed for road clearing and creation of a snow study plot.

![Map showing the location of forest plots, flux towers, subcanopy lysimeter instruments (SCL), and survey transects. The inset map on the lower right shows the regional location of Fortress Mountain Research basin.](figs/maps/site_map_inset.png){#fig-site-map}

## Meteorological Measurements

Measurements of air temperature and relative humidity (Vaisala model HMP155A), wind speed and direction (RM Young model 86000 2-D ultrasonic anemometer) were made 4.3 m above the ground at FT station (@fig-site-map). Wind speed measurements from a 3-cup anemometer (Met One model 014A), installed adjacent to the 2-D ultrasonic anemometer at 4.3 m, were used for gap filling wind speed. Additional wind speed measurements were collected by two 3D sonic anemometers (Campbell Scientific CSAT3) installed at 2 m (raised to 3 m February 2022) and 13.5 m above the ground at FT station. Average wind speeds at these four heights were found to follow a logarithmic relationship for periods where the instruments were known to be clean of snow. Thus, a wind profile was fitted to these measurements using the Prandtl-von Kármán log-linear relationship:

$$
\overline{u} = \frac{u_*}{k} ln(\frac{z - d_0}{z_0})
$${#eq-log-wind-profile}

where $\overline{u}$ is average wind speed (m s^-1^) at height, $z$ (m) above the ground, $u_*$ is the friction velocity (m s^-1^), $d_0$ is the displacement height (m), $z_0$ is the roughness length of momentum (m), and $k$ is the dimensionless von Kármán Constant (0.4). 

To determine the displacement height and roughness length parameters the function "optim" from the stats R package [@R2024] was used. The parameters found for the wind speed profile include a roughness length of 0.50 m and displacement height of 0.58 m. At PWL station, the snowfall rate was measured by an Alter-shielded OTT Pluvio weighing precipitation gauge 2.6 m above ground, corrected for undercatch following phase correction by @Harder2013 and catch efficiency by @Smith2007. Wind speed for undercatch correction was measured by a 3-cup anemometer (Met One model 014A) at a height of 2.6 m at PWL station. An optical disdrometer (OTT Parsivel2) provided measurements of hydrometeor particle size and vertical velocity. All measurements were recorded at 15-min intervals using Campbell Scientific dataloggers, except the Parsivel2 which was recorded at 1-minute intervals by an onsite computer.

## Lysimeter Measurements

Three subcanopy lysimeters (SCLs) were installed surrounding the FT Station (@fig-site-map) to provide 15-minute interval measurements of throughfall as in @MacDonald2010. @fig-scl-imgs shows the three SCLs which consisted of a plastic horse-watering trough with an opening of 0.9 m^2^ and depth of 20 cm suspended from a load cell (Intertechnology 9363-D3-75-20T1) attached to an aluminum pipe connected between two trees. For 26 distinct snowfall events, where canopy snow ablation rates were deemed negligible, the throughfall rate, $q_{tf}$, was calculated by dividing the weight of snow in the SCL by the cross-sectional area of the SCL opening and determining the rate of change at 15-minute intervals. Canopy snow load was estimated at the same 15-minute intervals during these events using @eq-canopy-mass-bal and incorporating measurements of $q_{tf}$ from the SCLs and $q_{sf}$ from the PWL snowfall gauge. Interception efficiency was also calculated for these intervals using @eq-ip. Timelapse imagery, mass change on a weighed tree lysimeter "hanging tree" [@Pomeroy1993a] and in-situ observations were used to ensure the ablation of snow intercepted in the canopy was minimal over each interval. Additionally, the $q_{tf}$ measurements were filtered to include observations with a snowfall rate > 0 kg m^-2^ hr^-1^, throughfall rate > 0.05 kg m^-2^ hr^-1^ and a snowfall rate greater than the subcanopy lysimeter throughfall rate to minimize observations with unloading. The weighed tree lysimeter, a live subalpine fir (Abies lasiocarpa) tree suspended from a load cell (Artech S-Type 20210-100) measured the weight of canopy snow load, $L_{wt}$ (kg). The weight of snow intercepted on the weighed tree was scaled to an areal estimate of canopy snow load ($L$, kg m^-2^) using measurements of areal throughfall (kg m^-2^) from manual snow surveys and snowfall from the PWL Station snowfall gauge [see description of method in @Pomeroy1993a]. The canopy structure surrounding three SCLs is shown in @fig-scl-imgs and was measured using hemispherical photography (Nikon Coolpix 4500 and EC-F8 hemispherical lens) and the hemispheR R package @Chianucci2023. The leaf area index and canopy coverage from hemispherical photo analysis is shown in @tbl-scl-lai-cc. 

```{r scl, echo=FALSE}
#| label: tbl-scl-lai-cc
#| tbl-cap: "Canopy structure of the three subcanopy lysimeters (SCL) located proximal to the FT Station. Leaf area index (LAI) and Canopy Coverage was measured using hemispherical photo analysis with the R package hemispheR."
#| 

scl_lai_cc |> 
  arrange(cc) |> 
  mutate(cc = round(cc, 2)) |> 
  select(Name, `LAI (-)` = Le, `Canopy Coverage (-)` = cc) |> 
  knitr::kable(#booktabs = TRUE,
               #format = 'latex'
               )
```

![Images of the three subcanopy lysimeters (SCL) and surrounding canopy located in sparse (a), mixed (b), and dense (c) canopy. The top row presents a side view of each SCL and the bottom row shows hemispherical photographs classified using the hemispheR R package. These hemispherical images are oriented with north at the top and have been flipped to provide a view from above (i.e., east is on the right side of each image).](figs/site-photos/scl_w_fisheye_textnew.png){#fig-scl-imgs}

## UAV-Lidar Data Collection and Processing

The UAV (FreeFly Alta X) payload included a REIGL miniVUX-2 airborne laser scanner, an Applanix APX-20 inertial measurement unit (IMU) and global navigation satellite system (GNSS). The UAV was flown 90 m above the ground at a speed of 3 m s^-1^ following the path shown in @fig-site-map. A detailed description of the UAV, payload, and flight settings is provided in the supporting information. The methods outlined by @Harder2020 and @Staines2023 were incorporated to reconcile survey lidar, IMU and GNSS data. A vertical offset of up to 6 cm between UAV-lidar flight lines was observed in the resulting point clouds on March 13^th^ and 14^th^, 2024 and was attributed to IMU position drift. This offset between flight lines was corrected using the BayesStripAlign software v2.24 [@BayesMap2024]. After strip alignment, the mean elevation bias was 0.000 m and the RMS error declined from 0.055 m to 0.038 m on March 13^th^ and changed from 0.033 m to 0.029 m on March 14^th^. The point cloud density ranged from ~1200 returns m^2^ in sparse forest to ~2200 returns m^2^ in open clearings after flight paths were combined for each survey. Quality control, ground classification, calculation of the change in between two UAV-lidar point clouds, and raster generation (0.05 m grid cell resolution) was conducted using the LAStools software package [@LAStools2024]. Post processing and resampling of raster data to a 0.25 m grid cell resolution was conducted using the 'Terra' R package [@Hijmans2024]. More details on the UAV-lidar processing workflow are provided in the supporting information.

## Snow Surveys

### In-situ Snow Depth and Density

Twelve in-situ fresh snow surveys (six pre- and post-snowfall event pairs) provided measurements of subcanopy throughfall depth and density at 30 locations following the transects shown in @fig-site-map to upscale the weighed tree snow load as in @Hedstrom1998a. Minimal ablation and redistribution of snow was observed between the pre- and post-snowfall surveys. When conditions allowed for a UAV-lidar flight, the in-situ snow surveys were conducted following the UAV-lidar flight to assess the accuracy of the throughfall measurements and provide a fresh snow density for the calculation of SWE (kg m^-2^). A 1000 cm^3^ Perla snow density wedge sampler (RIP Cutter, https://snowmetrics.com/shop/rip-1-cutter-1000-cc/) was used to measure the density of the fresh snow layer, $\overline{\rho_{tf}}$ (kg m^-3^) from snow pits. Throughfall depth measurements, $\Delta HS$ were converted to SWE using the following equation:

$$
\Delta SWE_{tf} = \Delta HS \cdot \overline{\rho_{tf}}
$${#eq-swe-tf}

Differential GNSS rover coordinates, with ± 2.5 cm 3D uncertainty, were taken at each snow sampling location so the locations could be queried later from the UAV-lidar rasters to assess measurement error and were also used as input for the UAV-lidar strip alignment. If a pre-event crust layer was present, the depth of post event fresh snow accumulation above the crust layer was interpreted as throughfall over the event. In the absence of a defined crust layer, the difference in pre- and post-event snow depth to ground was interpreted as event throughfall.

### UAV-Lidar Snow Depth

Two uncrewed aerial vehicle (UAV) lidar surveys were conducted before and after a 24-hour snowfall event that occurred between March 13^th^ and March 14^th^, 2023 to facilitate the measurement of snow accumulation and canopy structure within the FT and PWL forest plots. This period was selected based on two criteria: 1) it provided sufficient cumulative snowfall to result in a low relative error in UAV-LiDAR measured throughfall, and (2) minimal redistribution and ablation was observed, as confirmed by the SCLs, weighed tree, and time-lapse imagery. The change in elevation between the two UAV-lidar surveys was interpreted as the increase in snow accumulation, $\Delta HS$ over the snowfall event. 

## UAV-Lidar Canopy Metrics

To characterize the canopy structure, the voxel ray sampling (VoxRS) methodology for lidar data analysis was employed, as developed by @Staines2023, for the two UAV-lidar surveys. This method was chosen for its ability to provide canopy metrics that are less sensitive to the inherent non-uniform nature of lidar sampling data, which often results from beam occlusion in vegetation and leads to reduced points near the ground. Using this method radiation transmittance, $\tau$ (-), was measured across the hemisphere at a 1° step, i.e., azimuth angles (0°, 1°, ..., 359°) and zenith angles (0°, 1°, ..., 90°) for each 0.25 m grid cell within the FT and PWL forest plots. The fraction of snow-leaf contact area per unit area of ground proposed by @Hedstrom1998a, and hereafter called leaf contact area ($C_p$), was then calculated as:

$$
C_p(C_c, \theta_h, L) = 1-\tau
$${#eq-lca}

$$
C_p(C_c, \theta_h, L) = \begin{cases}
    1-\tau,& \text{if } \theta_h> 0°\\
    1-\tau \approx C_c ,              & \theta_h= 0°
\end{cases}
$${#eq-tf-ode}

where $C_p$ is a function of the canopy coverage $C_c$, $\theta_h$ and $L$. $C_p$ is approximately equal to canopy coverage ($C_c$) for vertical snowfall trajectories. However, for non-vertical snowfall $1 > C_p > C_c$.

## Statistics and Regression Models 

To determine how forest structure was associated with interception efficiency at different azimuth and zenith angles over the March 13—14 snowfall event, the entire hemisphere at each grid location was considered. The relationship between interception efficiency and canopy contact number was found to be linear and thus the Pearson Correlation Coefficient, $\rho_p$ was calculated using the 'stats' package in R [@R2024] to quantify the association between a single raster of interception efficiency and the 32,760 rasters containing the canopy contact number hemisphere for each portion of the hemisphere (azimuth [0°, 1°, ..., 359°], zenith angle [0°, 1°, ..., 90°]) for each of the 25 cm grid cells across the FT and PWL forest plots. 

Linear and non-linear regression models were developed to assess relationships in the observed data. Linear models were fitted using ordinary least squares regression via the 'lm' function from the R 'stats' package [@R2024] to analyze two relationships: (1) between interception efficiency and meteorological variables and (2) between interception efficiency and leaf contact area. The latter was forced through the origin based on the theoretical justification that the dependent variable should be zero when the independent variable is zero. @Kozak1995 noted, the default *R*^2^ value provided for least squares models forced through the origin by many statistical packages can be misleading. Therefore, these *R*^2^ values were adjusted using Equation 10 in @Kozak1995. Non-linear models were fitted using non-linear least squares regression via the 'nls' function in 'stats' package in R.

# Results

## The influence of meteorology on snow interception

Canopy snow load was estimated for 26 snowfall events and increased linearly with cumulative event snowfall without evidence of reaching a maximum (@fig-scl-w-sf). Over these events, air temperature ranged from `r sf_event_t_range[1]`°C to `r sf_event_t_range[2]`°C, wind speeds at 4.3 m height ranged from calm to `r sf_event_u_range[2]` m s^-1^ (@tbl-sf-event-met), and wind direction was predominately from the southwest during snowfall (@fig-wind-rose). Missing canopy snow load measurements in @fig-scl-w-sf for certain troughs during specific events was caused by damage to the subcanopy lysimeter wiring due to animals and heavy snow loads.

![Plot showing the cumulative event snowfall versus the corresponding state of canopy snow load calculated using the SCLs for each of the 26 snowfall events. The SCLs are denoted by a distinct colour (grey, yellow, and green), correspond to varying canopy coverage (0.73, 0.78, and 0.82, respectively).](figs/automated_snowfall_event_periods/cuml_event_snowfall_canopy_storage_sep_scl.png){#fig-scl-w-sf}

\pagebreak
\setstretch{1.0} 
```{r tbl-sf-event-met, echo=FALSE}
#| label: tbl-sf-event-met
#| tbl-cap: "Meteorology of the 26 snowfall events. Air temperature and wind speed were measured at FT station. Snowfall was measured at PWL station. Interception efficiency is estimated from snowfall and the average throughfall of all three SCLs located within the FT forest plot (all from 15-min. measurements)."

pretty_table <- readRDS('data/event_avgs_maxmin_pretty_gt_table.rds')
pretty_table
# gt::as_raw_html(pretty_table)

# knitr::include_graphics('figs/event_avgs_maxmin_pretty_gt_table_screenshot.png')
```
\setstretch{1.5}

![Wind rose showing the frequency of wind speed and direction over the 26 snowfall periods for the ultrasonic anemometer 4.3 m above ground at FT station.](figs/automated_snowfall_event_periods/ft_wind_rose_allevents_snowing_custom_dimensions.png){#fig-wind-rose width=60%}

Event average air temperature and interception efficiency were negatively associated for the mixed canopy (*R*^2^ = 0.1,  *p* < 0.05), but not associated at the closed and sparse canopies (@tbl-lysimeter-event-stats & @fig-scl-ip-avg-event). Cumulative event snowfall was not associated with event interception efficiency at any site (*p* > 0.05). Event wind speed was positively associated with interception efficiency for the sparse (*R*^2^ = 0.1, *p* > 0.05) and closed (*R*^2^ = 0.2, *p* < 0.05) canopies, both with limited canopy openings (Figure 2a,c) towards the prevailing wind direction (@fig-wind-rose). However, interception efficiency in the mixed canopy, which is open towards the prevailing wind direction, was not associated with wind speed (*p* > 0.05).

![Scatter plots showing the event mean air temperature, mean wind speed, and cumulative snowfall versus the event mean interception efficiency estimated using the SCLs for each of the 26 snowfall events. The colours (grey, yellow, and green), correspond to varying canopy coverage (0.73, 0.78, and 0.82, respectively). A linear regression line fit to the data for significant relationships (*p* < 0.05) is shown by the solid coloured lines. See @tbl-lysimeter-event-stats for linear regression statistics.](figs/automated_snowfall_event_periods/event_avg_temp_wind_cuml_snow_vs_IP_colour_troughs.png){#fig-scl-ip-avg-event}

```{r tbl-lysimeter-event-stats, echo=FALSE}
#| label: tbl-lysimeter-event-stats
#| tbl-cap: "Statistics corresponding to the ordinary least squares linear regression test between independent variables: mean event air temperature, cumulative event snowfall, and mean event wind speed, and the dependent variable mean event interception efficiency. The test was run separately for three levels of canopy coverage ($C_c$)."

lysimeter_event_mod_smry |> 
  mutate(across(where(is.numeric), round, 3)) |>
  select(-offset_y,
         -r.squared) |> 
  arrange(pretty_name, cc) |> 
  knitr::kable(
    col.names = c(
    "Dependent Variable",
    "SCL Name",
    "$C_c$",
    # "$R^2$",
    "Adjusted $R^2$",
    "$p$-value",
    "$n$"
  )
)
  # knitr::kable(booktabs = TRUE,
  #              format = 'latex') 

```

Fifteen-minute interval measurements of interception efficiency and air temperature were not associated, despite significant relationships for the sparse and mixed canopies (*R*^2^ < 0.03, *p* < 0.05), due to low predictive power (Figure 6a). The average interception efficiency across differing bins of air temperature also does not show any systematic trend (Figure 6a). However, a significantly greater median interception efficiency (*p* < 0.05) was found for binned measurements with air temperatures below -6 °C compared to those with warmer air temperatures using non-parametric Wilcoxon signed rank test. 

Mean wind speed was weakly associated with interception efficiency for the sparse (*R*^2^ = 0.1, *p* > 0.05) and closed (*R*^2^ = 0.2, p < 0.05), but not for the mixed canopy (*p* > 0.05) (@tbl-lysimeter-15min-stats). The binned data show an increasing trend in interception efficiency with increasing wind speed for the sparse and closed canopies (Figure 6b). A comparison of interception efficiencies binned for low (< 1 m s^-1^) and high (> 1 m s^-1^) wind speeds by the Wilcoxon signed rank test, showed that high wind speeds had significantly higher (*p* < 0.05) median interception efficiencies compared to the low wind speed bins for the closed and sparse canopy. Conversely, the Wilcoxon test showed the mixed canopy, which had an opening in the canopy towards the prevailing wind direction (Figure 2b), had significantly higher (*p* < 0.05) median interception efficiencies for the low wind speed bins. 

Interception efficiency showed no association (*R*^2^ < 0.05, *p* > 0.2) with the canopy load measured at the beginning of the 15-minute intervals (@tbl-lysimeter-15min-stats). The binned data show a small increase in interception efficiency for all three canopies when the snow load is less than 7 kg m^-2^ (Figure 6c). Interception efficiency later declined for snow loads greater than 7 kg m^-2^ for all canopies, though this was inconsistent for the mixed canopy. A significantly greater (*p* < 0.05) median interception efficiency was found for canopy snow loads less than 10 kg m^-2^ than those with high initial canopy snow loads (> 10 kg m^-2^) using the Wilcoxon rank-test. Additional statistics from ordinary least squares regression test on the 15-minute interval measurements are provided in @tbl-lysimeter-15min-stats.

![Scatter plots of 15-minute interval measurements (blue dots) and binned data (black open circles with error bars) of mean air temperature, mean wind speed, and initial canopy snow load versus mean snow interception efficiency. Panels show (a) air temperature, (b) wind speed, and (c) initial canopy snow load (the snow load observed at the beginning of the timestep). The black open circles show the mean of each bin and the error bars represent the standard deviations. See @tbl-lysimeter-15min-stats for linear regression statistics.](figs/automated_snowfall_event_periods/troughs_met_vs_IP_bin.png){#fig-scl-ip-avg-15min}

```{r tbl-lysimeter-15min-stats, echo=FALSE}
#| label: tbl-lysimeter-15min-stats
#| tbl-cap: "Statistics corresponding to the ordinary least squares linear regression test between 15-minute interval measurements of independent variables: mean air temperature, mean wind speed, and initial canopy snow load and the dependent variable mean interception efficiency. The test was run separately for three levels of canopy coverage ($C_c$)."

lysimeter_15min_mod_smry |> 
  select(-r.squared) |> 
  mutate(across(where(is.numeric), round, 3),
         cc = round(cc, 2)) |>
  knitr::kable(
    col.names = c(
    "Dependent Variable",
    "SCL Name",
    "$C_c$",
    # "$R^2$",
    "Adjusted $R^2$",
    "$p$-value",
    "$n$"
  )
)
  # knitr::kable(booktabs = TRUE,
  #              format = 'latex') 

```

## The influence of forest structure on snow interception

UAV-lidar measurements of throughfall and canopy structure provide insights on how the forest canopy influenced subcanopy snow accumulation during a wind-driven snowfall event between March 13^th^ and 14^th^ 2023. This event totaled `r event_sf` kg m^-2^ of snowfall at PWL station and was characterized by a transition from low rates of snowfall and air temperatures near 0°C to higher rates of snowfall by late afternoon on March 13^th^ coinciding with air temperatures around -2.5 °C. An average wind speed of 1.3 m s^-1^ and direction of 188° was observed 4.3 m above the ground at FT Station. @fig-wind-profiles shows Cionco’s (1965) exponential function was not appropriate for this sparse canopy. The predicted hydrometeor trajectory angles at varying heights, calculated using @eq-ta and the mean observed hydrometeor terminal velocity observed over the event of 0.9 m s^-1^ are also shown in @fig-wind-profiles. An average wind speed of `r ft_mean_wind_speed_prof_integral` m s^-1^ and direction of 188° was calculated by integrating the wind speed from the surface to the mean canopy height of FT plot. The corresponding trajectory angle calculated using @eq-ta from this integrated wind speed was `r ft_mean_wind_prof_integral$traj_angle |> round(1)`°.

![Wind speed profile using roughness length and displacement height parameters derived from anemometers at 2, 3, 4.3, and 13.5 m above ground at FT station over snow free periods and friction velocity estimated over the March 13–14^th^ snowfall event. The red triangle shows the mean observed wind speed at 4.3 m height (2.8 m above the snowpack) measured at the FT station over the event.](figs/lidar_periods/wind_profile_w_trajectories_20230313.png){#fig-wind-profiles}

Throughfall depth measured by UAV-lidar was close to the 28 in-situ manual measurements with a mean bias of -0.001 m and RMSE of 0.024 m. More details on the accuracy of UAV-lidar snowdepth measurements are provided in the supporting information section. @fig-lidar-tf-ip shows the spatial distribution of throughfall and interception efficiency at the PWL and FT forest plots. Reduced throughfall and greater interception efficiency was observed on the north (lee) side of individual trees, which may be due to non-vertical hydrometeor trajectories caused by the steady southerly winds observed over this event. Transparent areas within the forest plots in @fig-lidar-tf-ip represent grid cells that did not have any lidar ground returns (i.e., under dense canopy proximal to tree trunks) or were masked due to disturbance (i.e., walking paths in clearings). Visual observations on March 13^th^ and 14^th^ confirmed non-vertical hydrometeor trajectories and increased canopy snow loads were observed on the windward side of individual trees. This effect is shown in @fig-lidar-tf-ip to be more apparent in the PWL forest plot than the FT forest plot. This may be attributed to the taller trees and higher canopy coverage of the PWL forest plot compared to the FT forest plot, as for the same trajectory angle a taller tree will produce a larger downwind footprint.

![UAV-lidar measurements of the change in snow water equivalent, SWE (kg m^-2^) and interception efficiency, I/P (-), over the March 13, 2023 24-hour snowfall event for the FT and PWL forest plots at a 0.25 m resolution. See the location of the two forest plots in @fig-site-map.](figs/external_figures/facet_ft_pwl_23_072_23_073_v2.0.0_saswe_and_ip_normalised_resample_0.25.png){#fig-lidar-tf-ip}

@fig-hemi-ip-cc shows a strong linear correlation between $C_p$ and interception efficiency towards the southern portion of the hemisphere, aligning with the average event wind direction. For the PWL forest plot, the upper 97.5^th^ percentile of the $\rho_p$ values shown in @fig-hemi-ip-cc, were found between azimuth angles of `r pwl_theta_from`° – `r pwl_theta_to`°. Similarly, for the FT forest plot, the upper 97.5^th^ percentile of $\rho_p$ was found between azimuth angles of `r ft_theta_from`°–`r ft_theta_to`°. The zenith angle found to have the highest correlation over this azimuth range was `r pwl_best_phi`° ($\rho_p$ = `r pwl_best_phi_rho`) and `r ft_best_phi`° ($\rho_p$ = `r ft_best_phi_rho`) for PWL and FT respectively. The high correlation coefficients found for non-vertical zenith angles for both PWL and FT are hypothesized to result from non-vertical hydrometeor trajectories.

![The Pearson Correlation Coefficient between rasters (25 cm resolution) of interception efficiency and leaf contact area for each grid cell across the study site for each azimuth angles (0°, 1°, ..., 359°) and zenith angles (0°, 1°, ..., 90°) for the FT (left) and PWL (right) forest plots.](figs/external_figures/full_hemi_rho_p_cor_lca_ip_23_072_vox_len_0.25m_sa_gridgen_v2.0.0_sa_ft_pwl_.png){#fig-hemi-ip-cc}

The correlation between $C_p$ and interception efficiency, resampled to a 5 m grid resolution, was higher when $C_p$ was adjusted for the observed shift in hydrometeor trajectory (Vector Based), compared to the leaf contact angle measured at a zenith angle of 0° (nadir) (@fig-lca-vs-ip). The the zenith angle observed to have the highest $\rho_p$ in @fig-hemi-ip-cc were used to adjust the vector based, $C_p$ in @fig-lca-vs-ip. The stronger association for the vector-based calculation suggests that adjusted $C_p$ is a useful predictor of interception efficiency before ablation. An ordinary least squares linear regression forced through the origin was fit to the observed data points using the following equation:

$$
  \frac{I}{P} = C_p(C_c, \theta_h) \cdot \alpha
$${#eq-lca-ip}

where $\alpha$ is an efficiency constant which determines the fraction of snowflakes that contact the $C_p$ elements and are stored in the canopy (i.e., intercepted) before canopy snow unloading or ablation processes begin.

![Scatter plots showing the relationship between leaf contact area and interception efficiency rasters resampled to a 5 m grid cell resolution. The left plot (nadir) shows leaf contact area measured from a zenith angle of 0°. The right plot (Vector Based) shows the leaf contact area averaged over rasters with zenith angles (PWL = 22°, FT = 21°) and azimuth angles (PWL = 167°, 178°, ... 217°; FT = 171°, 172°, ... 223°). The solid lines (Model fit) show an ordinary least squares linear regression forced through the origin and fitted to the PWL (red) and FT (black) data and the light grey dotted line shows a 1:1 line. The *R*^2^ values for the four different models are shown in the upper right of each panel calculated following the methods outlined in @Kozak1995.](figs/external_figures/pwl_ft_lca_vs_ip_phi_nadir_adjusted_resample_w_mods_5m.png){#fig-lca-vs-ip}

For the vector-based model, the relationship between interception efficiency and $C_p$ results in *R*^2^ values of `r pwl_r2_val` and `r ft_r2_val` for PWL and FT respectively. The increase in interception efficiency with $C_p$ follows a reduced slope compared to the nadir models with $\alpha$ values of `r pwl_a_val` and `r ft_a_val` for the PWL and FT plots respectively. The reduced slope for the vector-based models may be due to snowflakes that weaved through and/or bounced off branch elements in addition to UAV-lidar measurement uncertainty which may have been slightly affected by unloading and redistribution. These processes would have reduced the fraction of snowfall that was stored in the canopy. Model error statistics are presented in @tbl-ip-mod-err for the nadir and vector-based models and show the vector-based model provided a better prediction of interception efficiency. Some of the scatter observed in the nadir model shown in @fig-lca-vs-ip may be explained by grid cells which observed a greater interception efficiency compared to the corresponding $C_c$ value and can be attributed to the inability of $C_c$ to represent the increase in interception observed within canopy gaps in @fig-lidar-tf-ip. Conversely, grid cells where interception efficiency is less than $C_c$, may be affected by non-vertical trajectory hydrometeors making their way underneath the canopy as observed by the reduced interception efficiency on the windward edges of individual trees in @fig-lidar-tf-ip. The latter explanation suggests the non-linear relationship observed for the PWL nadir calculation in @fig-lidar-tf-ip. The detailed point clouds required to derive the $C_p$ values used in this analysis are rarely available and thus more accessible methods to estimate $C_p$ must be obtained to use @eq-lca-ip which are described in the following section.

```{r tbl-ip-mod-err, echo=FALSE}
#| label: tbl-ip-mod-err
#| tbl-cap: "Model error statistics provided for predictions of interception efficiency using @eq-lca-ip and for different $a$ values, as shown in the Model Slope column. Statistics are provided for the PWL and FT forest plots, using leaf contact area canopy metrics adjusted to zenith angles of (0°, 1°, ... 30°) and azimuth angles (170°, 171°, ... 220°) and nadir zenith angle of 0°. The Mean bias is the difference in the model and observed values, MAE is the mean of the absolute error, RMS Error is the root mean squared error, *R*^2^ is the coefficient of determination adjusted using Equation 10 in @Kozak1995."

mod_error |> 
  rename(`R^2` = R2_adj,
         `Mean Bias (-)` = `Mean Bias`,
         `MAE (-)` = MAE,
         `RMS Error (-)` = `RMS Error`,
         `Canopy Calculation` = `Canopy Metrics`) |> 
  mutate(`R^2` = round(`R^2`, 2),
         `Model Slope` = round(`Model Slope`, 2)) |>
  select(-R2_base) |> 
  knitr::kable(
     col.names = c(
    "Plot Name",
    "Canopy Calculation",
    "Model Slope (-)",
    "Mean Bias (-)",
    "MAE (-)",
    "RMS Error (-)",
    "$R^2$"))
```

## The combined influence of trajectory angle and forest structure on interception

@fig-lca-ht-ws shows that $C_p$, measured from VoxRS prior to snowfall on March 13^th^, increases substantially with simulated hydrometeor trajectory angle and corresponding simulated wind speed. The standard deviation in VoxRS measured $C_p$, illustrated by the shaded area in @fig-lca-ht-ws, exhibits the broad range in values for individual grid cells across each forest plot. Despite this large scatter, a systematic increase in the mean $C_p$ across both forest plots results from a rise in the number of canopy elements for more horizontal angles, when averaged across each forest plot, over all azimuth angles (see top left panel @fig-lca-ht-ws). This results in a large rise in $C_p$ over relatively common estimated wind speeds. For example, with a wind speed of `r select_wind_speed` m s^-1^ and estimated trajectory angle of `r ta |> round(0)`°, $C_p$ would increase by `r pwl_inc |> round(2)` and `r ft_inc |> round(2)` for the PWL and FT forest plots respectively (@fig-lca-ht-ws). This is a fractional increase in the plot $C_p$ from nadir of `r round(pwl_frac_inc, 2)` and `r round(ft_frac_inc, 2)` for PWL and FT respectively. The increase in $C_p$ from $C_c$, with increasing trajectory angle is shown on the bottom row of @fig-lca-ht-ws and exhibits a similar relationship for both forest plots FT and PWL until trajectory angles reach approximately 60°. Beyond 60°, the PWL rate of increase slows as the $C_p$ approaches 1.0, while the FT plot, which has lower $C_c$, continues to rise until around 75° as a $C_p$ of 1.0 is approached. $C_p$ was also quantified across trajectory angles for both PWL and FT on March 14^th^, post snowfall, and showed a negligible increase in $C_p$ compared to $C_p$ measured on March 13^th^ without snow in the canopy. 

<!-- These figures are generated under the lidar-processing project using scripts 11-13. Recently sped up the processing for these and can now be run locally. -->

![Plots showing the relationship between hydrometeor trajectory angle (left) and wind speed (right) with mean plot-wide snow-leaf contact area, $C_p$ (top row) and the increase in mean plot-wide $C_p$, i.e., $C_p - C_c$ (bottom row). The hydrometeor trajectory angle is simulated through VoxRS and is measured as degrees from zenith. Simulated wind speed was calculated as a function of hydrometeor trajectory angle by rearranging @eq-ta and an observed event hydrometeor velocity of 0.9 m s^-1^. The solid lines (VoxRS) represent the mean $C_p$ (top row) or increase in mean $C_p$ (bottom row) for a single zenith angle observed from VoxRS across all grid cells for each forest plot and across all azimuth angles. The shaded area represents 1 standard deviation above and below the observed VoxRS mean. The dashed lines (Fitted) represent predictions from @eq-lca-ac (top) and @eq-lca-inc (bottom). The dotted lines (HP98) represent the predictions from Equation 10 in @Hedstrom1998a. A forested downwind distance of 100 m was assumed for the HP98 calculation.](figs/external_figures/WITH_TREEWELLS_traj_angle_and_wind_phiby_1_thetaby_2_traj_angle_wind_speed_vs_cowplot_lca_and_inc_w_mods_mean_sd_23_072.png){#fig-lca-ht-ws}

A function is proposed here to calculate plot scale leaf contact area, $C_p$ (-):

$$
C_p = C_c + C_{inc}(\theta_h)
$${#eq-lca-ac}

where, $C_{inc}$ is the increase in leaf contact area from $C_c$ which is a function of $\theta_h$. To estimate $C_{inc}$ a non-linear least squares regression using a logistic function forced through the origin was fit to the VoxRS measurements at FT and PWL for simulated hydrometeor trajectory angles (see dashed lines in bottom row of @fig-lca-ht-ws). A logistic function was selected to model this relationship, as its shape reflects the slow increase in observed $C_p$ at near vertical trajectory angles, followed by a rapid increase to represent increase canopy area in the middle and lower section of individual trees, and the gradual leveling off as $C_p$ approaches a value of 1.0. The logistic function used to predict $C_{inc}$ as a function of $\theta_h$ is:  

$$
C_{inc} = \left(
\frac{C^{max}_{inc}}{1 + e ^ {\left(\frac{\theta_0 - \theta_h}{\text{k}}\right)}} - \frac{C^{max}_{inc}}{1 + e ^ {\left(\frac{\theta_0}{\text{k}}\right)}}
\right)
$${#eq-lca-inc}

where $C^{max}_{inc}$ is the maximum value of $C_{inc}$, $\theta_0$ is the x-value of the sigmoid midpoint and $k$ is the logistic growth rate or steepness of the curve. The coefficients resulting from the non-linear least squares regression fit of @eq-lca-inc to the VoxRS dataset are presented in Table @tbl-lca-coefs. Simulated $C_p$ using @eq-lca-ac is shown in the dashed lines in the top row of @fig-lca-ht-ws and follows closely to the VoxRS-measured mean $C_p$. Model error statistics shown in @tbl-lca-mod-err demonstrate that @eq-lca-inc performed well, with a mean bias and RMSE of 0.001 (-) and 0.0054 (-) respectively for PWL, and -0.0004 (-) and 0.0079 (-) for FT. In contrast, @tbl-lca-mod-err reveals that the @Hedstrom1998a method produced significantly less accurate estimates of $C_p$, with a mean bias and RMSE of -0.201 (-) and 0.233 (-) respectively for PWL, and -0.260 (-) and 0.324 (-) for FT.

```{r tbl-lca-coefs, echo=FALSE}
#| label: tbl-lca-coefs
#| tbl-cap: "Coefficients derived from the non-linear least squares regression fit of @eq-lca-inc to the VoxRS dataset."

nls_coefs_error |> knitr::kable(
  col.names = c(
    "Plot Names",
    "$LCA_{max}$",
    "$\\theta_0$",
    "$k$"
  )
)
```

<!-- These figures are generated under the lidar-processing project using scripts 11-13. The original version generated 100 of GB of ram but now has been optimised and can run locally.  -->

```{r tbl-lca-mod-err, echo=FALSE}
#| label: tbl-lca-mod-err
#| tbl-cap: "Model error statistics calculated for the prediction of leaf contact area from trajectory angle using @eq-lca-inc (nls) and Equation 10 from @Hedstrom1998a for the PWL and FT forest plots. Mean bias is the difference in the model and observed values, MAE is the mean of the absolute error, RMS Error is the root mean squared error and *R*^2^ is the coefficient of determination. The units for all metrics are dimensionless. A forested downwind distance of 100 m was used for the HP98 calculation."

lca_mod_error |> 
  rename(`R^2` = `r^2`,
         `Mean Bias (-)` = `Mean Bias`,
         `MAE (-)` = MAE,
         `RMS Error (-)` = `RMS Error`) |> 
  knitr::kable(
    
  ) 
  # knitr::kable(booktabs = TRUE,
  #              format = 'latex')
```

## Throughfall Model Performance

The performance of Equations 9, 10, and 11 in estimating event throughfall was assessed against UAV-lidar measurements of throughfall for the March 13–14^th^ snowfall event at the plot scale for both FT and PWL. Required values for the model included the event mean hydrometeor terminal velocity and total event snowfall which were measured at PWL station, and wind speed was taken as one-third the mean canopy height using the wind speed profile in @fig-wind-profiles. Additional model inputs include the mean $C_c$ for each plot which was measured from the VoxRS dataset. An $\alpha$ value of `r alpha_plot_scale` (-) was found through calibration which provided the best fit between observed and simulated interception efficiency at the plot scale for both FT and PWL.

@fig-event-tf shows the vector-based model, computed using @eq-lca-ip with $C_p$ adjusted for estimated hydrometeor trajectory angle, closely matches UAV-lidar measurements of throughfall. Observed and modelled values of interception efficiency and $\Delta SWE_{tf}$ are presented in @tbl-vb-plot-err along with corresponding error statistics. Modelled throughfall from the vector-based model was `r pwl_vb_tf_mod` kg m^-2^ compared to the measured throughfall of `r pwl_vb_tf_obs` kg m^-2^ for PWL. For FT, the modelled throughfall was `r ft_vb_tf_mod` kg m^-2^, while the measured values where `r ft_vb_tf_obs` kg m^-2^. The vector-based model shows a lower mean bias of `r pwl_vb_bias` kg m^-2^ for PWL and a negative bias of `r ft_vb_bias` kg m^-2^ for FT, compared to the larger mean bias of `r pwl_nadir_bias` kg m^-2^ for PWL and `r ft_nadir_bias` kg m^-2^ for FT with the nadir-model (calculated using $C_c$ in place of $C_p$). This resulted in a large reduction in the percent error in predicted throughfall, from -9.4% with the nadir-model to -1.8% with the vector-based model for PWL. A smaller improvement was observed for FT, with the percent error in predicted throughfall declining from -3.6% with the nadir-model to -1.4% with the vector-based model.

![Bar chart comparing the observed and modelled mean change in throughfall (𝚫 SWE, kg m⁻²) over the March 13-14 snowfall event averaged over forest plots FT and PWL. The 'Nadir-model' used @eq-lca-ip not adjusted for trajectory angle (i.e., $C_c$) and the Vector-based 'VB-model' which uses @eq-lca-ip with $C_p$ adjusted for trajectory angle. 'UAV-lidar' corresponds to throughfall calculated using @eq-swe-tf incorporating UAV-lidar snow depth and snow density from in-situ snow pits. The black horizontal dashed line shows the accumulated SWE (kg m⁻²) over the snowfall event to the PWL station open clearing.](figs/lidar_periods/23_072_23_073_event_throughfall_totals_obs_vs_vb_vs_nadir.png){#fig-event-tf}

```{r tbl-vb-plot-err, echo=FALSE}
#| label: tbl-vb-plot-err
#| tbl-cap: "Model error statistics for model estimates of snow interception efficiency (I/P) and throughfall (TF) compared to measurements of I/P and TF using UAV-lidar averaged over the FT and PWL forest plots. Units for I/P are (-) and TF are (kg m⁻²). The vector-based model utilized @eq-lca-ip with $C_p$ adjusted for trajectory angle. The nadir model also utilized @eq-lca-ip but was not adjusted for trajectory angle and thus $C_c$ was used instead of $C_p$. The 'Obs. Value' column contains measurements from UAV-lidar while the 'Mod. Value' column contains the modelled values. The mean bias was calculated as observed minus modelled and percent error is the percent error between predicted and observed values."

vb_plot_scale_err  |>
  mutate(Units = ifelse(val_name == 'ip', '-', 'kg m⁻²'),
         val_name = ifelse(val_name == 'ip', 'I/P', 'TF')) |> 
  select(Plot = plot,
         `Model Type` = mod_type, 
         `Value Name` = val_name,
         Units,
         `Obs. Value` = obs_val,
         `Mod. Value` = mod_val, 
         `Mean Bias`,
         `Perc. Error`
         ) |> 
  knitr::kable(digits = 2)
```

# Discussion

The point scale observations presented in @fig-scl-ip-avg-15min show air temperature had little influence on interception efficiency. This differs from existing studies which suggested either a positive [@Storck2002] or negative [@Hedstrom1998a] relationship. A weak relationship, that leaves 80—90% of variance unexplained, was observed between initial interception efficiency (before unloading) with increasing wind speed at two locations which were sheltered from the predominant wind direction (Figure 6b). This is attributed to an associated increase in $C_p$ due to non-vertical hydrometeor trajectories. These results are consistent with observations by @Schmidt1989 who observed a slight increase in snowfall interception with increasing wind speeds up to 6 m s^-1^ and studies of rainfall interception by @Herwitz1995 and @VanStan2011. 

Compared to the influence of wind speed, interception efficiency showed a smaller sensitivity to canopy snow load at the point scale (@fig-scl-ip-avg-event). The slight increase in interception efficiency for smaller canopy snow loads and decline for larger canopy snow loads is attributed to the influence of canopy snow load on $C_p$ (Figure 6c). While small, this effect is consistent with the theory proposed by @Satterlund1967 that interception efficiency increases as the canopy fills with snow bridging gaps in the canopy increasing, while later declining due to branch bending and decreased canopy coverage. However, the observations shown in @fig-scl-ip-avg-15min and @fig-scl-w-sf, which minimized ablation processes, differ from those reported by @Satterlund1967, @Schmidt1990, and @Moeser2015, as canopy snow load increased linearly with snowfalls up to 45 kg m^-2^ without approaching a maximum canopy snow load. The strong exponential decline in interception efficiency with increasing event snowfall in these studies [@Satterlund1967: @Schmidt1990; @Moeser2015] may have resulted from higher unloading rates as branches bent under heavy snow loads, hence mixing ablation and interception processes to varying degrees. In contrast, other studies [@Watanabe1964; @Calder1990] align with the observations in @fig-scl-ip-avg-15min and @fig-scl-w-sf, showing little evidence of a reduced interception efficiency with increasing snowfall. The low sensitivity of interception efficiency with canopy snow load found in this study and others may be attributed to several factors: a reduced inclusion of ablation processes in the interception efficiency measurements, limited influence of canopy snow load on $C_p$ at this study site, and/or the compensatory effects outlined by @Satterlund1967.

@Staines2023 showed a slight increase in VoxRS $C_p$ between snow-off and snow-on conditions. However, the increase in $C_p$ resulting from snow load in @Staines2023 was small compared to the substantial rise in $C_p$ due to trajectory angle presented in their study and as shown in @fig-lca-ht-ws. Both findings from @Staines2023 corroborate the results reported in this study. Further evidence in support of the relatively small influence of canopy snow load on $C_p$, is provided by @Lundquist2021 who reported improved simulation of subcanopy snow accumulation without the use of a maximum canopy snow load, when linked with a comprehensive canopy snow ablation routine. @Lehtonen2016 also note that in northern Finland heavy canopy snow loads have been observed to continue increasing until stem breakage, under conditions favourable for the formation of significant rime-ice accretion and limited ablation, thus reducing $C_p$. Models are available to predict the accretion of ice on tree canopies [e.g., @Nock2016] however, further research is required to understand the canopy snow load required to cause stem breakage across different tree species and canopy loads. 

These findings on the limited influence of air temperature and canopy snow load on initial interception challenge the theoretical basis of many existing snow interception parameterizations [@Hedstrom1998a; @Storck2002; @Satterlund1967; @Moeser2015]. To address this a new snow interception parameterization, @eq-lca-ip, is presented which calculates interception efficiency as a function of $C_p$ and $\alpha$. This new parameterization allows for canopy snow loading processes to be isolated from canopy snow ablation processes and is consistent with current rainfall interception theory [@Valante1997]. @eq-lca-ip differs only slightly from the original @Hedstrom1998a parameterization (see Equation 6 in @Hedstrom1998a), in that it does not calculate interception efficiency as a function of canopy snow load and from the @Storck2002 parameterization who proposed interception efficiency to be constant over time and space. The theoretical basis of the $\alpha$ parameter in @eq-lca-ip is that the association between $C_p$ and interception efficiency, as shown in @fig-lca-vs-ip, unlike existing rainfall parameterizations [@Valante1997] does not follow a 1:1 line, as falling snow hydrometeors may bounce off the canopy elements. Further research is needed to explore how processes such as the increased cohesion and adhesion of snowfall to the canopy at warm temperatures, as observed by @Kobayashi1987, @Pfister1999, @Storck2002, as well as hydrometeor velocity, particle size, and shape suggested by [@Katsushima2023], may influence the $\alpha$ parameter, although these effects were not observed in this study. 

Measurements of interception efficiency and canopy structure, as shown in @fig-lidar-tf-ip, align with the theory proposed by @Hedstrom1998a which suggests reduced throughfall on the lee side of individual trees. However, an existing method proposed in @Hedstrom1998a to scale canopy coverage with wind speed failed to reproduce the observations presented in @fig-lca-ht-ws. A new method is proposed which uses a logistic function to calculate plot-wide $C_{inc}$ as a function of $\theta_h$ and $C_c$. Significant scatter in VoxRS measured $C_p$ across the two forest plots, illustrated by the high standard deviation in @fig-lca-ht-ws, resulted from directional (azimuth) and spatial differences in canopy structure. This large scatter suggests the observed relationships in @fig-lca-ht-ws are only applicable at the forest stand scale where the sub-metre variability in $C_p$ averages out. At the point scale, the mixed canopy SCL which is open to the prevailing wind direction (@fig-scl-imgs), and did not follow this relationship and led to an increase in throughfall with increasing wind speed (@fig-scl-ip-avg-event & @fig-scl-ip-avg-15min). However, @fig-lca-ht-ws shows that at the plot scale, $C_p$ rises with increasing $\theta_h$, as there is a greater number of grid cells which have more closed canopy at more horizontal angles. Thus at the plot scale, @eq-lca-inc, which uses trajectory angle alone, was shown to successfully determine $C_{inc}$ and thus $C_p$ for the discontinuous canopies of both the FT and PWL forest plots. However, @eq-lca-inc would not be applicable to areas that have large continuous gap fractions (e.g., large forested clear cuts) that are many times wider than the mean canopy height. Further work is required to refine the relationship proposed in @eq-lca-inc across a range of tree species and densities. Backflows and large eddies that occur within the canopy may also contribute to very mixed responses [@Staines2023].

It was found that the mean hydrometeor trajectory angle over a snowfall event, required for @eq-lca-inc, could be predicted by using the observed hydrometeor fall velocity and a mean horizontal wind speed selected at one-third of the canopy height above the ground. A wind speed at one-third the mean canopy height is hypothesized to be important for canopy snow accumulation as a large fraction of the horizontal cross-sectional area is at this height for most needleleaf canopies. @Katsushima2023, also proposed the wind speed at one-third the canopy height for modelling unloading of canopy snow as it corresponds to the centre of gravity when the horizontal projection of the canopy is assumed to be a triangle. However, there is uncertainty in the transferability of the canopy height observed here to other environments due to differing tree structures and tree species. This may include forests with a larger trunk space or have more of their canopy contact area at higher heights above the ground (i.e., some deciduous canopies). Moreover, @eq-ta assumes a linear hydrometeor trajectory, and does not consider non-linear patterns such as wind flow directions around tree elements, turbulent flow, or differences in wind speed with height. 

Although the improvement in performance of the vector-based model over the nadir model was relatively small, the vector-based model is preferred due to its overall lower error compared to the UAV-lidar measurements and better representation of physical processes. While the vector-based model acts to increase interception efficiency with wind speed, several studies have shown that canopy snow ablation increases as a result of wind induced unloading [@Wheeler1987; @Roesch2001; @Betts1997; @Bartlett2015; @Lumbrazo2022]. Thus, representing both the increase in initial interception due to inclined hydrometeor trajectory angles and the subsequent increase in canopy snow unloading will be important in subcanopy snow accumulation models.

# Conclusions

New observations of initial snow interception, collected over a wide range of meteorological conditions and canopy structures suggest forest structure is the primary factor governing subcanopy snow accumulation. At the point scale, high-temporal resolution measurements revealed no evidence of a maximum canopy snow load, even for event snowfalls up to 45 kg m^-2^, nor was there any indication of air temperature influencing the cohesion and adhesion of snowfall to the canopy or branch bending reducing canopy coverage. Instead, wind speed was found to influence interception efficiency by changing the hydrometeor trajectory angle, which can lead to a substantial increase in snow-leaf contact area. 

At the forest plot scale, UAV-lidar measurements of throughfall collected over a wind-driven snowfall event confirmed the results observed at the point-scale and showed leaf contact area was the main factor governing the interception efficiency at a particular site. The leaf contact area, which accounts for the change in canopy structure with trajectory angle, proved to be a better predictor of interception efficiency compared to nadir-calculated canopy coverage. When averaged across each forest plot, leaf contact area was shown to be highly sensitive to hydrometeor trajectory angle, increasing by `r round(pwl_frac_inc * 100, 0)`–`r round(ft_frac_inc * 100, 0)`% for trajectory angles associated with a 1 m s^-1^ wind speed. An existing theoretical relationship failed to adequately represent the VoxRS-measured increase in leaf contact area with simulated trajectory angles. As a result, a new relationship is proposed, which demonstrated good performance at this study site. 

The weak association between air temperature and canopy snow load with interception efficiency, as presented here and in other recent studies, coupled with the considerable influence of wind speed on leaf contact area, highlights the need for a new snow interception parameterization. A new parameterization is proposed that calculates initial interception as a function of snowfall and leaf contact area. This parameterization is consistent with many rainfall interception studies, which also separate canopy loading and ablation processes, and calculate interception as a function of canopy coverage. Additionally, a second equation is proposed to estimate leaf contact area as a function of hydrometeor trajectory angle and nadir canopy coverage. This updated snow interception parameterization showed good performance in the subalpine forest in this study, but further validation should be conducted in a range of climates, forest species, and canopy structures.

# Acknowledgments

We wish to acknowledge financial support from the University of Saskatchewan Dean’s Scholarship, Natural Sciences and Engineering Research Council of Canada, Global Water Futures Programme, Environment and Climate Change Canada, Alberta Innovates, Canada Foundation for Innovation, and the Canada Research Chairs Programme. We thank Madison Harasyn, Hannah Koslowsky, Kieran Lehan, Lindsey Langs and Fortress Mountain Resort for their help in the field. Madison Harasyn, Alistair Wallace, and Rob White contributed to developing the UAV-lidar processing workflow.

# Data Availability

The data that support the findings in this study are available at https://github.com/acebulsk/snow-int-paper.

\pagebreak

# References

::: {#refs}
:::

# Supporting Information

## Detailed Description of UAV-Lidar Methodology

The REIGL miniVUX-2 laser operates at a near infrared wavelength with a laser beam footprint of 0.160 m x 0.05 mm (at 100 m above ground). The accuracy and precision of the miniVUX-2 is described by REIGL for a lab environment of 0.015 m and 0.01 m respectively (at 50 m above ground). The miniVUX-2 was configured with a laser pulse repetition rate of 200 kHz, field of view of 360°, scan speed of 31.09 revolutions s^-1^ and an angular step width of 0.0558°, resulting in an expected an average point cloud density of 107 returns m^-2^ for each flight path.

Georeferenced point clouds with x, y, and z coordinates for each laser return were generated following methods outlined by @Harder2020 and @Staines2023 to reconcile survey lidar, IMU and GNSS data. A ground-based GNSS system was positioned on a permanent monument during each survey and underwent precise point positioning (PPP) correction by @ppp2024. Differential GNSS correction of the UAV trajectory was conducted using the ground-based PPP GNSS observations and the POSPac UAV software. The UAV-lidar point clouds were then transformed from a sensor referenced coordinate system to a georeferenced coordinate system (EPSG:32611 - WGS 84 / UTM zone 11N) using the RIEGL Riprocess Software. A vertical offset of up to 6 cm between UAV-lidar flight lines was observed in the resulting point clouds on March 13^th^ and 14^th^, 2024 and was attributed to IMU position drift. This offset between flight lines was corrected using the BayesStripAlign software v2.24 [@BayesMap2024], which reduces relative and absolute uncertainties in the vertical elevation of the point cloud using the ground control points (GCP) collected across the study site using a differential GNSS rover. 

Quality control, ground classification and calculation of the change in between two UAV-lidar point clouds was conducted using the LAStools software package [@LAStools2024]. The ground classification was conducted using the "lasground_new" function [@LAStools2024] for both the pre and post snowfall event point clouds, with a step size set to 2 m and 8 substeps (ultra_fine setting). The offset and spike options were set to remove points that are more than 0.1 m above or below the initial ground surface estimate surface which "lasground_new" fits to the last returns. This function is based on an algorithm outlined by @Axelsson2000, describing the process of making the initial ground surface element.

The change in elevation between the two UAV-lidar surveys was interpreted as the increase in snow accumulation, $\Delta HS$ over the snowfall event. This change was calculated using a point-to-grid subtraction method, using the "lasheight" function from the @LAStools2024 software, as in @Deems2013 and @Staines2023. The pre snowfall event point cloud from "lasground_new" by "lasheight" to construct a "ground" TIN. Subsequently, the height of each post snowfall event point above the ground TIN, resulting in a point cloud representing $\Delta HS$. This point cloud was then converted into a raster of $\Delta HS$ with a grid cell resolution of 5 x 5 cm using the "las2dem" function. Further quality control and resampling of the 5 cm raster of $\Delta HS$ was conducted using the 'Terra' R package [@Hijmans2024]. Areas that were disturbed over the snowfall event during the in-situ snow survey and values that exceeded the .999th quantile were removed. To help remove any remaining noise a 25 cm $\Delta HS$ raster was generated by computing the median of the 5 cm $\Delta HS$ values within each 25 cm grid cell.

A comparison of UAV-liar and in-situ snow survey measurements over the March 13–14th snowfall event and associated error metrics are shown in @fig-lidar-vs-fsd-sd.

![UAV-liar and in-situ snow survey measurements over the March 13–14th snowfall event and associated error metrics.](figs/external_figures/23_073_v2.0.0_sa_snow_depth_Hs_insitu_vs_Hs_lidar_resamp_bias_corrected.png){#fig-lidar-vs-fsd-sd}

## Linear Regression Models Through the Origin

@Kozak1995 noted, the default *R*^2^ value provided for least squares models forced through the origin by many statistical packages can be misleading. Therefore, these *R*^2^ values were adjusted using Equation 10 in @Kozak1995 and two statistical tests as described by @Kozak1995 were used to verify whether a no-intercept model (forced through the origin) was appropriate for this data compared to a with-intercept model. The first test evaluated if the intercept of the with-intercept was significantly different from zero using p-value provided by the 'summary' function from the 'stats' package in R [@R2024]. The second test examined if there was a significant difference between the no-intercept and with-intercept models by testing if the residual sum of squares was different between the no-intercept and full model, assessed via Equation 15 in @Kozak1995. If the first test indicated a significant difference, and the second did not, the no-intercept model could be deemed statistically justified [@Kozak1995]. 
