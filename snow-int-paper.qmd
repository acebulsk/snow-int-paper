---
title: "Decoupling Snow Interception and Ablation Parameterizations: Insights from High-Frequency and Fine-Scale Observations from a Subalpine Forest"
format: 
  docx:
    reference-doc: ../config/word_template_hp.docx
    number-sections: true
    toc: false
  # pdf
  html:
    toc: false
    self-contained: true
editor: source
bibliography: ../../papers/bibtex/library.bib
csl: '../../papers/bibtex/csl-styles/apa-disable-disambiguate-add-names.csl'
---

<!-- From https://onlinelibrary.wiley.com/page/journal/10991085/homepage/forauthors.html - Papers submitted for publication should be concise and not exceed the 7500 word limit. The following sections are included as part of the word count: abstract; main text; and the acknowledgements. The following sections are excluded: title page, including author list and affiliations; bibliography; figure legends and supporting information. Figures and supporting information should be supplied as separate files. -->

```{r, include=FALSE}
library(tidyverse)
library(ggpubr)

knitr::opts_chunk$set(echo = FALSE, message=FALSE, warning=FALSE, fig.align='center')

# source('scripts/00_define_global_attributes.R')
# source('scripts/01_plot_theory_examples.R')
# source('scripts/01_plot_binned_met_trough_IP.R')
# source('scripts/01_plot_forest_snow_survey_IP.R')
# source('scripts/01_plot_snowfall_interception_w_tree.R')
```

**Authors:**

A. Cebulski^1^ (ORCID ID - 0000-0001-7910-5056)

J.W. Pomeroy^1^ (ORCID ID - 0000-0002-4782-7457)

^1^Coldwater Laboratory, University of Saskatchewan, Canmore, Canada

**Corresponding Author:** A. Cebulski, alexcebulski@gmail.com

@TODO add discussion on linking snow interception process to general hydrological modelling 

@TODO Add ref to @Niu2004a who considered the influence of solar zenith angle on light transmittance through the canopy. Also ref @Dai2019 who propose a way to represent subgrid variability and gap distribution in the canopy, important for them for subcanopy turbulence.

**Abstract:** Existing subcanopy snow accumulation models differ in their representation of snow interception and ablation processes, with uncertain applicability across diverse climates and forest types. Moreover, some snow interception parameterizations are coupled with ablative processes, leading to poor performance when used in models that are not calibrated to account for this. This study evaluates the theory underpinning these parameterizations and proposes a new snow interception routine using data from two subalpine forest plots in the transitional climate of the Canadian Rockies. In-situ meteorological data, high-frequency point-scale throughfall measurements, and fine-scale aerial lidar measurements of throughfall and canopy metrics were collected. Contrary to existing theories, no association of canopy snow load or air temperature on interception was observed. Instead, forest structure emerged as the primary factor governing snow accumulation at the forest plot scale. A wind-driven snowfall event demonstrated that interception efficiency prediction improved drastically when adjusted for hydrometeor trajectory angle. Leaf contact area showed high sensitivity to wind speed, increasing by up to 95% with a 1 m s^-1^ wind speed, which significantly reduced throughfall depths across both forest plots. The study proposes two new equations which model snow interception efficiency as a function of leaf contact area adjusted for hydrometeor trajectory angle. This new parameterization successfully estimated interception efficiency for a snowfall event with R^2^ values of 0.69 and 0.47 for the two forest plots in this study. By minimizing the inclusion of ablative processes, this new model should offer improved uncalibrated performance with existing ablative parameterizations in the literature.

**Keywords:** snow interception, throughfall, ablation, forest, snowpack, lidar, process-based modelling

# Introduction

Over half of North America's snow covered zone is covered by forests [@Kim2017], significantly impacting the accumulation and redistribution of subcanopy snowpacks and subsequent snowmelt runoff. Researchers have estimated that across the globe, 25–45% of annual snowfall may be lost to the atmosphere due to sublimation of snow intercepted in the canopy [@Essery2003]. Snow intercepted in the canopy can sublimate and melt at much higher rates compared to the subcanopy snowpack [@Lundberg1994; @Pomeroy1998b; @Floyd2012b], reducing the amount of snow available for runoff. Forest thinning efforts aimed at limiting sublimation losses and increasing snow accumulation sometimes have expected consequences for snowmelt runoff [@Golding1978; @Harpold2020; @Troendle1983]. This may be due to increased ablation rates when forest cover is reduced and a limited process understanding [@Ellis2013; @Musselman2015a; @Pomeroy1997; @Varhola2010; @Safa2021]. Vegetation structure controls the partitioning of snowfall into throughfall and interception, and thus governs the quantity of snow subject to sublimation [@Hedstrom1998a; @Storck2002]. The time that snow resides in the canopy, and is available for high rates of sublimation depends on unloading rates [@Hedstrom1998a; @Roesch2001], canopy snowmelt [@Mahat2014], and wind redistribution [@Wheeler1987]. Due to the significant impact of forest cover on snow accumulation and ablation, and the absence of a regional scale monitoring network of forest snow accumulation [@Vionnet2021; @Rittger2020], land management, ecological conservation and water resource decisions rely on robust models of snow redistribution to estimate past, current and future subcanopy snowpacks.

Numerous field-based studies have developed methodologies to improve snow interception process understanding to better predict snow accumulation in forests. These methods, discussed in detail in @Cebulski2024b, include snow surveys mass balance [@Hedstrom1998a], tree weighing [@Satterlund1967; @Schmidt1991; @Lundberg1993; @Hedstrom1998a; @Storck2002; @Katsushima2023], gamma ray attenuation [@Calder1990], subcanopy lysimeters [@Storck2002] and time-lapse imagery analysis [@Floyd2008; @Lumbrazo2022]. @Cebulski2024b noes the care needed in using these methods to isolate interception from ablative processes. As a result, existing parameterizations for snow interception are sometimes coupled to ablative processes [e.g., @Hedstrom1998a; @Katsushima2023] and may not be compatible when combined with additional ablative process representations in uncalibrated models [@Clark2020; @Wheater2022; @Verseghy2017]. Previous studies have collected measurements of interception efficiency over timesteps ranging from hourly [@Storck2002] to weekly [@Hedstrom1998a]. The varying measurement time intervals affect the duration during which ablative processes may have influenced these measurements and resulting models, leading to potential underestimations of the fraction of snow intercepted in the canopy.

The coupling of ablative processes within existing snow interception models may explain the over estimation of subcanopy snow accumulation reported by @Lundquist2021 and @Lumbrazo2022 when combining the @Hedstrom1998a routine with ablation parameterizations from different studies [e.g., @Roesch2001]. However, @Gelfan2004 demonstrated accurate subcanopy snowpack simulations at study sites across the globe by treating the @Hedstrom1998a and @Storck2002 parameterizations separately while using a step-based function to choose either parameterization based on temperature. Additional observations of snow interception that minimize the inclusion of ablative processes could help determine if the theories in @Hedstrom1998a and @Storck2002 are valid for these measurements.

Previous studies have found differing relationships of the canopy snow storage capacity with air temperature [see Figure 6 in @Cebulski2024b]. However, @Lundquist2021 found improved subcanopy snowpack simulations when they omitted the canopy snow storage capacity from @Hedstrom1998a, while utilizing a complete representation of ablation processes. This, combined with studies which have not observed a canopy snow storage capacity [@Storck2002; @Calder1990; @Katsushima2023], and the potential explanation of decreased interception at higher canopy snow loads in [@Hedstrom1998a; @Satterlund1967; @Moeser2015] attributed to ablative processes, suggests the canopy snow storage capacity may be much higher than existing models predict. While the storage capacity may not have significant implications for snow loading, it may be beneficial to reformulate ablative parameterizations as a function of canopy snow load for consistency with the rainfall interception literature [e.g., @Valante1997]. This could also help process representation particularly in regions that are prone to rime-ice formation, which can limit canopy snow ablation [@Lumbrazo2022] and can lead to heavy snow loads causing stem breakage [@Lehtonen2014; @Lehtonen2016].

The extent that processes observed at the point scale, such as bridging of gaps in canopy elements [@Satterlund1967], or branch bending [@Schmidt1991; @Pomeroy1995; @Hedstrom1998a], influence snow accumulation at the forest plot scale remain uncertain. Fine-scale observations of throughfall have only recently become feasible at the plot scale [@Harder2020; @Staines2023], presenting an opportunity to provide more definitive answers to how interception processes vary across differing spatial scales. Existing theory proposed by @Hedstrom1998a suggests that moderate wind speeds, which result in horizontal hydrometeor trajectories, can increase leaf contact area and thus increase interception efficiency at the plot scale. This association has also been shown in rainfall interception studies [i.e., @Herwitz1995; @VanStan2011] to have a significant influence on observed throughfall of rain. Despite this importance for rainfall, this relationship proposed by @Hedstrom1998a, is typically not included in models [e.g., @Mahat2014; @Clark2020], as empirical support for this relationship is lacking and it also exhibits a relatively low sensitivity [see Figure 8 in @Cebulski2024b]. New methods developed by @Staines2023 to characterize the canopy at a high angular and spatial resolution have shown the potential to improve understanding of the relationship between snow interception and forest structure spatially and also across differing trajectory angles. However, these insights have yet to be confirmed for additional study sites with more diverse forest structure and need to be incorporated into a theoretical framework appropriate for modelling snow accumulation in forests.

The objective of this paper is to evaluate the theory underlying existing snow interception models using high-frequency point scale and high spatial resolution measurements of subcanopy snow accumulation that attempt to minimize inclusion of ablative processes. These new observations are investigated to address the following research questions: 

  1. Are the existing theories regarding the relationship between meteorology and forest structure on snow interception supported by in-situ observations? 

  2. How is snow interception influenced by non-vertical hydrometeor trajectory angles over a wind-driven snowfall event? 

  3. To what extent can these findings inform the development of a new parameterization for snow interception?

# Theory

## Snow Interception

During calm snowfall periods, where ablative processes could be assumed negligible, the amount of snow intercepted in the canopy was estimated as:

$$
\frac{dL}{dt} = q_{sf}-q_{tf}
$$ {#eq-dwdt-ode}

where $q_{sf}$ is the snowfall rate (kg m^-2^ s^-1^) and $q_{tf}$ is the throughfall rate (kg m^-2^ s^-1^). This method was preferred, compared to direct measurements from the weighed tree lysimeter, as the subcanopy lysimeters were not influenced by sublimation losses from snow intercepted in the canopy. For a complete description of the canopy snow mass and energy balance see @Cebulski2024b.

Over a discrete time interval, $\Delta t$, the change in canopy snow load, $\Delta L$ (kg m^-2^) was calculated as:

$$
\frac{\Delta L}{\Delta t} = \overline{q_{sf}}-\overline{q_{tf}} = \frac{\Delta SWE_o}{\Delta t} - \frac{\Delta SWE_{tf}}{\Delta t}
$${#eq-dwdt-discrete}

where $\overline{q_{sf}}$ and $\overline{q_{tf}}$ are the average snowfall and throughfall rate over $\Delta t$ (proved by automated instrumentation). $\Delta SWE_o$ is the change in SWE to the open (kg m^-2^) and $\Delta SWE_{tf}$ (kg m^-2^) is the change in SWE below the canopy (provided by snow surveys over longer time intervals).

Interception efficiency, $\frac{I}{P}$ (-), which is the fraction of snow intercepted over $\Delta t$ was calculated as:

$$
\frac{I}{P} = \frac{\frac{\Delta L}{\Delta t}}{\overline{q_{sf}} \Delta t}
$$ {#eq-ip}

## Hydrometeor Trajectory Angle

The trajectory angle, $\theta_h$ of a hydrometeor as the departure in degrees (°) from a vertical plane (i.e., 0° for vertical snowfall), is shown in @Herwitz1995 to be calculated as:

$$
\theta_h = \arctan \left(\frac{x_h(u_z)}{v_h(D_h)}\right)*\frac{180}{\pi}
$${#eq-ta}

where $v_h(D_h)$ is the terminal fall velocity of the hydrometeor (m s^-1^), which is a function of the hydrometeor diameter, $D_h$ and $x_h(u_z)$ is the horizontal change in the hydrometeor (m s^-1^) which is a function within canopy wind speed, $u_z$ at height above ground, $z$. 

Above the top of the canopy, wind flow is approximately logarithmic with height. @Cionco1965 show that, $u_z$ may be approximated using the exponential formula:

<!-- See Stull et al., pg 677 for good fig of this relationship. They show the logarithmic starts within the canopy. -->
$$
u_z = u(u^*,z,z_o,d)\cdot exp\left[a\cdot\left(\frac{z_c}{\overline{h_c}}-1\right)\right]
$${#eq-uz}

where $u$ is the horizontal wind speed at the top of the canopy which is a function of the friction velocity $u^*$, height above ground, $z$, roughness length, $z_o$, and the displacement height of the canopy, $d$. $a$ is an attenuation coefficient that increases with increasing leaf area and decreases as the mean distance between individual trees increases, $z_c$ is the height above ground of $u_z$, and $\overline{h_c}$ is the average height of the canopy elements. @Cionco1972 suggest values for $a$ of 1.01 for small needleleaf trees, @Zhu2001 provide methods to calculated $a$ based on canopy density and @Parviainen2000 provide a method to calculate $a$ using observations from two jack pine (*Pinus banksiana*) stands. @fig-ws-vs-ta shows the increase in trajectory angle calculated using @eq-ta with a constant hydrometeor velocity of 1 m s^-1^ and a horizontal velocity equal to mid-canopy wind speeds ranging from 0-20 m s^-1^. 

The logarithmic wind speed profile is:

$$
\overline{u} = \frac{u_*}{K} ln(\frac{z - d_0}{z_0})
$${eq-log-wind-profile}

where $\overline{u}$ is average wind speed, $u_*$ is the friction velocity, $z$ is the instrument height, $d_0$ is the displacement height, $z_0$ is the roughness length of momentum for an average canopy-top height, and $k$ is the von Karmen Constant. See @Stull2017 page  677 or @Shuttleworth2012 page 286. 

![Plot showing the relationship of hydrometeor trajectory angle (departure from zenith) with increasing horizontal velocity from @eq-ta. The three different lines represent fall velocities of 0.5 m s^-1^ (purple), 1 m s^-1^ (green), 1.5 m s^-1^ (yellow).](figs/examples/wind_speed_vs_traj_angle.png){#fig-ws-vs-ta width="400"}

# Data and Methods

## Study Site

```{r, include=FALSE}
# CANOPY 
ft_mean_ht <- readRDS('../../analysis/lidar-processing/data/lidR_canopy_metrics/frs_s_mean_tree_height.rds') |> 
  round(2)
pwl_mean_ht <- readRDS('../../analysis/lidar-processing/data/lidR_canopy_metrics/pwl_e_mean_tree_height.rds') |> 
  round(2)

# these data have canopy metrics even where we do not have snow depths...
nadir_cc <-
  readRDS('../../analysis/lidar-processing/data/hemi_stats/full_voxrs_not_filtered_to_swe_traj_angle_w_lca_23_072.rds')

ft_cc_nadir <- nadir_cc |>
  filter(plot_name == 'FT') |>
  pull(lca_nadir) |>
  unique() |> 
  round(2)
pwl_cc_nadir <- nadir_cc |>
  filter(plot_name == 'PWL') |>
  pull(lca_nadir) |>
  unique() |> 
  round(2)

# determine the fraction of canopy height the select wind speed height is

ws_pars <- readRDS('data/model_results/wind_speed_height_match_hemi_traj.rds')
ws_pars$mean_cpy_height <- c(pwl_mean_ht, ft_mean_ht)
ws_pars$frac_cpy_height_off_snow <- ws_pars$wind_height_of_event/ws_pars$mean_cpy_height
ws_pars$ht_above_ground <- ws_pars$event_mean_snow_depth+ws_pars$wind_height_of_event
ws_pars$frac_cpy_height_off_ground <- ws_pars$ht_above_ground/ws_pars$mean_cpy_height

pwl_best_wind <- ws_pars$best_wind[ws_pars$plot == 'PWL'] |> round(2)
ft_best_wind <- ws_pars$best_wind[ws_pars$plot == 'FT'] |> round(2)
pwl_wind_height_off_snow <- ws_pars$wind_height_of_event[ws_pars$plot == 'PWL'] |> round(2)
ft_wind_height_off_snow <- ws_pars$wind_height_of_event[ws_pars$plot == 'FT'] |> round(2)
pwl_wind_height_off_ground <- ws_pars$ht_above_ground[ws_pars$plot == 'PWL'] |> round(2)
ft_wind_height_off_ground <- ws_pars$ht_above_ground[ws_pars$plot == 'FT'] |> round(2)
pwl_frac_cpy_height_off_ground <- ws_pars$frac_cpy_height_off_ground[ws_pars$plot == 'PWL'] |> round(2)
ft_frac_cpy_height_off_ground <- ws_pars$frac_cpy_height_off_ground[ws_pars$plot == 'FT'] |> round(2)
event_sd <- ws_pars$event_mean_snow_depth |> mean() |> round(2)
```

This study was conducted at Fortress Mountain Research Basin (FMRB), AB, -115° W, 51° N, a continental headwater basin situated within the Canadian Rocky Mountains (@fig-site-map). Data from this study was collected between October 2021 and July 2023 within and surrounding two forest plots adjacent to the FMRB Powerline Station (PWL) and Forest Tower Station (FT) at ~2100 m asl. (@fig-site-map). The average annual precipitation at PWL Station from 2013 to 2023 is 1045 kg m^-2^, with the peak annual snow water equivalent (SWE) reaching 465 kg m^-2^, typically occurring in late April. The PWL and FT forest plots include discontinuous stands of subalpine fir (Abies lasiocarpa) and Engelmann spruce (Picea engelmannii) trees, with a proportion of 70% and 30% respectively [@Langs2020]. In the early 1900s the majority of vegetation in the FMRB burned during a large forest fire that affected most of the Kananaskis Valley. Following the fire, the forest within the the PWL and FT forest plots has naturally regenerated with minimal disturbance. The average height of the canopy surrounding the plot to the east of the PWL station is `r pwl_mean_ht` m and surrounding the forest plot around the FT Station is `r ft_mean_ht` m. The canopy coverage of the PWL and FT forest plots is `r pwl_cc_nadir` and `r ft_cc_nadir` respectively.

## Meteorological Measurements

A flux tower at the FT Station provided measurements of air temperature (Campbell Scientific HMP155A), relative humidity (Campbell Scientific HMP155A), wind speed (Campbell Scientific Ultrasonic-86000 & Metone 014A) and wind direction (Campbell Scientific Ultrasonic-86000) at 15-min time intervals 4.3 m above the ground (@fig-site-map). The PWL station, located 120 m to the northwest of FT station in a forest clearing shown in @fig-site-map provided measurements of snowfall rate, additional wind speed measurements and hydrometeor size and velocity. The snowfall rate was measured using a weighing precipitation gauge 2.6 m above ground (OTT Pluvio) corrected for undercatch following phase correction by @Harder2013 and catch efficiency by @Macdonald2007a. A Metone 014A anemometer provided wind speed measurements at a height of 2.6 m, while the RM Young anemometer recorded wind speed and wind direction at a height of 5.2 m. A disdrometor (OTT Parsivel2) provided measurements of hydrometeor particle size and velocity. 

![Map showing the location of forest plots, flux towers, SCL instruments and survey transects. Inset map on the lower right shows the regional location of Fortress Mountain Research basin.](figs/maps/site_map_inset.png){#fig-site-map}

To determine the height or range in heights above the snowpack that wind speed is best suited for predicting $\theta_h$ a wind speed profile was fit using the logarithmic function @eq-log-wind-profile. The displacement height parameters and roughness length parameters used in @eq-log-wind-profile were found using wind speed measured from anemometers at 3, 4, and 15 m above ground at FT station over two years and using the least squares method parametrs for displacement height and roughness length were optimized to fit a wind speed profile that best represenet the wind speed observations. The parameters for the wind speed profile include a roughness length of 0.50 m, displacement height of 0.58m

The met conditions observed over the snowfall periods are illustrated in: (had a paragraph on this before look for old manuscript version)

![Histogram of meterological conditions for periods with snowfall and minimal unloading.](figs/automated_snowfall_event_periods/histogram_met_ip_snowfall_periods.png){#fig-hist-met}

Need to put interception measurements for automated analysis with meteorology into context of wind direction that is primarily from the southwest which the medium trough has a canopy opening in that direction. 

![Wind rose over all periods of snowfall with minimal unloading.](figs/automated_snowfall_event_periods/ft_wind_rose_allevents_snowing.png){#fig-wind-rose}

## Lysimeter Data

Three subcanopy lysimeters (SCLs) were installed surrounding the FT Station to provide fifteen minute interval measurements of throughfall and unloading (see locations in @fig-site-map). The SCLs consisted of a plastic trough with an opening of 0.9 m ^2^ and depth of 20 cm suspended from a load cell (Intertechnology 9363-D3-75-20T1) attached to an aluminum pipe connected between two trees. The load cell which measures kilograms was scaled to kg m^-2^ by dividing by the cross-sectional area of the SCL opening. For select time periods where ablative processes including, unloading, drip and wind redistribution could be considered negligible, the subcanopy lysimeters were inferred to provide measurements of throughfall [see method described in @Cebulski2024b]. Interception efficiency was calculated using @eq-dwdt-discrete and @eq-ip, combined with $\overline{q_{tf}}$ from the three SCLs and $\overline{q_{sf}}$ from the PWL snowfall gauge. For each of the 26 snowfall events the average interception efficiency over each event was calculated for each 15-minute timestep within the 26 snowfall events. Timelapse imagery, a weighed tree and in-situ observations were used to ensure the ablation of snow intercepted in the canopy or snow on the ground was minimal over each of the selected events. The canopy structure surrounding three SCLs and was measured using hemispherical photography (Nikon Coolpix 4500 and EC-F8 hemispherical lens) and the hemispheR R package @Chianucci2023 and is shown in @tbl-scl-lai-cc. 

Positioning of the troughs leads to differing influence of wind on I/P.

![Positioning of the troughs leads to differing influence of wind on I/P.](figs/supplement/troughs_in_context_of_23_72_event.png){#fig-ws-vs-ta width="400"}

```{r scl, echo=FALSE}
#| label: tbl-scl-lai-cc
#| tbl-cap: "Canopy structure of the three subcanopy lysimeters (SCL) located proximal to the FT Station. Leaf area index (LAI) and Canopy Coverage was measured using hemispherical photo analysis with the R package hemispheR."
#| 
scl_lai_cc <- read.csv('~/local-usask/analysis/interception/data/lai/scl_canopy_metrics.csv') 

scl_lai_cc$Name <- c('Mixed', 'Sparse', 'Closed')

scl_meta <- read.csv('~/local-usask/analysis/interception/data/loadcell/calibrations/load_cell_meta_ac_fortress.csv')

scl_lai_cc |> 
  arrange(cc) |> 
  mutate(cc = round(cc, 2)) |> 
  select(Name, `LAI (-)` = Le, `Canopy Coverage (-)` = cc) |> 
  knitr::kable(#booktabs = TRUE,
               #format = 'latex'
               )
```

A weighed tree lysimeter, measured the weight of canopy snow load, $L_{wt}$ (kg). A live subalpine fir (Abies lasiocarpa) tree was cut and suspended from a load cell (Artech S-Type 20210-100) at the beginning of the 2022 and 2023 water years which recorded the weight of the tree. The bottom of the tree was sealed to limit some transpiration and to prevent spinning and abrupt impacts of the free-hanging tree, the base of the tree was attached to a support system that allows for vertical movement but limits abrupt horizontal movements. The weight of snow in the weighed tree in kg was scaled to an areal estimate of canopy snow load ($L$, kg m^-2^) using measurements of areal throughfall (kg m^-2^) from manual snow surveys and snowfall from the PWL Station snowfall gauge [see description of method in @Hedstrom1998a]. While not used in the computation of interception efficiency, the weighed tree provided a continuous measurement of $L$ which were used to filter out periods of canopy snow ablation identified by periods of time that exhibited a loss in $L$.

## UAV Data Processing

Two uncrewed aerial vehicle (UAV) lidar surveys were conducted before and after a 24 hour snowfall event that occurred between March 13th and March 14th, 2023. These surveys were undertaken to facilitate the measurement of snow accumulation and canopy structure metrics. The UAV (FreeFly Alta X) was equipped with a REIGL miniVUX-2 airborne laser scanner payload, an Applanix APX-20 inertial measurement unit (IMU) and global navigation satellite system (GNSS). The UAV was flown 90 m above the ground at a speed of 3 m s^-1^ following a preprogrammed flight trajectory shown in @fig-site-map. 

The REIGL miniVUX-2 laser operates at a near infrared wavelength with a laser beam footprint of 0.160 m x 0.05 mm (at 100 m above ground). The accuracy and precision of the miniVUX-2 is described by REIGL for a lab environment of 0.015 m and 0.01 m respectively (at 50 m above ground). The miniVUX-2 was configured with a laser pulse repetition rate of 200 kHz, field of view of 360°, scan speed of 31.09 revolutions s^-1^ and an angular step width of 0.0558°, resulting in an expected an average point cloud density of 107 returns m^-2^ for each flight path.

Georeferenced point clouds with x, y, and z coordinates for each laser return were generated following methods outlined by @Harder2020 and @Staines2023 to reconcile survey lidar, IMU and GNSS data. A ground based GNSS system was positioned on a permanent monument during each survey and underwent precise point positioning (PPP) correction by @ppp2024. Differential GNSS correction of the UAV trajectory was conducted using the ground based PPP GNSS observations and the POSPac UAV software. The UAV-lidar point clouds were then transformed from a sensor referenced coordinate system to a georeferenced coordinate system (EPSG:32611 - WGS 84 / UTM zone 11N) using the RIEGL Riprocess Software. A vertical offset of up to 6 cm between UAV-lidar flight lines was observed in the resulting point clouds on March 13th and 14th, 2024 and was attributed to IMU position drift. This offset between flight lines was corrected using the BayesStripAlign software v2.24 [@BayesMap2024], which reduces relative and absolute uncertainties in the vertical elevation of the point cloud using the ground control points (GCP) collected across the study site using a differential GNSS rover. After strip alignment, the mean elevation bias (lidar minus GCP) was 0.000 m and the RMS error changed from 0.055 m to 0.038 m March 13^th^ and changed from 0.033 m to 0.029 m on March 14^th^. The point cloud density ranged from ~1200 returns m^2^ in open clearings to ~2200 m^2^ in sparse forest for both the March 13 and 14th surveys after all flight paths were combined. 

Quality control, ground classification and calculation of the change in between two UAV-lidar point clouds was conducted using the LAStools software package [@LAStools2024]. The ground classification was conducted using the "lasground_new" function [@LAStools2024] for both the pre and post snowfall event point clouds, with a step size set to 2 m and 8 substeps (ultra_fine setting). The offset and spike options were set to remove points that are more than 0.1 m above or below the initial ground surface estimate surface which "lasground_new" fits to the last returns. This function is based on an algorithm outlined by @Axelsson2000, describing the process of making the initial ground surface element.

## Snow Surveys

### In-situ Snow Depth and Density

```{r, include=FALSE}
lai_measurements <- read.csv('../../analysis/interception/data/lai/results/2023_compiled_lai_vza_15_60.csv')  |>
  filter(vza == 60) 

cc_range <- paste(round(min(lai_measurements$cc), 2), '–', round(max(lai_measurements$cc), 2))
lai_range <- paste(round(min(lai_measurements$Le), 2), '–', round(max(lai_measurements$Le), 2))
```

In-situ fresh snow surveys provided measurements of subcanopy throughfall following the transects shown in @fig-site-map. Twelve fresh snow surveys (six pre and post snowfall event pairs) at 30 stations were selected which had minimal ablation and redistribution between pre and post surveys and were used to scale the weighed tree following methods outline in @Hedstrom1998a. When conditions allowed for a UAV-lidar flight, the in-situ snow surveys were conducted following the UAV-lidar flight to assess the accuracy of the throughfall measurements and provide a fresh snow density for the calculation of SWE (kg m^-2^). A 1000 cm^3^ snow density wedge sampler (RIP Cutter, https://snowmetrics.com/shop/rip-1-cutter-1000-cc/) was used to measure the density of the fresh snow layer, $\overline{\rho_{tf}}$ (kg m^-3^). The throughfall depth measurements, $\Delta HS$ were converted to SWE using the following equation:

$$
\Delta SWE_{tf} = \Delta HS \cdot \overline{\rho_{tf}}
$${#eq-swe-tf}

Differential GNSS rover coordinates, with ± 2.5 cm 3D uncertainty, were taken at each snow sampling location so the locations could be queried later from the UAV-lidar rasters. If a pre event crust layer was present the depth of post event fresh snow accumulation above the crust layer were interpreted as throughfall over the event. In the absence of a defined crust layer, the difference in pre and post event snow depth to ground was interpreted as event throughfall.

### UAV-Lidar Snow Depth

Two UAV-lidar surveys were selected for detailed analysis in this study, one prior to a snowfall event on March 13, 2023 at 10:00 CST and another following snowfall on March 14, 2023 at 11:00 CST. These two surveys enabled fine-scale analysis of snow accumulation and canopy structure within the FT and PWL forest plots. This snowfall event was selected based on two criteria: 1) it provided sufficient cumulative snowfall to result in a low relative error in UAV-LiDAR measured throughfall, and (2) minimal redistribution and ablation were observed over the event, as confirmed by the SCLs, weighed tree, and time-lapse imagery. The change in elevation between the two UAV-lidar surveys was interpreted as the increase in snow accumulation, $\Delta HS$ over the snowfall event. This change was calculated using a point-to-grid subtraction method, using the "lasheight" function from the @LAStools2024 software, as in @Deems2013 and @Staines2023. The pre snowfall event point cloud from "lasground_new" by "lasheight" to construct a "ground" TIN. Subsequently, the height of each post snowfall event point above the ground TIN, resulting in a point cloud representing $\Delta HS$. This point cloud was then converted into a raster of $\Delta HS$ with a grid cell resolution of 5 x 5 cm using the "las2dem" function. Further quality control and resampling of the 5 cm raster of $\Delta HS$ was conducted using the 'Terra' R package [@Hijmans2024]. Regions that were disturbed over the snowfall event during the in-situ snow survey and values that exceeded the .999th quantile were removed. To help remove any remaining noise a 25 cm $\Delta HS$ raster was generated by computing the median of the 5 cm $\Delta HS$ values within each 25 cm grid cell.

## UAV-Lidar Canopy Metrics

The point cloud and trajectory data acquired from the two UAV-lidar surveys were also utilized to characterize the canopy structure of the FT and PWL forest plots. To characterize the canopy structure, the voxel ray sampling (VoxRS) methodology for lidar data analysis was employed, as outlined by @Staines2023. This method was chosen for its ability to provide canopy metrics that are less sensitive to the inherent non-uniform nature of lidar sampling data, which often results from beam occlusion in vegetation and leads to reduced points near the ground. The VoxRS algorithm is publicly available at https://github.com/jstaines/VoxRS. The canopy products produced from VoxRS here include: canopy contact number, the mean theoretical number of canopy contacts for a given ray, and radiation transmittance ($\tau$) all with units (-). See supporting information in @Staines2023 for details on how these metrics are computed. The fraction of snow-leaf contact area per unit area of ground used in @Hedstrom1998a, and hereafter called leaf contact area ($C_p$), was calculated as:

$$
C_p(C_c, \theta_h, L) = 1-\tau
$${#eq-lca}

$$
C_p(C_c, \theta_h, L) = \begin{cases}
    1-\tau,& \text{if } \theta_h> 0°\\
    1-\tau \approx C_c ,              & \theta_h= 0°
\end{cases}
$${#eq-tf-ode}

where $C_p$ is a function of the canopy coverage $C_c$, $\theta_h$ and $L$. $C_p$ is approximately equal to canopy coverage ($C_c$) for vertical snowfall. However, for non-vertical snowfall $1 > C_p > C_c$.

## Correlation Between Forest Structure and Interception

To determine how forest structure was associated with interception efficiency at different azimuth and zenith angles over the March 13-14 snowfall event, each portion of the hemisphere at each grid location was considered. The relationship between interception efficiency and canopy contact number was found to be linear and thus the Pearson Correlation Coefficient, $\rho_p$ was calculated using the 'stats' package in R [@R2022] to quantify the association between a single raster of interception efficiency and the 32'760 rasters containing the canopy contact number hemisphere for each portion of the hemisphere (azimuth [0°, 1°, ..., 359°], zenith angle [0°, 1°, ..., 90°]) for each of the 25 cm grid cells across the FT and PWL forest plots. 

## Regression Models 

Linear and non-linear models, based on observed data and theoretical justification presented in this study, were developed and assessed using the 'stats' package in R [@R2022]. Linear models were fitted using ordinary least squares regression via the 'lm' function to analyze two relationships: (1) between interception efficiency and leaf contact area, and (2) between leaf contact area and trajectory angle. Both models were forced through the origin based on the theoretical justification that the dependent variable should be zero when the independent variable is zero. To assess the performance of the linear models, we calculated four metrics comparing observed and modelled values: mean bias, mean absolute error (MAE), root mean square error (RMSE), and the coefficient of determination (R^2^). Following @Kozak1995, we recognized that the default R^2^ value provided for least squares models forced through the origin by many statistical packages can be misleading. Therefore, we adjusted these R^2^ values using Equation 10 in @Kozak1995. Although we had theoretical justifications for forcing the intercept through the origin, we also employed two statistical tests as described by @Kozak1995 to verify whether a no-intercept model (forced through the origin) was appropriate for our data compared to a with-intercept model (including an intercept). The first test evaluated if the intercept of the with-intercept was significantly different from zero using p-value provided by the 'summary' function from the 'stats' package in R. The second test examined if there was a significant difference between the no-intercept and with-intercept models by testing if the residual sum of squares was different between the no-intercept and full model, assessed via Equation 15 in @Kozak1995. If the first test indicated a significant difference, and the second did not, the no-intercept model could be deemed statistically justified [@Kozak1995]. Non-linear models were fitted using non-linear least squares regression via the 'nls' function in 'stats' package in R. The non-linear models were assessed by comparing predicted values to observed values using three metrics: mean bias, mean absolute error (MAE), root mean square error (RMSE), and R^2^.

# Results

## The influence of meteorology on snow interception

@fig-scl-w-sf depicts the state of canopy snow load with cumulative snowfall, over 26 snowfall events using the three SCLs and the PWL snowfall gauge. Canopy snow load was observed in @fig-scl-w-sf to increase linearly with increasing snowfall without evidence of reaching a maximum canopy storage capacity. Variation in the slope of each line in @fig-scl-w-sf, is attributed to differences in the meteorology and antecedent canopy snow load within and between the individual events. Variations in the canopy structure surrounding the SCL instruments as shown in @tbl-scl-lai-cc, also contributed to the difference in slope. The absence of canopy snow load measurements in @fig-scl-w-sf for certain troughs during specific events was caused by damage to the subcanopy lysimeter wiring due to animal interference and snow load.

![Plot showing the cumulative event snowfall versus the corresponding state of canopy snow load calculated using the SCLs for each of the 26 snowfall events. The SCLs are denoted by a distinct colour (grey, yellow, and green), correspond to varying canopy coverage (0.73, 0.78, and 0.82, respectively).](figs/automated_snowfall_event_periods/cuml_event_snowfall_canopy_storage_sep_scl.png){#fig-scl-w-sf}

```{r, include = F}
mean_ip_by_trough <- readRDS('data/mean_ip_by_trough.rds')

mean_ip_sparse <- mean_ip_by_trough$IP[mean_ip_by_trough == 'sparse_forest'] |> round(2)
mean_ip_med <- mean_ip_by_trough$IP[mean_ip_by_trough == 'mixed'] |> round(2)
mean_ip_dense <- mean_ip_by_trough$IP[mean_ip_by_trough == 'dense_forest'] |> round(2)
```

@TODO could change met ip fig to show less bins (maybe just 2 as in the wilcoxon test or could do three and change to a non parametric anova - Kruskal-Wallis test)

@fig-lai-met-ip shows the association between interception efficiency measured by the three SCLs and the corresponding air temperature, wind speed, canopy snow load for the same 15-minute time interval. The mean interception efficiency measured over all 26 snowfall events is `r mean_ip_sparse`, `r mean_ip_med`, and `r mean_ip_dense` for the sparse, mixed, and closed SCLs respectively. Panel A in @fig-lai-met-ip shows that 15-minute average air temperature measurements has a very low correlation with interception efficiency (R^2^ < 0.04, *p* < 0.05). The average interception efficiency observed within air temperature bins also does not visually exhibit any systematic trend. A significantly greater median interception efficiency (*p* < 0.05) was found for air temperatures below -6 °C using non-parameteric Wilcoxon signed rank test.

Panel B in @fig-lai-met-ip shows that wind speed measured at FT Station demonstrated a positive association with interception efficiency at the sparse and closed SCLs. The non-binned 15-minute observations of wind speed and air temperature showed very low correlation with the R^2^ ranging between 0.04 and 0.08 (*p* < 0.05) for all three troughs. The association between wind speed and interception efficiency was observed to be positive for the sparse and closed SCLs, while the mixed SCL exhibited a negative association. Between wind speed bins of 0.25 and 2.75 m s^-1^ the mean interception efficiency increased from 0.58 to 0.66 and 0.48 to 0.61 for the closed and sparse forest SCLs respectively (@fig-lai-met-ip, B). The mixed SCL declined from 0.59 to 0.45 for the same range in wind speed bins. A comparison interception efficiency between low (< 1 m s^-1^) and high (> 1 m s^-1^) wind speeds by the Wilcoxon signed rank test showed that high wind speeds had significantly higher (*p* < 0.05) median interception efficiency compared to the low wind speed group for the closed and sparse SCL. Conversely, the Wilcoxon test showed the mixed SCL had significantly higher (*p* < 0.05) median interception efficiency for the low wind speed group. For the closed and sparse SCLs this increase in interception efficiency is interpreted to be due to an associated increase in canopy contact area as hydrometeor trajectory becomes more horizontal with increasing wind speed. The canopy surrounding the mixed SCL is open (see @fig-site-map) to the prevailing wind direction, shown in @fig-wind-rose, observed over the snowfall events included in this analysis and therefore showed a opposing relationship as the trajectory of hydrometeors primarily entered the SCL through this opening to the southwest rather than directly overhead which may have have more canopy elements intercepting snowfall. 

@fig-lai-met-ip, panel C shows canopy snow load, measured at the beginning of each timestep, shows a relatively weak significant negative relationship between the 15-minute observations (R^2^ < 0.4, *p* < 0.05) for the closed and sparse SCLs and a non-significant relationship was observed for the mixed SCL. The binned data show a small increase in interception efficiency was observed for all three troughs between canopy snow loads of 0 kg m^-2^ to 7 kg m^-2^. This was followed by a gradual decline in interception efficiency for snow loads greater than 7 kg m^-2^ with the closed and sparse SCL (@fig-lai-met-ip, C). The interception efficiency measured by the mixed SCL also declines above 7 kg m^-2^ before increasing again around 16 kg m^-2^ and then declines again to a minimum interception efficiency of 0.39. A comparison of low (< 10 kg m^-2^) and high (> 10 kg m^-2^) canopy snow loads using the Wilcoxon rank-test showed the low canopy snow loads had significantly greater (*p* < 0.05) median interception efficiency compared to the high canopy snow load group. The location of the SCLs within gaps in the canopy may have contributed to these instruments registering a slight increase in interception efficiency as small branch gaps are covered by snow followed by a decline in interception efficiency as branches bend due to the weight of snow intercepted on the branch compressing it downwards and thus reducing the canopy coverage above the SCLs. No association was observed between hydrometeor diameter and hydrometeor velocity and interception efficiency.

![Scatter plots of discrete observations (blue dots) and binned data (black dots with error bars) of meteorology, canopy load, and hydrometeor characteristics versus snow interception efficiency. Panels show (A) air temperature, (B) relative humidity, (C) wind speed, (D) initial canopy snow load (the snow load observed at the beginning of the timestep), (E) hydrometeor diameter, (F) hydrometeor velocity. The black open circles show the mean of each bin and the error bars represent the standard deviations. The data were filtered to include observations with a snowfall rate > 0 kg m^-2^ hr^-1^, throughfall rate > 0.05 kg m^-2^ hr^-1^ to minimize noise and a snowfall rate > the subcanopy lysimeter throughfall rate to minimize observations with unloading. Periods of unloading and melt were also removed through careful analysis of the weighed tree, subcanopy lysimeters, and timelapse imagery.](figs/automated_snowfall_event_periods/troughs_met_vs_IP_bin.png){#fig-lai-met-ip}

## The influence of forest structure on snow interception

```{r, include=FALSE}
source('../../analysis/disdrometer/scripts/00_source_functions.R')

# MET
snowing_met <- readRDS('data/event_met/lidar_events_met_avgs_snowing.rds') |> 
  filter(event_id == '2023-03-14')

ft_ws_avg <- snowing_met |> 
  pull(`mean FT Wind Speed (m/s)`) |> 
  round(2)
pwl_ws_avg <- snowing_met |> 
  pull(`mean PWL Wind Speed (m/s)`) |> 
  round(2)
wd <- snowing_met |> 
  pull(`mean FT Wind Dir. (°)`) |> 
  round()
hm <- 0.9 # mean measured event parsivel
ft_ta <- traj_angle_deg(ft_ws_avg, hm) |> 
  round(0)
pwl_ta <- traj_angle_deg(pwl_ws_avg, hm) |> 
  round(0)

# HEMI STATS

# first found the theta range which corresponded to the upper 97.5th percentile of rho values
vox_config_id <- "23_072_vox_len_0.25m_sa_gridgen_v2.0.0_sa"
pwl_hemi_stat <-
  readRDS(
  paste0(
    '../../analysis/lidar-processing/data/hemi_stats/hemi_raw_theta_phi_for_rho_s_upper_2_5th_percentile_',
    vox_config_id,
    "_",
    'PWL_E',
    '.rds'
  ))

ft_hemi_stat <-
  readRDS(
  paste0(
    '../../analysis/lidar-processing/data/hemi_stats/hemi_raw_theta_phi_for_rho_s_upper_2_5th_percentile_',
    vox_config_id,
    "_",
    'FSR_S',
    '.rds'
  ))


pwl_theta_to <- max(pwl_hemi_stat$theta_d) |> round()
ft_theta_to <- max(ft_hemi_stat$theta_d) |> round()
pwl_theta_from <- min(pwl_hemi_stat$theta_d) |> round()
ft_theta_from <- min(ft_hemi_stat$theta_d) |> round()

# then found the phi which had the best rho based on the theta range above
cor_stats <-
  readRDS('../../analysis/lidar-processing/data/hemi_stats/r2_vs_integrated_and_single_zentith.rds')
# find the zenith corresponding to the highest R value
cor_smry <- cor_stats |>
  group_by(plot_name, group) |>
  summarise(
    rp = max(rp),
    peak_r2 = max(r2),
            phi_at_peak_r2 = phi_d[which.max(r2)])

pwl_best_phi_rho <- cor_smry$rp[cor_smry$plot_name == 'PWL' & cor_smry$group == 'Single Zenith']  |> round(2)
ft_best_phi_rho <- cor_smry$rp[cor_smry$plot_name == 'FT' & cor_smry$group == 'Single Zenith'] |> round(2)

pwl_best_phi <- cor_smry$phi_at_peak_r2[cor_smry$plot_name == 'PWL' & cor_smry$group == 'Single Zenith']
ft_best_phi <- cor_smry$phi_at_peak_r2[cor_smry$plot_name == 'FT' & cor_smry$group == 'Single Zenith']

# model error stats
mod_error <- readRDS('../../analysis/lidar-processing/data/models/lca_vs_ip_model_error_ft_pwl_nadir_adj.rds')

ft_a_val <- mod_error$`Model Slope`[mod_error$`Plot Name` == 'FT' & mod_error$`Canopy Metrics` == 'Vector Based'] |> round(2)
pwl_a_val <- mod_error$`Model Slope`[mod_error$`Plot Name` == 'PWL' & mod_error$`Canopy Metrics` == 'Vector Based'] |> round(2)
ft_r2_val <- mod_error$R2_adj[mod_error$`Plot Name` == 'FT' & mod_error$`Canopy Metrics` == 'Vector Based'] |> round(2)
pwl_r2_val <- mod_error$R2_adj[mod_error$`Plot Name` == 'PWL' & mod_error$`Canopy Metrics` == 'Vector Based'] |> round(2)
pwl_r2_val_nadir <- mod_error$R2_adj[mod_error$`Plot Name` == 'PWL' & mod_error$`Canopy Metrics` == 'Nadir'] |> round(2)
ft_r2_val_nadir <- mod_error$R2_adj[mod_error$`Plot Name` == 'FT' & mod_error$`Canopy Metrics` == 'Nadir'] |> round(2)

ft_10m_example <- readRDS('data/event_met/ft_20230313_wind_speed_traj_angle_10m.rds')
ft_2m_example <- readRDS('data/event_met/ft_20230313_wind_speed_traj_angle_2m.rds')
ft_mean_wind_prof_integral <- readRDS('data/event_met/ft_20230313_mean_integral_wind_profile_and_traj.rds')
ft_mean_wind_speed_prof_integral <- ft_mean_wind_prof_integral$wind_speed |> round(2)

```

UAV-lidar measurements of throughfall and canopy structure metrics provide insights on how the forest canopy influenced subcanopy snow accumulation during the March 13-14 snowfall event. This event totalled 28.4 kg m^-2^ of snowfall at PWL station and was characterized by a transition from low rates of snowfall and air temperature near 0°C to higher rates of snowfall late afternoon on March 13 coinciding with air temperatures around -2.5 °C. An average wind speed of 1.27 m s-1 and direction of 188° was observed 4.2 m above the ground at FT Station. UAV-lidar measurements of throughfall shown in @fig-lidar-tf-ip, used in the calculation of interception efficiency, aligned well with 28 in-situ manual throughfall measurements with a mean bias of -0.001 m and RMSE of 0.024 m. All three SCLs and the weighed tree registered a 2 kg m^-2^ unloading event during a brief pause in snowfall early in the morning on March 14, prior to the UAV-lidar flight. This unloading event in addition to the moderate wind speeds observed during the snowfall event likely contributed to some redistribution of snow on the ground. The relatively small unloading event compared to the amount of snow that fell during the snowfall event and minimal evidence of observed wind redistribution on the ground is inferred to have not significantly altered the UAV-lidar throughfall measurements. 

@fig-lidar-tf-ip shows the spatial distribution of throughfall and interception efficiency at the PWL and FT forest plots. Reduced throughfall and greater interception efficiency is observed on the north (lee) side of individual trees, which is interpreted to be a result of non-vertical hydrometeor trajectories caused by the steady southerly winds observed over this event. This effect is shown in @fig-lidar-tf-ip to be more apparent within the PWL forest plot, compared to the FT forest plot. This may be attributed to the taller trees and higher canopy coverage within the PWL forest plot compared to the FT forest plot, where given the same trajectory angle a taller tree will produce a larger footprint.

![UAV-lidar measurements of the change in SWE (kg m^-2^) and interception efficiency over the March 13, 2023 24 hr snowfall event for the FT and PWL forest plots at a 25 cm resolution. Transparent areas represent grids that did not have any lidar ground returns (i.e., under dense canopy proximal to tree trunks) or have been masked due to disturbance. See the location of the two forest plots within FMRB in @fig-site-map.](../../analysis/lidar-processing/figs/maps/facet_ft_pwl_23_072_23_073_v2.0.0_saswe_and_ip_normalised_resample_0.25.png){#fig-lidar-tf-ip}

@fig-hemi-ip-cc presents two hemisphere plots which illustrate the correlation between $C_p$ and interception efficiency at a 0.25 m horizontal grid cell resolution over differing azimuth and zenith angles for both the FT and PWL forest plots. These plots demonstrate a strong correlation between $C_p$ and interception efficiency towards the southern portion of the hemisphere, aligning with the average wind direction observed during the event. For the PWL forest plot, the upper 97.5th percentile of the $\rho_p$ values shown in @fig-hemi-ip-cc, were found between azimuth angles of `r pwl_theta_from`° – `r pwl_theta_to`°. Similarly, for the FT forest plot, the upper 97.5th percentile of $\rho_p$ was found between azimuth angles of `r ft_theta_from`° – `r ft_theta_to`°. The zenith angle found to have the highest correlation over this azimuth range was `r pwl_best_phi`° ($\rho_p$ = `r pwl_best_phi_rho`) and `r ft_best_phi`° ($\rho_p$ = `r ft_best_phi_rho`) for PWL and FT respectively. The high correlation coefficients found for non-vertical zenith angles for both PWL and FT are interpreted to be a result of inclined hydrometeor trajectories. At near-nadir zenith angles, @fig-hemi-ip-cc illustrates slightly lower $\rho_p$. In addition to the inclined hydrometeor trajectories, this may be influenced by reduced UAV-lidar returns and higher error proximal to the trunks of individual trees, as shown in @fig-lidar-tf-ip. However, this limitation does not significantly alter the interpretation of the results. 

![The Pearson Correlation Coefficient between rasters (25 cm resolution) of interception efficiency and leaf contact area for each grid cell across the study site for each azimuth angles (0°, 1°, ..., 359°) and zenith angles (0°, 1°, ..., 90°) for the FT (left) and PWL (right) forest plots.](../../analysis/lidar-processing/figs/voxrs/hemis/full_hemi_rho_p_cor_lca_ip_23_072_vox_len_0.25m_sa_gridgen_v2.0.0_sa_ft_pwl_.png){#fig-hemi-ip-cc}

@fig-lca-vs-ip shows that the correlation between $C_p$ and interception efficiency, resampled to a 5 m resolution, is stronger when $C_p$ is adjusted for the observed shift in hydrometeor trajectory (Vector Based), compared to the nadir leaf contact angle (zenith angle of 0°). For the vector based model, $C_p$ was calculated using the VoxRS dataset corresponding to the azimuth range and zenith angle with the highest $rho_p$ for each plot mentioned in the previous paragraph. An ordinary least squares linear regression forced through the origin was fit to the observed data points using the following equation:

$$
  \frac{I}{P} = C_p(C_c, \theta_h) \cdot \alpha
$${#eq-lca-ip}

where $\alpha$ is an efficiency constant which determines the fraction of snowflakes that contact the $C_p$ elements and are stored in the canopy (i.e., intercepted) before canopy snow unloading or ablation processes begin.

For the FT plot the Nadir linear regression model provides a good overall fit to the observed data (R^2^ of `r ft_r2_val_nadir`) and closely follows the 1:1 line in @fig-lca-vs-ip, with some significant scatter. For the PWL plot, the observed points follow a linear relationship until a $C_p$ value of around 0.50 after which the increase in interception efficiency plateaus. As a result, after the @Kozak1995 adjustment a negative R^2^ value for the PWL plot was determined. Some of the scatter observed in the Nadir model shown in @fig-lca-vs-ip may be explained by grid cells which observed a greater interception efficiency compared to the corresponding $C_c$ value, and can be attributed to the inability of $C_c$ to represent the increase in interception observed within canopy gaps in @fig-lidar-tf-ip. Conversely, for grid cells where interception efficiency is less than $C_c$, may be attributed to non-vertical trajectory hydrometeors making their way underneath the canopy as observed by the reduced interception efficiency on the windward edges of individual trees in @fig-lidar-tf-ip. This later explanation explains the non-linear relationship observed for the PWL Nadir model in @fig-lidar-tf-ip.

For the Vector Based model, the relationship between interception efficiency and $C_p$ is better represented by a linear regression model for both plots with R^2^ values of `r pwl_r2_val` and `r ft_r2_val` for PWL and FT respectively. The increase in interception efficiency with $C_p$ follows a reduced slope compared to the Nadir models with $\alpha$ values of `r pwl_a_val` and `r ft_a_val` for the PWL and FT plots respectively. The reduced slope for the Vector Based models may be attributed to snowflakes that weaved through and/or bounced off branch elements in addition to some of the UAV-lidar measurement uncertainty which contained some unloading and redistribution. These processes would have acted together to reduce the fraction of snowfall that contacted the canopy that was intercepted.

Model error statistics are presented in @tbl-ip-mod-err for the Nadir and Vector Based models. The Vector Based model improved predicted interception efficiency reducing the RMSE from 0.099 to 0.062 for the FT plot and 0.146 to 0.095 for the PWL plot. The good model performance shown for the Vector Based model demonstrates that using $C_p$ adjusted for observed event hydrometeor trajectory angle has the potential to be a predictor of interception efficiency, before ablation. However, the detailed point clouds required to derived the $C_p$ values used in this analysis are rarely available and thus more accessible methods to obtain a proxy of $C_p$ must be obtained if @eq-lca-ip is to be employed in earth system models. 

![Scatter plots showing the relationship between leaf contact area and interception efficiency rasters resampled to a 5 m grid cell resolution. The left plot (Nadir) shows leaf contact area measured from a zenith angle of 0°. The right plot (Vector Based*) shows the leaf contact area averaged over rasters with zenith angles (PWL = 22°, FT = 21°) and azimuth angles (PWL = 167°, 178°, ... 217°; FT = 171°, 172°, ... 223°). The solid lines (Model fit) show the ordinary least squares linear regression forced through the origin and fit to the UAV-lidar measured data for the PWL (red) and FT (black) forest plots. The light grey dotted line shows a 1:1 line. The R^2 values for the four different models are shown in the upper right of each panel calculated following the methods outlined in @Kozak1995.](../../analysis/lidar-processing/figs/voxrs/scatter/pwl_ft_lca_vs_ip_phi_nadir_adjusted_resample_w_mods_5m.png){#fig-lca-vs-ip}

```{r tbl-ip-mod-err, echo=FALSE}
#| label: tbl-ip-mod-err
#| tbl-cap: "Model error statistics provided for predictions of interception efficiency using @eq-lca-ip and for different $a$ values, as shown in the Model Slope column. Statistics are provided for the PWL and FT forest plots, using leaf contact area canopy metrics adjusted to zenith angles of (0°, 1°, ... 30°) and azimuth angles (170°, 171°, ... 220°) and nadir zenith angle of 0°. The Mean bias is the difference in the model and observed values, MAE is the mean of the absolute error, RMS Error is the root mean squared error, R^2 is the coefficient of determination adjusted using Equation 10 in @Kozak1995."

mod_error |> 
  rename(`R^2` = R2_adj) |> 
  select(-R2_base) |> 
  knitr::kable()
  # knitr::kable(booktabs = TRUE,
  #              format = 'latex')

```

## The dominant trajectory angle for a snow interception event 

A logarithmic wind speed profile shown in @fig-wind-profiles provided a good fit to the observed wind speed over the event and shows the @Cionco1965 was not appropriate for this study site. The friction velocity observed over the event was estimated to be 0.37 m s^-1^ by rearranging @eq-log-wind-profile to solve for friction velocity and using the site derived roughness length and displacement height values and the March 13-14 snowfall event mean wind speed at FT Station.  which resulted in a friction velocity observed over the March 13-14 event of 0.37 m s^-1^. The heavy snowfall over this event covered the two eddy covariance systems at FT station with snow limiting wind speed measurements to test this wind speed profile at different heights or provide a measurement of friction velocity for this event.

@fig-wind-profiles shows predicted hydrometeor trajectory angles at varying heights, calculated using @eq-ta and the mean observed hydrometeor terminal velocity observed over the event of, 0.9 m s^-1^. An average wind speed of `r ft_mean_wind_speed_prof_integral` m s^-1^ and direction of 188° was observed over the wind speed profile within the canopy (@fig-wind-profiles). The corresponding trajectory angle, calculated using @eq-ta, from this integrated wind speed was `ft_mean_wind_prof_integral$traj_angle |> round(2)`°. This estimated trajectory angle is much higher than the trajectory angle closer to 20° observed in @fig-hemi-ip-cc. Based on this wind speed profile a trajectory angle of around 20° would have resulted from a mean wind speed of `r pwl_best_wind` m s^-1^ and `r ft_best_wind` s^-1^ and a height above the snowpack of `r pwl_wind_height_off_snow` m and `r ft_wind_height_off_snow` m for PWL and FT respectively. 

Based on the event average snowpack depth at FT station of `r event_sd` m, this corresponds to a height above the ground that is `r pwl_wind_height_off_ground` m and `r ft_wind_height_off_ground` m for PWL and FT respectively and fraction of the mean canopy height of `r pwl_frac_cpy_height_off_ground` m and `r ft_frac_cpy_height_off_ground` as a result of the differing tree heights within two plots. This corresponds to roughly one-third the canopy height, based on an average of the two forest plots, to achieve this low wind speed is interpreted to be a result of the conical shape of the needleleaf trees surrounding PWL and FT which have the majority of their needleleaf elements lower towards the ground. Although the wind speeds were observed to be higher near the top of the canopy, corresponding to higher trajectory angles, the reduced amount of needleleaf elements at this height result in a smaller impact of these more horizontal trajectories. 

![Wind speed profile fit to roughness length and displacement height parameters derived from anemometors at 3, 4, and 15 m above ground at FT station over two years and friction velocity observed over the March 13-14th snowfall event. The red triangle shows the mean observed wind speed at 4.2 m measured at FT station over the March 13-14 snowfall event.](figs/lidar_periods/wind_profile_w_trajectories_20230313.png){#fig-wind-profiles}

## The combined influence of trajectory angle and forest structure on interception

```{r, include=FALSE}
library(dplyr)
hemi_stats <- readRDS('../../analysis/lidar-processing/data/hemi_stats/full_voxrs_not_filtered_to_swe_traj_angle_w_lca_23_072.rds') |> 
  mutate(find_wind = abs(1-wind_speed))

select_wind_speed <- 1
pwl <- hemi_stats |> filter(plot_name == 'PWL')
ft <- hemi_stats |> filter(plot_name == 'FT')
pwl_inc <- pwl$lca_inc[which.min(abs(select_wind_speed-pwl$wind_speed))]
ft_inc <- ft$lca_inc[which.min(abs(select_wind_speed-ft$wind_speed))]
ta <- pwl$traj_angle[which.min(abs(select_wind_speed-pwl$wind_speed))]

pwl_nadir <- pwl$lca_nadir |> unique()
ft_nadir <- ft$lca_nadir |> unique()
pwl_perc_inc <- pwl_inc / pwl_nadir * 100
ft_perc_inc <- ft_inc / ft_nadir * 100

pwl_nls_coefs <- readRDS('../../analysis/lidar-processing/data/models/ta_vs_lca_nls_coefs_pwl.rds')
ft_nls_coefs <- readRDS('../../analysis/lidar-processing/data/models/ta_vs_lca_nls_coefs_pwl.rds')


ft_wp_pars <- readRDS(
  '../../analysis/eddy-cov/data/forest_tower_wind_profile_params_clean_ec_events.rds'
) |> select(-ustar) # need to calculate based on the event wind speed


```

@fig-lca-ht-ws shows that $C_p$, estimated from VoxRS prior to snowfall on March 13th, demonstrates a positive relationship with the simulated hydrometeor trajectory angle. The standard deviation in VoxRS measured $C_p$, illustrated by the shaded area in @fig-lca-ht-ws exhibits the large range in values for individual grid cells across each forest plot. Despite this large scatter, a systematic increase in the plot mean $C_p$ results from a rise in the number of canopy elements for more horizontal portions of the hemisphere, when averaged across each forest plot, over all azimuth angles (see solid lines top row, @fig-lca-ht-ws). The increase in $C_p$ from $C_c$ (i.e., $C_p - C_c$), with increasing trajectory angle is shown on the bottom row of @fig-lca-ht-ws and exhibits a similar relationship for both forest plots FT and PWL until trajectory angles reach approximately 60°. Beyond 60°, the PWL rate of increase slows as the $C_p$ approaches .90 around 60°, while the FT plot, which has lower $C_c$, continues to rise quickly until around 75° afterwards the slope is reduced as a $C_p$ of one is approached. 

At the stand scale, increasing the hydrometeor trajectory angle results in a substantial rise in the VoxRS measured $C_p$ over relatively common estimated wind speeds. For example, with a wind speed of `r select_wind_speed` m s^-1^ and estimated trajectory angle of `r ta |> round(0)`°, the $C_p$ increased by a fraction of `r pwl_inc |> round(2)` and `r ft_inc |> round(2)` for the PWL and FT forest plots respectively in @fig-lca-ht-ws (right panel). This is a percent increase in the plot $C_p$ from nadir of `r pwl_perc_inc |> round(0)`% and `r ft_perc_inc |> round(0)`% for PWL and FT respectively. $C_p$ was also quantified across trajectory angles for both PWL and FT on March 14th, post snowfall, and showed a negligible effect of canopy snow load on $C_p$. A similar rate of increase in $C_p$ was observed between both the FT and PWL forest plots up to around 60° and suggests a similar function may be able to be used for corresponding wind speeds under 1.5 m s^-1^.

<!-- These figures are generated under the lidar-processing project using scripts 11-13. Recently sped up the processing for these and can now be run locally. -->

![Plots showing the relationship between hydrometeor trajectory angle (left) and wind speed (right) with leaf contact area, $C_p$ (top row) and the increase in leaf contact area, i.e., $C_p - C_c$ (bottom row). Simulated hydrometeor trajectory angle is measured as degrees from zenith. Simulated wind speed was calculated as a function of hydrometeor trajectory angle by rearranging @eq-ta and an observed event hydrometeor velocity of 0.9 m s^-1^. The solid lines (VoxRS) represent the mean leaf contact (top) or increase in leaf contact area (bottom) area observed from VoxRS across all grid cells for each forest plot and across all azimuth angles for a single zenith angle. The shaded area represents 1 standard deviation above and below the observed VoxRS mean. The dashed lines (Fitted) represent predictions from @eq-lca-ac (top) and @eq-lca-inc (bottom). The dotted lines (HP98) represent the predictions from Equation 10 in @Hedstrom1998a. A forested downwind distance of 100 m was used for the HP98 calculation. The line colour represents the forest plot, FT (black) and PWL (red)](../../analysis/lidar-processing/figs/voxrs/scatter/WITH_TREEWELLS_traj_angle_and_wind_phiby_1_thetaby_2_traj_angle_wind_speed_vs_cowplot_lca_and_inc_w_mods_mean_sd_23_072.png){#fig-lca-ht-ws}

A function is proposed here that calculates plot scale leaf contact area, $C_p$ (-):

$$
C_p = C_c + C_{inc}(\theta_h)
$${#eq-lca-ac}

where, $C_{inc}$ is the increase in leaf contact area from $C_c$ which is a function of the zenith angle (hydrometor trajectory) of interest. To estimate $C_{inc}$ a non-linear least squares regression using a logistic function forced through the origin was fit to the FT and PWL observations (see dashed lines in bottom row of @fig-lca-ht-ws). The logistic function used predict $C_{inc}$ as a function of $\theta_h$ is:  

$$
C_{inc} = \left(
\frac{C^{max}_{inc}}{1 + e ^ {\left(\frac{\theta_0 - \theta_h}{\text{k}}\right)}} - \frac{C^{max}_{inc}}{1 + e ^ {\left(\frac{\theta_0}{\text{k}}\right)}}
\right)
$${#eq-lca-inc}

where $C^{max}_{inc}$ is the maximum value of $C_{inc}$, $\theta_0$ is the x value of the sigmoid midpoint and $k$ is the logistic growth rate or steepness of the curve. 

The resulting coefficients for $LCA_{max}$, $\theta_0$ and $k$ after the nls fit to the VoxRS dataset `r pwl_nls_coefs['Asym'] |> as.numeric() |> round (3)`, `r pwl_nls_coefs['xmid'] |> as.numeric() |> round (3)` and `r pwl_nls_coefs['scal'] |> as.numeric() |> round (3)` respectively for PWL. For FT the resulting coefficents for $LCA_{max}$, $\theta_0$ and $k$ from nls were `r ft_nls_coefs['Asym'] |> as.numeric() |> round (3)`, `r ft_nls_coefs['xmid'] |> as.numeric() |> round (3)` and `r ft_nls_coefs['scal'] |> as.numeric() |> round (3)` respectively. A logistic function was selected to model this relationship, as its shape was deemed most appropriate to represent the change in $C_p$ with trajectory angle. This choice reflects the observed slow increase in $C_p$ at near vertical trajectory angles. The logistic function also captures the non-linear increase at more horizontal trajectory angles, where snowflakes encounter more canopy area in the middle and lower section of individual trees. Additionally, the function effectively represents the gradual levelling off of $C_p$ as it approaches full coverage (value of one). 

Simulated $C_p$ using @eq-lca-ac is shown in the dashed lines in the top row of @fig-lca-ht-ws and follows closely to the VoxRS measured mean $C_p$. Model error statistics shown in @tbl-lca-mod-err demonstrate that @eq-lca-ac performed well, with a mean bias and RMSE of 0.001 and 0.0054 respectively for PWL, and -0.0004 and 0.0079 for FT. In contrast, @tbl-lca-mod-err reveals that the @Hedstrom1998a method produced significantly less accurate estimates of $C_p$, with a mean bias and RMSE of -0.201 and 0.233 respectively for PWL, and -0.260 and 0.324 for FT.

<!-- These figures are generated under the lidar-processing project using scripts 11-13. This generates 100's of GB of data on RAM and therefore scripts 11 and 12 are run on copernicus and the resulting df is sent over to local to run script 13. Can run this locally if we use a larger step across phi and theta angles.  -->


```{r tbl-lca-mod-err, echo=FALSE}
#| label: tbl-lca-mod-err
#| tbl-cap: "Model error statistics calculated for the prediction of leaf contact area from trajectory angle using @eq-lca-inc (nls), using a linear function from the observations in this study (lm), and Equation 10 from @Hedstrom1998a. Mean bias is the difference in the model and observed values, MAE is the mean of the absolute error, RMS Error is the root mean squared error and r^2 is the coefficient of determination."

mod_error <- readRDS('../../analysis/lidar-processing/data/models/lca_obs_mod_error_tbl.rds')

mod_error |> 
  rename(`R^2` = `r^2`) |> 
  knitr::kable()
  # knitr::kable(booktabs = TRUE,
  #              format = 'latex')
```

## Throughfall Model Performance

```{r, include=FALSE}
vb_plot_scale_err <- readRDS('figs/lidar_periods/23_072_23_073_plot_scale_vb_model_error.rds') |> 
  select(plot,
         val_name = name,
         mod_type,
         obs_val = `UAV-lidar`,
         mod_val = mod_vals,
         `Mean Bias` = bias,
         # MAE,
         `Perc. Error`)

pwl_vb_tf_mod <- vb_plot_scale_err$mod_val[vb_plot_scale_err$plot == 'PWL' & vb_plot_scale_err$mod_type == 'VB' & vb_plot_scale_err$val_name == 'tf'] |> round(1)
ft_vb_tf_mod <- vb_plot_scale_err$mod_val[vb_plot_scale_err$plot == 'FT' & vb_plot_scale_err$mod_type == 'VB' & vb_plot_scale_err$val_name == 'tf'] |> round(1)
pwl_vb_tf_obs <- vb_plot_scale_err$obs_val[vb_plot_scale_err$plot == 'PWL' & vb_plot_scale_err$mod_type == 'VB' & vb_plot_scale_err$val_name == 'tf'] |> round(1)
ft_vb_tf_obs <- vb_plot_scale_err$obs_val[vb_plot_scale_err$plot == 'FT' & vb_plot_scale_err$mod_type == 'VB' & vb_plot_scale_err$val_name == 'tf'] |> round(1)
```

The performance of @eq-lca-ip in estimating throughfall ($\Delta SWE_{tf} = (1-\frac{I}{P}) \cdot \Delta SWE_o$) was assessed at the plot scale for both FT and PWL. Hydrometeor terminal velocity measured at PWL station, wind speed measured at FT station, and $\Delta SWE_o$ measured at PWL station were used as inputs for this model. The constants required for this model were used from those derived in the previous section, including $C_c$ from UAV-lidar averaged over each forest plot, an $\alpha$ value of 1 was chosen based on the close alignment of interception efficiency and $C_c$ to the 1:1 line in @fig-lca-vs-ip, height of wind within the canopy of 1.3 m, and the constants listed below @eq-lca-inc. 

Predicted values of observed and modelled interception efficiency and $\Delta SWE_{tf}$ are shown in @tbl-vb-plot-err along with corresponding error statistics. @fig-event-tf shows both the vector based (VB) method, computed using @eq-lca-ip with $C_p$ adjusted for estimated hydrometeor trajectory angle, closely matches UAV-lidar measurements of throughfall with $\Delta SWE_{tf}$ estimates of `r pwl_vb_tf_mod` kg m^-2^ and `r ft_vb_tf_mod` kg m^-2^, compared to observed $\Delta SWE_{tf}$ of `r pwl_vb_tf_obs` kg m^-2^ and `r ft_vb_tf_obs` kg m^-2^ for the PWL and FT plots respectively. @tbl-vb-plot-err shows the VB model has a very low absolute percent error compared to the Nadir model for PWL however for FT there is only slight improvement. However, for both forest plots VB modelled throughfall is less than the UAV-lidar observations resulting in a positive bias. This positive bias was expected as the UAV-lidar measurements of throughfall are inherently underestimates since they include some amount of unloading and redistribution. Therefore, if measurements of throughfall without unloading and redistribution could have been collected it is expected the VB-model would have further reduced error compared to the Nadir model for both FT and PWL. The overall improved performance of the VB model at PWL compared to FT, shown in @tbl-vb-plot-err may be attributed to more of the PWL forest plot being influenced by the shifted hydrometeor trajectory due to the relatively smaller gaps in the canopy compared to the FT plot. 

![Bar chart comparing the observed and modelled mean change in throughfall (𝚫 SWE, kg m⁻²) over the March 13-14 snowfall event averaged over forest plots FT and PWL. The 'nadir' data type used @eq-lca-ip but was not adjusted for trajectory angle and thus $C_c$ was used instead of $C_p$, 'obs' corresponds to the UAV-lidar measured change in throughfall, and 'VB' is the change in throughfall predicted from the vector based (VB) model which uses @eq-lca-ip with $C_p$ adjusted for trajectory angle. The black horizontal dashed line shows the accumulated SWE (kg m⁻²) over the snowfall event to the PWL station open clearing.](figs/lidar_periods/23_072_23_073_event_throughfall_totals_obs_vs_vb_vs_nadir.png){#fig-event-tf}

```{r tbl-vb-plot-err, echo=FALSE}
#| label: tbl-vb-plot-err
#| tbl-cap: "Model error statistics for model estimates of snow interception efficiency (ip) and throughfall (tf) compared to measurements of ip and tf using UAV-lidar averaged over the FT and PWL forest plots. Units for ip and tf are (-) and (kg m⁻²) respectively. The 'mod_type' column refers to the method used to estimate ip and tf. The vector based (VB) method utilized @eq-lca-ip with $C_p$ adjusted for trajectory angle. The nadir method also utilized @eq-lca-ip but was not adjusted for trajectory angle and thus $C_c$ was used inplace of $C_p$. The obs_val column contains measurements from UAV-lidar while the mod_val column contains values from the respective mod_type method. The Mean Bias was calculated as observed minus modelled and Perc. Error is the percent error between predicted and observed values."

vb_plot_scale_err  |> knitr::kable(digits = 2)
```

# Discussion

At the point scale, relatively little influence of air temperature on interception efficiency was found in the observations collected from this discontinuous subalpine forest and deviate from the relationships outlined in @Hedstrom1998a and @Storck2002 which suggested either a positive [@Storck2002] or negative [@Hedstrom1998a] association of air temperature with the canopy snow storage capacity (see fig. X @Cebulski2024b). An increase in interception efficiency was observed at two SCLs, which were sheltered to the predominant wind direction with increasing wind speeds and is attributed to an associated increase in the $C_p$ [@fig-lai-met-ip, C & D]. The slight sensitivity of canopy snow loads on interception efficiency is attributed to the position of the SCLs within forest gaps and the influence of canopy snow load on $C_p$. Timelapse imagery showed that branches surrounding the SCLs compressed at snow loads above 7 kg m^-2^ reducing $C_p$ above the instruments. While this effect was observed to be small in @fig-lai-met-ip, it is similar to the theory proposed by @Satterlund1967 that interception efficiency increases as the canopy fills with snow bridging gaps in the canopy, while later declining due to branch bending and decreased canopy coverage. @Hedstrom1998a and @Storck2002 did not observe this initial increase, but are consistent in declining interception efficiency at high snow loads. The observations presented in @fig-lai-met-ip, differ from the @Satterlund1967, @Hedstrom1998a, @Storck2002 and @Moeser2015 theories, in that the decline in interception efficiency at high canopy snow loads was at a rate much slower than has been observed by these studies and did not show evidence of reaching a clear canopy snow storage capacity (see Figure 6 in @Cebulski2024b). Although higher rates of canopy snow unloading were associated with high canopy snow loads in our observations by the SCLs, removing these periods in the calculation of interception efficiency prevented the observation of a maximum canopy snow storage capacity. 

The strong exponential decline in interception efficiency observed with increasing event snowfall in @Satterlund1967, @Hedstrom1998a, @Storck2002 and @Moeser2015 may be a result of increased unloading rates as branches compress with heavy snow loads. The longer duration between site visits in [@Satterlund1967; @Hedstrom1998a; @Moeser2015] increase the likelihood of canopy snow ablation in their throughfall measurements compared to the automated measurements in this study. This potential inclusion of canopy snow ablation within the interception parameterizations provided in [@Hedstrom1998a; @Satterlund1967; @Moeser2015; @Storck2002] may lead to double counting of unloading when combined with an additional unloading parameterizations in models that are not calibrated to account for this. @Lundquist2021 reported improved simulation of subcanopy snow accumulation without the use of a maximum canopy snow storage capacity when combined with ablation process representations for canopy snow melt, sublimation, wind-induced unloading and temperature induced unloading. However, @Lehtonen2016 note that in northern Finland heavy canopy snow loads have been observed to continue increasing until stem breakage, under conditions favourable for the formation of significant rime-ice accretion and limited ablation. While further research is required to understand the canopy snow load required to cause stem breakage across different tree species, additional research on canopy snow ablation processes could better represent the decline in interception efficiency with increasing canopy snow loads that has been observed by @Satterlund1967, @Schmidt1990, @Hedstrom1998a and @Moeser2015. 

Empirical evidence to support the theory of increased in canopy contact area with increased wind speed suggested by @Hedstrom1998a has not been provided in the literature. Measurements of interception efficiency and canopy structure collected in this study corroborated with the @Hedstrom1998a theory and showed a large fraction of snow intercepted on the lee side of individual trees as shown in @fig-lidar-tf-ip due to predominately non-vertical hydrometeor trajectory angles which increased $C_p$. It was found that the hydrometeor trajectory angle over the March 13-14th snowfall event could be predicted by using the observed hydrometeor fall velocity and a horizontal wind speed selected at one-third of the mean canopy height above the ground. A wind speed of one-third the mean canopy height is thought to be important for canopy snow accumulation as a large fraction of the horizontal cross sectional area is at this height, while high enough in the wind profile to have sufficient wind speed to have a non-vertical trajectory angles. While a wind speed selected at a height higher within the canopy may have a higher speed and thus more horizontal trajectory angle, less canopy elements at this height would be available for contacting incoming hydrometeors. @Katsushima2023, also proposed the wind speed at one-third the canopy height for for modelling unloading of canopy snow as it corresponds to the centre of gravity when the horizontal projection of the canopy is assumed to be a triangle. However, there is uncertainty in the transferability of one-third canopy height observed here to other environments due to differing tree structures, and species such as those with a larger trunk space or have more of their canopy contact area at higher heights above the ground (i.e., some deciduous canopies). Moreover, @eq-ta assumes a linear hydrometeor trajectory, and does not consider non-linear patterns such as wind flow wrapping around tree elements, turbulent flow, or differences in wind speed with height.  Future use of @eq-ta could utilize wind speed selected at one-third if the forest species and size is similar to those investigated in this study, while more different species such a and taller canopies require future research. Wind speed and direction were shown to be important factors influencing the portion of the hemisphere that governed snow accumulation [@fig-hemi-ip-cc]. As a result of these directional and site specific differences in canopy structure there is significant scatter in the 0.25 m horizontal grid resolution illustrated by the high standard deviation in @fig-lca-ht-ws. This large scatter suggests the observed relationships in @fig-lca-ht-ws are only applicable at the forest stand scale where the sub metre variability $C_p$ begin to average out. At this scale, @eq-lca-inc, which uses trajectory angle alone, could be sufficient to determine $C_{inc}$ and thus $C_p$.

This study, in agreement with previous research [@Calder1990; @Lundquist2021], did not observe an association between canopy snow load and interception efficiency. These findings challenge the theoretical basis of the existing snow interception parameterizations [@Hedstrom1998a; @Storck2002; @Satterlund1967; @Moeser2015], and suggest these models may need revision. To address this a new snow interception parameterization, @eq-lca-ip, is presented which calculates interception efficiency as a function of $C_p$ and $\alpha$. This new parameterization allows for canopy snow loading processes to be isolated from canopy snow ablation processes following suggestions in @Cebulski2024b to be more consistent with the rainfall interception literature [@Valante1997]. @eq-lca-ip differs only slightly from the original @Hedstrom1998a parameterization (see Equation 6 in @Hedstrom1998a), in that it does not calculate interception efficiency as a function of canopy snow load and from the @Storck2002 parameterization who found interception efficiency to be a constant. The theoretical basis of the $\alpha$ value in @eq-lca-ip is that the association between $C_p$ and interception efficiency, as shown in @fig-lca-vs-ip, does not follow a 1:1 line as snow flakes may bounce off the canopy elements. Some minor redistribution of snow during between UAV-lidar scans may have lowered the $a$ value observed in this study and in reality may be slightly higher if considering measurements of interception efficiency without unloading. Although, no relationship was found between interception efficiency and air temperature in this study [@fig-lai-met-ip], @Lundquist2021 discuss that the cohesion and adhesion of individual snowflakes to canopy elements is a function of air temperature and may influence the $a$ value. This new snow interception parameterization, is also consistent with @Lundquist2021 who showed success using a constant interception efficiency value for a point location. However, since $C_c$ is a canopy metric typically available across the globe, @eq-lca-ip, when combined with @eq-lca-ac and @eq-lca-inc, provides a way to determine interception efficiency spatially across the landscape. Estimates of $\theta_h$, are required in order to use @eq-lca-inc, which depends on wind speed and hydrometeor velocity as shown in @eq-ta. @fig-ws-ta shows $\theta_h$ exhibits relatively little sensitivity depending on hydrometeor terminal fall velocity compared to the significant change in $\theta_h$ with height height above the snowpack as shown in @fig-wind-profiles. Thus choosing an appropriate height of wind speed has important implications in correctly determining the trajectory angle during snowfall and also determining interception efficiency. Determining the hydrometeor velocity is another potential source of uncertainty when using the @eq-ta equation, however due to the low sensitivity and relatively low range in physically possible values [e.g., @Theriault2021] and could be approximated by common values in the literature.

The new snow interception routine proposed here is similar to the rainfall interception literature, which calculate throughfall as a function of $C_c$ [i.e., @Valante1997]. However, in @Valante1997, rainfall interception is assumed to be completely efficient (i.e., $\alpha$ = 1). Moreover, the use of $C_c$ in @Valante1997 to calculate rainfall interception is not adjusted for hydrometeor trajectory angle. While the higher terminal fall velocity of rainfall compared to snow would result in a smaller sensitivity of $\theta_h$ to wind speed for rainfall [@fig-ws-vs-ta], this still may result in an underestimate of rainfall interception [@Herwitz1995; @VanStan2011]. The large sensitivity of $C_p$ to hydrometeor trajectory angle and the associated implications for subcanopy snow accumulation shown in this study, resulting from relatively common wind speeds of 1-2 m s^-1^, suggests that this may be an important process to consider, especially in snow dominated basins.

A substantial increase in plot scale $C_p$ was shown as a result of increasing hydrometeor trajectory angle which led to an increase in the number of contacts with needleleaf canopy elements. Compared to this, the influence of canopy snow load on interception efficiency at the point scale in @fig-lai-met-ip was relatively small. The negligible change in $C_p$ observed at the plot scale from Nadir after a large snowfall event suggests incorporating canopy snow load in interception efficiency parameterizations may not be necessary for this study site. This is interpreted to be due to compensatory effects, where snow load may increase the $C_p$ for vertical zenith angles in grid cells beneath the canopy as snow bridges gaps in the canopy elements. However, branch bending may also lead to a decrease in $C_p$ for grid cells within gaps between the canopy or for non-vertical trajectory angles. @Staines2023, showed a slight increase in $C_p$ between snow-off conditions from a single UAV-lidar scan compared to snow-on conditions derived from a combination of three UAV-lidar scans. The higher forest density in the @Staines2023 study resulted in more of their study area beneath canopy elements, and was not as influenced by branch bending. This may have resulted in a slightly higher influence of snow load on $C_p$ in the @Staines2023 study, compared to negligible effect reported here between the March 13 and 14 UAV-lidar surveys. Still, the increase in $C_p$ resulting from snow load in @Staines2023 was smaller compared to the substantial rise in $C_p$ due to trajectory angle presented here. An existing method proposed in @Hedstrom1998a to scale canopy coverage with wind speed failed to reproduce the observations presented in @fig-lca-ht-ws. A new method is proposed which uses logistic function to calculate $C_{inc}$ as a function of $\theta_h$ and $C_c$. Further work is required to refine the relationship proposed in @eq-lca-inc across a range of tree species and densities, determine how to calculate the canopy snow storage capacity, reassess canopy snow ablation parameterizations of the new snow interception routine. The methodology applied in this study may also be applicable to other research concerned with the transmittance of solar radiation through the canopy and how this differes over zenith angles during different times of day and season and forest structures and tree species. 

Although the performance improvement in the VB model compared to the Nadir model is relatively small, especially for FT, the positive bias of the VB model is preferred due to uncertainties with the throughfall measurements. An overestimate of interception efficiency was expected as the observations of interception efficiency are inherently underestimates due to some unloading and redistribution of snow over the March 13-14 snowfall event. Therefore the VB model, with slightly lower predicted throughfall, would better match observations that included less unloading and redistribution and thus would also have lower observed throughfall compared to the observations presented in @tbl-vb-plot-err. Conversely, the Nadir model which has a stronger negative bias, would result in further overestimates of throughfall if measurements of throughfall without unloading could have been collected. While the VB model acts to increase interception efficiency with wind speed, several studies suggest that canopy snow ablation increases as a result of wind induced unloading [@Wheeler1987; @Roesch2001; @Betts1997; @Bartlett2015; @Lumbrazo2022]. While these studies have been used to develop parameterizations for wind induced unloading, they were not based on direct measurements of canopy snow unloading and further research is required to better refine these relationships to understand how wind influences unloading of canopy snow after it is intercepted. Once the VB model is combined with a wind-induced canopy snow unloading parameterization, the overall influence of wind on canopy snow interception will be balanced to some extent.

# Conclusions

-   New observations of snow interception collected at both high-frequency and fine-scale resolutions provide insights on the applicability of existing theories to this research site.
-   A canopy snow load capacity was not observed for these observations and thus additional observations of canopy snow load for larger snowfall or rime-ice events are required to determine a canopy snow load capacity. 
-   No association of air temperature, relative humidity, hydrometeor velocity, or hydrometeor diameter on interception efficiency was observed from the high-frequency point scale measurements. These measurements also showed interception efficiency increased slightly with wind speed and low-moderate canopy snow loads as a result of increasing the leaf contact area. A slight decline in interception efficiency at higher canopy snow loads was observed at the point scale and was attributed to branch bending reducing the canopy coverage of the instruments. The absence of a strong association between air temperature or canopy snow load with interception efficiency challenges the theoretical foundation of most existing snow interception parameterizations. 
-   At the forest plot scale, UAV-lidar measurements showed leaf contact area is the main factor governing the fraction of intercepted snowfall at a particular site. At this scale the decline in interception efficiency in forest gaps due to branch bending appeared to be balanced by the increase in leaf contact area within the canopy due to increased snow load. Snow accumulation and canopy structure metrics from a wind-driven snowfall event revealed canopy structure metrics adjusted for trajectory angle provided an improved predictor of interception efficiency compared to nadir canopy coverage. 
-   Leaf contact area was observed to double for wind speeds of 1 m s^-1^ in the discontinuous subalpine forest in this study. The effect of wind on leaf contact area can have large implications for the amount of snow intercepted in the canopy. An existing theoretical relationship failed to represent the increase in leaf contact area with wind speed at this site.
-   A new snow interception parameterization has been presented which calculates initial interception, before canopy snow ablation, as a function of snowfall rate and leaf contact area. The formulation of this parameterization as a function of canopy structure is consistent with the rainfall interception literature and other recent observations of snow interception. 
-   A second equation is proposed to estimate the increase in leaf contact area from nadir canopy coverage as a function of hydrometeor trajectory angle. This relationship was shown to follow a relatively similar relationship at two forest plots with differing canopy structure and was represented by a single parameterization. 
-   Good performance of this updated snow interception parameterization was shown in this subalpine forest, but further validation should be conducted in a range of climates, forest species and structures. Caution should be taken in using this updated interception routine with existing canopy snow ablation parameterizations as they were developed using earlier snow interception routines that also included ablative processes. Future work will involve revising canopy snow ablation routines to work with this new snow interception routine.

# Acknowledgments

We wish to acknowledge financial support from the University of Saskatchewan, Natural Sciences and Engineering Research Council of Canada, Global Water Futures Programme, Alberta Innovates and the Canada Research Chairs Programme. We thank Madison Harasyn, Hannah Koslowsky, Kieran Lehan, Lindsey Langs and Fortress Mountain Resort for their help in the field. Madison Harasyn, Alistair Wallace, and Rob White contributed to developing the UAV-lidar processing workflow.

# Data Availability

The authors declare there are no competing interests.

\pagebreak

# References
