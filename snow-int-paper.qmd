---
title: "Combined effects of wind, air temperature and snowfall on snow accumulation in a subalpine forest"
author: "Alex Cebulski & John Pomeroy"
date: today
date-format: long
format: 
  docx:
    reference-doc: ../config/word_template.docx
    number-sections: true
    toc: false
  # pdf
  html:
    toc: false
    self-contained: true
editor: source
bibliography: ../../papers/bibtex/library.bib
csl: '../../papers/bibtex/csl-styles/apa-disable-disambiguate-add-names.csl'
---

```{r, include=FALSE}
library(tidyverse)
library(ggpubr)

knitr::opts_chunk$set(echo = FALSE, message=FALSE, warning=FALSE, fig.align='center')

# source('scripts/00_define_global_attributes.R')
# source('scripts/01_plot_theory_examples.R')
# source('scripts/01_plot_binned_met_trough_IP.R')
# source('scripts/01_plot_forest_snow_survey_IP.R')
# source('scripts/01_plot_snowfall_interception_w_tree.R')
```

# TODO 

hemis and snow int maps to facet ggplots if possible 
talk about rainfall interception work.. 

# Introduction

Forest cover extends over approximately half of North America’s snow-covered region, governing snowpack accumulation and ablation, thereby influencing the timing and magnitude of runoff generation from snowmelt.

Existing the theory behind existing snow interception parameterizations [e.g., @Hedstrom1998a] include ablation of canopy snow and are typically used with a separate unloading parameterization leading to potential double counting of canopy snow ablation. 

This paper is focused on interception before ablation of canopy snow occurs through unloading, drip, melt and sublimation.

-   There is a need for robust models of snow redistribution by vegetation and wind to estimate snow accumulation in mountain forests. To achieve this, a comprehensive understanding of snow redistribution processes is required. However, existing snow interception parameterizations are based on limited observations in distinct climates and forest structures. Rapid changes in climate and forest ecology illustrate the pressing need to assess whether existing snow interception parameterizations are suitable for predicting snow accumulation in diverse and changing environments.

-   Intercepted snow in the canopy is subjected to higher rates of sublimation compared to subcanopy snow due to greater surface area, higher wind speed, and solar exposure [@Pomeroy1998b]. Across the Northern Hemisphere, researchers estimate that 25 to 45% of annual snowfall may be lost to the sublimation of intercepted snow from the canopy [@Essery2003]. Correctly determining the fraction of snowfall intercepted in the canopy is crucial for estimating interception losses by sublimation [@Pomeroy1998b]. In addition, the time that snow resides in the canopy and is subject to sublimation is dependent on rates of unloading, melt, drip, and resuspension of snow [@Hedstrom1998a; @Storck2002; @Katsushima2023; @Lumbrazo2022].

-   The theory underpinning current snow interception parameterizations is based on observations ranging from warm maritime [@Storck2002; @Andreadis2009] and cold continental [@Hedstrom1998a; @Ellis2010; @Roesch2001; @Satterlund1967] climates generally characterized by dense forest canopy. Accurate simulations of forest snow accumulation have been achieved if the parameterizations are applied in similar climates to where they were developed [@Lundquist2021; @Roth2019a; @Rasouli2019b] or if they are combined into a hybrid parameterization and assessed at global and regional scales in a wide range of climates [@Essery2003; @Gelfan2004]. Although accurate performance has been achieved across different climates in some studies [@Essery2004; @Gelfan2004], other snow model comparisons [@Krinner2018; @Rutter2009] have shown reduced performance. The decision in earth system models to use parameterizations derived in warm or cold climates is often based on a simple temperature-based step function [@Essery2003; @Gelfan2004] and may require modification to better represent more transitional climates and forest types. The original theory has also been simplified over time, i.e. the increase in canopy coverage with increasing wind speed is not included in more recent parameterizations [@Clark2015, @Roth2019a]. Updates by @Gelfan2004 to combine the @Hedstrom1998a and @Storck2002 parameterizations is not typically utilized in recent studies [@Krinner2018; @Rutter2009]. The omission or simplified representation of processes and reliance on empirical calibrations likely contribute to model uncertainty when applied in climates and forests where other processes become important [@Rutter2009; @Krinner2018; @Lumbrazo2022; @Roth2019a; @Moeser2015; @Lundquist2021].

-   @Cebulski2024 shows the difference in the change in interception efficiency across different snowfall event sizes for three common models. Interception efficiency (interception/snowfall) declines with increasing snow load [@Hedstrom1998a; @Storck2002] or initially increases and then is followed by a decline [@Moeser2015]. The underlying theory of the @Moeser2015 parameterization stems from the @Satterlund1967 study who observed an initial increase in the rate of intercepted snow, as snowflakes bridge gaps between needles. It may also be inferred that during the small near 0°C snowfall events observed in @Satterlund1967 the majority of snow may have melted immediately due to a warm canopy resulting in low interception efficiency. The initial low interception efficiency was followed by an increase and then flattening off of the interception rate as branches bend due to the weight of snow which @Satterlund1967 represented by a numerical analytical sigmoidal function. In the observations by @Hedstrom1998a, snow interception efficiency starts high and then declines. @Hedstrom1998a suggests this is due to a decrease in canopy contact area and change in the incoming snowfall angle of impact as branches bend downward. The @Hedstrom1998a parameterization therefore differs from the [@Satterlund1967; @Moeser2015] sigmoidal function as it does not include a representation for the initially slow interception rate. @Andreadis2009 developed a snow interception model using data collected by @Storck2002 in dense old growth forest in the maritime climate of southwestern Oregon, USA. This method builds off the maximum canopy snow load theory proposed in @Hedstrom1998a but makes additional modifications to include a step function based on temperature. Here, snow interception efficiency, was found equal to a constant of 0.6 based on snow interception observations from @Storck2002 in southern Oregon.

-   Maximum interception capacity decreases [@Hedstrom1998a] or increases [@Storck2002] with increasing air temperature (see fig. X @Cebulski2024). @Hedstrom1998a proposed that fresh snow density, which may be described as a function of air temperature [@Hedstrom1998a], plays an important role in governing the interception capacity. @Storck2002 limit, $L$ as being less than or equal to the maximum interception storage $L_{max}$ using a step function of temperature based on observations of warmer snow having more cohesion to the canopy.

-   More recent work by @Katsushima2023 collected measurements of snow interception using a weighed tree for a warm-humid coastal environment in Japan. They observed a decline in interception efficiency with increasing wind speed, they attributed to increased hydrometeor velocity and bouncing on impact. While not mentioned in this study, the decrease in interception efficiency may also be due to wind induced unloading. They did not observed a maximum interception capacity within their measurement range of 0-25 mm. Although for temperatures above 0 they could see a decline in interception efficiency above 10 mm maybe due to branch bending + melt rates. @Katsushima2023 suggest air temperature and wind speed alone are insufficient to describe interception efficiency and hypothesize that particle shape may be an improved predictor but did not have the observations to test this. Some of the limited model performance reported by @Katsushima2023 may be attributed to a result of their interception measurements including unloading due to melt and wind.

-   Previous studies have collected measurements of interception efficiency over snowfall events ranging from hourly [@Storck2002] to weekly timesteps [@Hedstrom1998a]. The different measurement time intervals vary in the amount of time possible for ablative processes and may influence model estimates of interception. As a result, some of the interception measurements inevitably include some amount of ablation. Despite the inclusion of unloading in the interception parameterizations developed in these studies, they are often combined with additional unloading parameterization in earth system models [@Ellis2013; @Clark2015] leading to some potential of double counting of the ablation process.

-   Uncertainties also arise in the scaling of point or branch scale measurements to the plot scale [@Staines2023].

-   Forest structure governs the interception efficiency observed at a given location [@Hedstrom1998a; @Roth2019a]. Metrics used in common snow interception parameterizations [@Hedstrom1998a; @Storck2002] to describe forest structure include canopy cover and leaf area index (LAI). Leaf area index is defined by @Chen1997 as one half the total green leaf area per unit ground surface area. Canopy cover is defined in @Hedstrom1998a as the fraction of sky not visible by the instrument from under the canopy. While more detailed forest structure metrics exist derived from detailed LiDAR scans [@Roth2019a; @Helbig2020], often they are not available at regional extents required to run hydrological models.

- Add sentence on @Staines2023.

-   Several processes govern the accumulation of snow in mountain forests, and the importance of individual processes may differ depending on climate and forest structure [@Hedstrom1998a; @Gelfan2004; @Moeser2015; @Staines2023]. Therefore determining the dominant processes in varying climate and forests structures is important to guide model decision makers on what existing model parameterizations to choose or if a hybrid approach may be appropriate.

-   New observations of snow interception and ablation processes will help determine if existing theories are applicable in differing climates and diverse forest structures.

-   The novelty of this study is the study site location in a windswept discontinuous subalpine ridge forest and the use of high temporal frequency automated measurements and discrete high spatial resolution measurements using aerial LiDAR to attempt to separate out interception from ablative processes. Timelapse cameras were also used to confirm absence of unloading during interception periods.

-   Exisiting theory relies on the green smear approach or using LAI + CC which does not appropriately describe the heterogeneity of discontinuous canopies

Objective: To assess the influence of canopy structure and meteorology on snow interception processes in a windswept subalpine forest.

Research Questions:

1.  Are the theories and assumptions of existing snow interception parameterizations true for field measurements collected in a continental subalpine forest?
2.  What are the dominant processes that control snow interception in a subalpine forest?

Specific Questions

- Is meteorology important for governing I/P?

- How does hydrometeor trajectory angle influence apparent canopy structure?

- How does the association between canopy structure and I/P vary across the hemisphere for an event with moderate wind speed?

- is this association stronger when there is snow in the canopy i.e., branches have been bridged or reduced due to branch bending? 

# Theory

The trajectory angle, $\theta_h$ of a hydrometeor as the departure in degrees (°) from a vertical plane (i.e., 0° for vertical snowfall), may be calculated as:

$$
\theta_h = \arctan \left(\frac{x_h(u_z)}{v_h(D_h)}\right)*\frac{180}{\pi}
$${#eq-ta}

where $v_h$ is the terminal fall velocity of the hydrometeor (m s^-1^), which is a function of the hydrometeor diameter, $D_h$ and $x_h$ is the horizontal change in the hydrometeor (m s^-1^) which is a function within canopy wind speed, $u_z$ at height above ground, $z$. 

Above the top of the canopy, wind flow is approximately logarithmic with height. @Cionco1965 show that, $u_z$ may be approximated using the exponential formula:

$$
u_z = u(u^*,z,z_o,d)\cdot exp\left[a\cdot\left(\frac{z_c}{h_c}-1\right)\right]
$${#eq-uz}

where $u$ is the horizontal wind speed at the top of the canopy which is a function of the friction velocity $u^*$, height above ground, $z$, roughness length, $z_o$, and the displacement height of the canopy, $d$. $a$ is an attenuation coefficient that increases with increasing leaf area and decreases as the mean distance between individual trees increases, $z_c$ is the height above ground of $u_z$, and $h_c$ is the average height of the canopy elements. @Cionco1972 suggest values for $a$ of 1.01 for small needleleaf trees, @Zhu2001 provide methods to calculated $a$ based on canopy density and @Parviainen2000 provide a method to calculate $a$ using observations from two jack pine (*Pinus banksiana*) stands. @fig-ws-vs-ta shows the increase in trajectory angle calculated using @eq-ta with a constant hydrometeor velocity of 1 m s^-1^ and a horizontal velocity equal to mid-canopy wind speeds ranging from 0-20 m s^-1^. 

![The theoretical relationship of hydrometeor trajectory angle (departure from horizontal plane) with increasing horizontal velocity speed for three different fall velocities shown by the colour of each line. Fall velocity which is also a function of hydrometeor diameter but typically ranges from velocities 0.5 m/s for dry snow to 1.5 m/s for wet/well-rimed snow.](figs/examples/wind_speed_vs_traj_angle.png){#fig-ws-vs-ta width="400"}

# Methods

## Study Site

This study was conducted between October 2021 to July 2023 at forest plots surrounding the Powerline Station (PWL) and Forest Tower Station (FT) located within Fortress Mountain Research Basin (FMRB), AB ~ 51 ◦ N, 2100 m asl. (@fig-maps). The average annual precipitation at PWL Station from 2013 to 2023 is 1045 mm, with the peak annual snow water equivalent (SWE) reaching 465 mm, typically occuring in late April. The species of tree surrounding the PWL and FT stations include sparsely spaced coexisting subalpine fir (Abies lasiocarpa) and Engelmann spruce (Picea engelmannii), with a proportion of 70% and 30% respectively [@Langs2020]. In the early 1900s the majority of the FMRB vegetation burned during a large forest fire that affected most of the Kananaskis Valley. Following the fire, the forest surrounding the PWL and FT stations has naturally regenerated with minimal disturbance.

## Meterological Measurements

A flux tower at the FT Station provided measurements of air temperature (Campbell Scientific HMP155A), relative humidity (Campbell Scientific HMP155A), wind speed (Campbell Scientific Ultrasonic-86000 & Metone 014A) and direction (Campbell Scientific Ultrasonic-86000) at 15-min time intervals 4.3 m above the ground (@fig-map-site). The PWL station, located 120 m to the northwest in a forest clearing shown in @fig-map-site provided measurements of snowfall rate ($q_{sf}$), additional wind speed measurements and hydrometeor size and velocity. Snowfall was measured using a weighing precipitation gauge 2.6 m above ground (OTT Pluvio) corrected for undercatch following phase correction by @Harder2013 and catch efficiency by @Macdonald2007a. A Metone 014A anemometer provided wind speed measurements at a height of 2.6 m, while the RM Young anemometer recorded wind speed and wind direction at a height of 5.2 m. A disdrometor (OTT Parsivel2) provided measurements of hydrometeor particle size and velocity. 

::: {#fig-maps layout-nrow="2"}
![](figs/maps/site_map_bc_ab_scale.png){#fig-map-big}

![](figs/maps/site_map.png){#fig-map-site}

Regional map showing location of Fortress Mountain (a) and map of forest plots, flux towers, and survey transects (b) in this study.
:::

## Lysimeter Data

Three subcanopy lysimeters (SCL) installed surrounding the FT Station provided fifteen minute interval measurements of throughfall and unloading (see locations in @fig-map-site). For select time periods where ablative processes including, unloading, drip and wind redistribution could be considered negligible, the subcanopy lysimeters were inferred to provide measurements of throughfall. Interception efficiency was calculated using @eq-ip, throughfall from the SCLs and $q_{sf}$ from the PWL snowfall gauge. For each of the 26 snowfall events the average interception efficiency over each event was calculated for each 15-minute timestep within the 26 snowfall events. Timelapse imagery, a weighed tree and in-situ observations were used to ensure ablation of snow intercepted in the canopy or snow on the ground was minimal over each of the selected events. The SCLs consisted of a plastic bucket with an opening of 0.9 m ^2^ and depth of 20 cm (e.g., @fig-scl-2) suspended from a load cell (Intertechnology 9363-D3-75-20T1) attached to an aluminum pipe connected between two trees. The load cell which measures kilograms was scaled to kg m^-2^ by dividing by the cross-sectional area of the SCL opening. The canopy structure surrounding three SCLs and was measured using hemispherical photography (Nikon Coolpix 4500 and EC-F8 hemispherical lens) and the hemispheR R package @Chianucci2023 and is shown in @tbl-scl-lai-cc. 

```{r scl, echo=FALSE}
#| label: tbl-scl-lai-cc
#| tbl-cap: "Canopy structure of the three subcanopy lysimeters (SCL) located proximal to the FT Station. Leaf area index (LAI) and Canopy Coverage was measured using hemispherical photo analysis with the R package hemispheR."
#| 
scl_lai_cc <- read.csv('~/local-usask/analysis/interception/data/lai/scl_canopy_metrics.csv') 

scl_lai_cc$Name <- c('SCL Med', 'SCL Low', 'SCL High')

scl_meta <- read.csv('~/local-usask/analysis/interception/data/loadcell/calibrations/load_cell_meta_ac_fortress.csv')

scl_lai_cc |> 
  arrange(cc) |> 
  mutate(cc = round(cc, 2)) |> 
  select(Name, `LAI (-)` = Le, `Canopy Coverage (-)` = cc) |> 
  knitr::kable(booktabs = TRUE,
               format = 'latex')
```

A weighed tree lysimeter, shown in @fig-w-tree-loaded and @fig-w-tree-bare, measured the weight of canopy snow load, $L_{wt}$ (kg). A live subalpine fir (Abies lasiocarpa) tree was cut and suspended from a load cell (Artech S-Type 20210-100) at the beginning of the 2022 and 2023 water years which recorded the weight of the tree. The bottom of the tree was sealed to limit some transpiration and to prevent spinning and abrupt impacts of the free-hanging tree, the base of the tree was attached to a support system that allows for vertical movement but limits abrupt horizontal movements. The weight of snow in the weighed tree in kg was scaled to an areal estimate of canopy snow load ($L$, kg m^-2^) using measurements of areal throughfall (kg m^-2^) from manual snow surveys and snowfall from the PWL Station snowfall gauge [see description of method in @Hedstrom1998a].

## UAV Data Processing

Two uncrewed aerial vehicle (UAV) lidar surveys were conducted before and after a 24 hour snowfall event that occurred between March 13th and March 14th, 2023. These surveys were undertaken to facilitate the measurement of snow accumulation and canopy structure metrics. The UAV (FreeFly Alta X) was equipped with a REIGL miniVUX-2 airborne laser scanner payload, an Applanix APX-20 inertial measurement unit (IMU) and global navigation satellite system (GNSS). The UAV was flown 90 m above the ground at a speed of 3 m s^-1^ following a preprogrammed flight trajectory shown in @fig-map-site. 

The REIGL miniVUX-2 laser operates at a near infrared wavelength with a laser beam footprint of 0.160 m x 0.05 mm (at 100 m above ground). The accuracy and precision of the miniVUX-2 is described by REIGL for a lab environment of 0.015 m and 0.01 m respectively (at 50 m above ground). The miniVUX-2 was configured with a laser pulse repetition rate of 200 kHz, field of view of 360°, scan speed of 31.09 revolutions s^-1^ and an angular step width of 0.0558°, resulting in an expected an average point cloud density of 107 returns m^-2^ for each flight path.

Georeferenced point clouds with x, y, and z coordinates for each laser return were generated following methods outlined by @Harder2020 and @Staines2023 to reconcile survey lidar, IMU and GNSS data. A ground based GNSS system was positioned on a permanent monument during each survey and underwent precise point positioning (PPP) correction by @ppp2024. Differential GNSS correction of the UAV trajectory was conducted using the ground based PPP GNSS observations and the POSPac UAV software. The UAV-lidar point clouds were then transformed from a sensor referenced coordinate system to a georeferenced coordinate system (EPSG:32611 - WGS 84 / UTM zone 11N) using the RIEGL Riprocess Software. A consistent vertical offset of up to 6 cm between UAV-lidar flight lines was observed in the resulting point clouds on March 13th and 14th, 2024 and was attributed to IMU drift. This offset between flight lines was corrected using the BayesStripAlign software v2.24 [@BayesMap2024], which reduces relative and absolute uncertainties in the vertical elevation of the point cloud using the ground control points (GCP) collected across the study site using a differential GNSS rover. After strip alignment, the mean elevation bias (lidar minus GCP) was 0.000 m and the RMS error changed from 0.055 m to 0.038 m March 13^th^ and changed from 0.033 m to 0.029 m on March 14^th^. The point cloud density ranged from ~1200 returns m^2^ in open clearings to ~2200 m^2^ in sparse forest for both the March 13 and 14th surveys after all flight paths were combined. 

Quality control, ground classification and calculation of the change in between two UAV-lidar point clouds was conducted using the LAStools software package [@LAStools2024]. The ground classification was conducted using the "lasground_new" function [@LAStools2024] for both the pre and post snowfall event point clouds, with a step size set to 2 m and 8 substeps (ultra_fine setting). The offset and spike options were set to remove points that are more than 0.1 m above or below the initial ground surface estimate surface which "lasground_new" fits to the last returns. This function is based on an algorithm outlined by @Axelsson2000, describing the process of making the initial ground surface element.

## Snow Surveys

### In-situ Snow Depth and Density

```{r, include=FALSE}
lai_measurements <- read.csv('../../analysis/interception/data/lai/results/2023_compiled_lai_vza_15_60.csv')  |>
  filter(vza == 60) 

cc_range <- paste(round(min(lai_measurements$cc), 2), '–', round(max(lai_measurements$cc), 2))
lai_range <- paste(round(min(lai_measurements$Le), 2), '–', round(max(lai_measurements$Le), 2))
```

In-situ snow surveys provided measurements of subcanopy throughfall following the transects shown in @fig-map-site. These throughfall measurements were used to scale the weighed tree, for accuracy assessment of the UAV-lidar fresh snow depth measurements, and to provide a fresh snow density for the calculation of SWE (kg m^-2^) from UAV-lidar depth measurements. Differential GNSS rover coordinates were taken at each snow sampling location so the locations could be queried later from the UAV-lidar rasters. If a pre event crust layer was present the depth of post event fresh snow accumulation above the crust layer were interpreted as throughfall over the event. In the absence of a defined crust layer, the difference in pre and post event snow depth to ground was interpreted as event throughfall. A 1000 cm^3^ snow density wedge sampler (RIP Cutter, https://snowmetrics.com/shop/rip-1-cutter-1000-cc/) was used to measure the density of the fresh snow layer, $\overline{\rho_{tf}}$ (kg m^-3^). The throughfall depth measurements, $\Delta HS$ were converted to snow water equivalent (SWE) using the following equation:

$$
\Delta SWE_{tf} = \Delta HS \cdot \overline{\rho_{tf}}
$${#eq-swe-tf}

### UAV-Lidar Snow Depth

The change in elevation between the two UAV-lidar surveys was interpreted as the increase in snow accumulation, $\Delta HS$ over the snowfall event. This change was calculated using a point-to-grid subtraction method, similar to the approach used by @Deems2013 and @Staines2023, using the "lasheight" function from the @LAStools2024 software. The pre snowfall event point cloud from "lasground_new" by "lasheight" to construct a "ground" TIN. Subsequently, the height of each post snowfall event point above the ground TIN, resulting in a point cloud representing $\Delta HS$. This point cloud was then converted into a raster of $\Delta HS$ with a grid cell resolution of 5 x 5 cm using the "las2dem" function. Further quality control and resampling of the 5 cm raster of $\Delta HS$ was conducted using the R package Terra @Hijmans2024. Regions that were disturbed over the snowfall event during the in-situ snow survey and values that exceeded the .999th quantile were removed. To help remove any remaining noise a 25 cm $\Delta HS$ raster was generated by computing the median of the 5 cm $\Delta HS$ values within each 25 cm grid cell.

## Snow Interception

During calm snowfall periods, where ablative processes could be assumed negligible, the amount of snow intercepted in the canopy was estimated as:

$$
\frac{dL}{dt} = q_{sf}-q_{tf}(L)
$$ {#eq-dwdt-ode}

This method was preferred, compared to direct measurements from the weighed tree lysimeter, as the subcanopy lysimeters were not influenced by sublimation losses from snow intercepted in the canopy.

Over a discrete time interval, $\Delta t$, the change in canopy snow load, $\Delta L$ (kg m^-2^) was calculated as:

$$
\frac{\Delta L}{\Delta t} = \overline{q_{sf}}-\overline{q_{tf}(L)} = \Delta SWE_o - \Delta SWE_{tf}
$${#eq-dwdt-discrete}

where $\overline{q_{sf}}$ and $\overline{q_{tf}(L)}$ are the average snowfall and throughfall rate over $\Delta t$. $\Delta SWE_o$ is the change in SWE to the open (kg m^-2^).

Interception efficiency, $\frac{I}{P}$ (-), which is the fraction of snow intercepted over $\Delta t$ was calculated as:

$$
\frac{I}{P} = \frac{\Delta L}{\overline{q_{sf}} \Delta t} 
$$ {#eq-ip}

where $\Delta L$ (mm) is the increase in canopy load over a discrete time interval and $\overline{q_{sf}}$ (mm), is the average snowfall rate over $\Delta t$.

::: {#fig-insts layout-ncol="3"}
![](figs/site-photos/sub-canopy-lys-1.jpg){#fig-scl-2}

![](figs/site-photos/jan_7_hanging_tree.jpg){#fig-w-tree-loaded}

![](figs/site-photos/IMG_9400_w_tree_bare.jpg){#fig-w-tree-bare}

Subcanopy lysimeter (a), weighed tree lysimeter loaded with snow (b) and weighed tree lysimeter bare of snow (c).
:::

## UAV-Lidar Canopy Metrics

UAV-lidar point cloud and trajectory data collected on MArch 13 and 14, 2024 were utilized to characterise the canopy structure of the study site. To facilitate this, the voxel ray sampling (VoxRS, https://github.com/jstaines/VoxRS) of lidar methodology outlined by @Staines2023 was used. This method aims to provide canopy metrics in a way that is insensitive to nonuniform lidar sampling arising from beam occlusion in vegetation (reduced points near the ground). The canopy products produced from VoxRS here include: canopy contact number, the mean theoretical number of canopy contacts for a given ray, and radiation transmittance ($\tau$) all with units (-). See supporting information in @Staines2023 for details on how these metrics are computed. The maximum plan area of the snow-leaf contact per unit area of ground used in @Hedstrom1998a, and hearafter called leaf contact area ($C_p$), was calculated as:

$$
C_p(C_c, \theta_h) = 1-\tau
$${#eq-lca}

$$
C_p(C_c, \theta_h) = \begin{cases}
    1-\tau,& \text{if } \theta_h> 0°\\
    1-\tau \approx C_c ,              & \theta_h= 0°
\end{cases}
$${#eq-tf-ode}

where $C_p$ is a function of the canopy coverage $C_c$ and $\theta_h$. $C_p$ is approximately equal to canopy coverage ($C_c$) for vertical snowfall. However, for non-vertical snowfall $1 > C_p > C_c$.

To determine how forest structure was associated with interception efficiency at different azimuth and zenith angles over the March 13-14 snowfall event, each portion of the hemisphere at each grid location was considered. The relationship between I/P and canopy contact number was found to be linear and thus the Pearson Correlation Coefficient, $\rho_p$ was calculated to quantify the association between a single raster of I/P and 32'760 rasters containing the canopy contact number hemisphere for each portion of the hemisphere (azimuth [0, 1, ..., 359], zenith angle [0, 1, ..., 90]). 

# Results

## The influence of meteorology on snow interception

The meteorology, state of canopy snow load, and interception efficiency was measured for 26 distinct snowfall events. The histograms presented in @fig-hist-met-ip, portray the frequency distribution of 15-minute measurements of air temperature, relative humidity and wind speed from the FT Station, snowfall rate from PWL Station, and interception measurements calculated using SCL 1-3 and snowfall gauge at PWL Station during all periods of snowfall during the 26 snowfall events (See station locations in @fig-map-site). The average interception efficiency observed across all periods of snowfall was 0.64 and ranged from 0 to 1. The air temperatures spanned from -25°C to 1°C, with a predominant concentration of observations within the -10°C to 0°C range. Corresponding wind speed values ranged from 0 to 4.5 m s^-1^ with a mean of 1.2 m s^-1^. 

The state of canopy storage with event cumulative snowfall calculated from SCL 1-3 and snowfall gauge, is shown in @fig-scl-w-sf for each of the 26 snowfall events. Canopy storage was observed to increase linearly with increasing snowfall without evidence of reaching a maximum canopy storage capacity. Variation in the slope of each line in @fig-scl-w-sf, is attributed to differences in the canopy structure surrounding the SCL instruments, differences in meteorology and antecedent canopy snow load between the individual events. The SCL with higher canopy coverage was expected to have consistently higher canopy storage values. However, as depicted in @fig-scl-w-sf the largest event cumulative snowfall of ~ 50 mm, shows the lysimeter with the highest canopy coverage (0.82) exhibited a canopy storage value slightly less than the lysimeter with canopy coverage of 0.78. This difference between the subcanopy lysimeters, which is inconsistent with their individual forest structure, is likely result of event wind speed and the direction which could alter the apparent forest structure of each lysimeter location. In addition, the initial canopy snow load may have been different between the locations. The absence of canopy storage and interception efficiency measurements for certain troughs during specific events was caused by damage to the subcanopy lysimeter wiring due to animal interference and snow load.

The average interception efficiency for SCL 1-3, across all 26 events, is shown in @fig-scl-ip to increase proportionally with the canopy coverage of each lysimeter. However, looking at the individual events, interception efficiency observed at each lysimeter does not always align with the respective canopy coverage value as was also shown in @fig-scl-w-sf. This suggests additional processes other than canopy structure are influencing subcanopy snow accumulation. For events with snowfall totals ranging from 0 to 5 mm, the average interception efficiency was 0.58. This increased to an average interception efficiency of 0.60 for events with snowfall totals between 5 and 10 mm, then decreased back to 0.58 for events with snowfall totals between 20 and 25 mm.

The average interception efficiency was also calculated over each 15-minute interval within each of the 26 snowfall events and was utilized to assess the association with meteorological variables, the state of canopy snow load and hydrometeor characteristics for the corresponding time interval. Air temperature and relative humidity observed at FT Station was observed to have little influence over interception efficiency measured using the SCL and snowfall gauge (@fig-lai-met-ip, A & B). Mid canopy wind speed at FT Station was observed to increase the mean interception efficiency slightly from 0.56 to 0.62 between wind speed bins of 0.25 and 1.25 m s^-1^ (@fig-lai-met-ip, C). This is thought to be due to an associated increase in canopy contact area as hydrometeor trajectory becomes more horizontal with increasing wind speed. The mean interception efficiency decreases wind speeds above 2 m s^-1^ to a minimum of 0.48 for the 3.75 m s^-1^ wind speed bin. The initial canopy snow load had a positive association with interception efficiency as the canopy filled with snow, increasing the mean interception efficiency from 0.57 for snow loads near 0 mm to 0.66 for snow loads around 7 mm. This was followed by a gradual decline in interception efficiency for snow loads greater than 7 mm to a minimum of 0.48 at snow loads above 18 mm (@fig-lai-met-ip, C). Hydrometeor diameter and hydrometeor velocity measured using the disdrometer at PWL Station did not have a strong association with interception efficiency (@fig-lai-met-ip, E & F).

![Histograms of the count (number of occurances) of 15 minute observations of air temperature, canopy load, interception efficiency, relative humidity snowfall rate, and wind speed for all periods of snowfall during the study period. Air temperature, relative humidity and wind speed are from the FT Station at mid-canopy height (7 m). Canopy load and interception efficiency were measured using the subcanopy lysimeter from FT Station and snowfall gauge from PWL Station. Station locations are shown in Figure 1. ](figs/automated_snowfall_event_periods/histogram_met_ip_snowfall_periods.png){#fig-hist-met-ip}

::: {#fig-scl layout-ncol="2"}

![](figs/automated_snowfall_event_periods/cuml_event_snowfall_canopy_storage_sep_scl.png){#fig-scl-w-sf}

![](figs/automated_snowfall_event_periods/event_total_snowfall_vs_IP_colour_troughs.png){#fig-scl-ip}

Two plots showing the relationship between snowfall and interception. Plot (a) shows the cumulative event snowfall versus the corresponding state of canopy snow storage for each of the 26 snowfall events. Plot (b) shows total event snowfall versus the average interception efficiency for each event. Snowfall data was measured using the snowfall gauge at Powerline Station while throughfall data was measured using the three subcanopy lysimeters used for the calculation of canopy storage and interception efficiency. These lysimeters, each denoted by a distinct color (black, red, and green), correspond to varying canopy coverage (0.73, 0.78, and 0.82, respectively).

:::
![Scatter plots of discrete observations (blue dots) and binned data (black dots with error bars) of meterology, canopy load, and hydrometor characteristics versus snow interception efficiency. Panels show (A) air temperature, (B) relative humidity, (C) wind speed, (D) initial canopy snow load (the snow load observed at the beginning of the timestep), (E) hydrometeor diameter, (F) hydrometeor velocity. The black open circles show the mean of each bin and the error bars represent the standard deviations. The data were filtered to include observations with a snowfall rate > 0 mm/hr, throughfall rate > 0.05 mm/hr to mimimize noise and a snowfall rate > the subcanopy lysimeter throughfall rate to minimize observations with unloading. Periods of unloading and melt were also removed through careful analysis of the weighed tree, subcanopy lysimeters, and timelapse imagery.](figs/automated_snowfall_event_periods/troughs_met_vs_IP_bin.png){#fig-lai-met-ip}

## The influence of forest structure on snow interception

```{r, include=FALSE}
# returns angle in degrees from zenith
traj_angle_deg <- function(wind_speed, velocity){
  slope <- wind_speed/velocity
  angle_deg <- atan(slope) * 180 / pi

  return(angle_deg)
}
# MET
snowing_met <- readRDS('data/event_met/lidar_events_met_avgs_snowing.rds') |> 
  filter(event_id == '2023-03-14')

ft_ws_avg <- snowing_met |> 
  pull(`mean FT Wind Speed (m/s)`) |> 
  round(2)
pwl_ws_avg <- snowing_met |> 
  pull(`mean PWL Wind Speed (m/s)`) |> 
  round(2)
wd <- snowing_met |> 
  pull(`mean FT Wind Dir. (°)`) |> 
  round()
hm <- 0.9 # mean measured event parsivel
ft_ta <- traj_angle_deg(ft_ws_avg, hm) |> 
  round(0)
pwl_ta <- traj_angle_deg(pwl_ws_avg, hm) |> 
  round(0)

# CANOPY 
ft_mean_ht <- readRDS('../../analysis/lidar-processing/data/lidR_canopy_metrics/frs_s_mean_tree_height.rds') |> 
  round(2)

pwl_e_mean_ht <- readRDS('../../analysis/lidar-processing/data/lidR_canopy_metrics/pwl_e_mean_tree_height.rds') |> 
  round(2)

# HEMI STATS
vox_config_id <- "23_072_vox_len_0.25m_sa_gridgen_v2.0.0_sa"
pwl_hemi_stat <-
  readRDS(
  paste0(
    '../../analysis/lidar-processing/data/hemi_stats/hemi_raw_theta_phi_for_rho_s_upper_2_5th_percentile_',
    vox_config_id,
    "_",
    'PWL_E',
    '.rds'
  ))

ft_hemi_stat <-
  readRDS(
  paste0(
    '../../analysis/lidar-processing/data/hemi_stats/hemi_raw_theta_phi_for_rho_s_upper_2_5th_percentile_',
    vox_config_id,
    "_",
    'FSR_S',
    '.rds'
  ))

pwl_phi_to <- max(pwl_hemi_stat$phi_d) |> round()
ft_phi_to <- max(ft_hemi_stat$phi_d) |> round()
pwl_theta_to <- max(pwl_hemi_stat$theta_d) |> round()
ft_theta_to <- max(ft_hemi_stat$theta_d) |> round()
pwl_theta_from <- min(pwl_hemi_stat$theta_d) |> round()
ft_theta_from <- min(ft_hemi_stat$theta_d) |> round()
```

UAV lidar interception efficiency and canopy structure metrics measurements collected spatially across the study site provided insights on how the forest canopy governed snow accumulation for a snowfall event that totalled 28.4 mm. This snowfall event was characterized by a transition from low rates of snowfall and air temperature near 0°C to higher rates of snowfall late afternoon on March 13 and coincided with air temperatures around -2.5 °C. The average wind speed of `r ft_ws_avg` m/s and direction of 188° was observed 4.2 m above the ground. The spatial distribution in I/P across the study site, calculated using @eq-ip and $\Delta SWE_{tf}$ from UAV-lidar measurements and $\Delta sf$ from the Pluvio snowfall gauge is shown in @fig-lidar-ip. Greater I/P is observed on the north (lee) side of individual trees which is interpreted to be a result of non vertical hydrometeor trajectories from the steady southerly winds observed over this event. This effect is more apparent within the PWL forest plot, compared to the FT forest plot (@fig-lidar-ip). The average height of the canopy surrounding the plot to the east of the PWL station is `r pwl_e_mean_ht` and surrounding the forest plot around the FT Station is `r ft_mean_ht`. Based on the large difference in forest structure it is interpreted that the differences in I/P between the two plots are primarily a result of differences in forest structure rather than localized wind flow patterns.

![UAV Lidar interception efficiency calculated over the March 13, 2023 24 hr snowfall event for the FT (left) and PWL forest plots (right) at a 25 cm resolution. Transparent areas represent grids that did not have any lidar ground returns (i.e., under dense canopy proximal to tree trunks) or have been masked due to disturbance and thus have no throughfall measurement for the I/P calculation.](../../analysis/lidar-processing/figs/maps/facet_ft_pwl_23_072_23_073_v2.0.0_saip_normalised_resample_0.25.png){#fig-lidar-ip}

Hemisphere plots generated for both the FT and PWL forest plots are shown in @fig-hemi-ip-cc. These plots illustrate the high correlation between $C_p$ and interception efficiency towards the southern portion of the hemisphere which aligns with the average wind direction over the event. The upper 97.5th percentile of $\rho_p$, was found between zenith angles of 0° – `r pwl_phi_to`° and azimuth angles of `r pwl_theta_from`° – `r pwl_theta_to`° for the PWL forest plot. For the FT forest plot, a similar high correlation zone was observed between ranges of zenith angles of 0° – `r ft_phi_to`° and azimuth angles of `r ft_theta_from`° – `r ft_theta_to`°. The high $\rho_p$ found for non vertical zenith angles of up to 30° for both PWL and FT is interpreted to be a result of inclined hydrometeor trajectories shifting the portion of the hemisphere that governed snow accumulation for each grid cell. $\rho_p$ could only be computed where interception efficiency values were available as shown in @fig-lidar-ip. Thus relatively low $\rho_p$ values are shown for near nadir zenith angles in @fig-hemi-ip-cc where higher values would be expected if throughfall measurements were available. However, this does not change the interpretation of the results.

The predicted hydrometeor trajectory angle of the event, calculated using @eq-ta, was `r ft_ta`°, considering an event measured wind speed of `r ft_ws_avg` at FT Station and hydrometeor velocity of 0.9 m s^-1^ from PWL Station. This predicted hydrometeor trajectory angle is 25° more horizontal compared to the area of the hemisphere observed to have high correlation between leaf contact area and interception efficiency in @fig-hemi-ip-cc. This may be partially explained by three factors, 1) the height of the wind speed measurement at 4.2 m may be higher than the dominant wind flow important for controlling hydrometeor trajectory and subsequent interception (i.e., the conical shape of needleleaf trees have a larger surface area closer to the ground), 2) extrapolating wind speed measured within sparse canopy (FT Station) to regions characterized by higher stem density across the study site, where wind speed may have been lower leading to more vertical trajectory angles, and 3) the theory proposed in @eq-ta assumes a linear hydrometeor trajectory, and does not consider non-linear patterns such as wind flow wrapping around tree elements, turbulent flow, or differences in wind speed with height. 

![The Pearson Correlation Coefficient between rasters (25 cm resolution) of interception efficiency and leaf contact area for each grid cell across the study site for each azimuth angles (0°, 1°, ..., 359°) and zenith angles (0°, 1°, ..., 90°) for the FT (left) and PWL (right) forest plots.](../../analysis/lidar-processing/figs/voxrs/hemis/full_hemi_rho_p_cor_lca_ip_23_072_vox_len_0.25m_sa_gridgen_v2.0.0_sa_ft_pwl_.png){#fig-hemi-ip-cc}

@fig-lca-vs-ip shows that the linear relationship between leaf contact area and interception efficiency, when resampled to a 5 m resolution, is stronger when leaf contact area is adjusted for the observed shift in hydrometeor trajectory, with zenith angles (0° – 30°) and azimuth angles (170° – 220°), compared to the nadir leaf contact angle (zenith angle of 0°). The strong association between adjusted leaf contact area has the potential to be a predictor of interception efficiency across this study site. The proposed equation to represent this linear relationship is:

$$
  \frac{I}{P} = C_p(C_c, \theta_h) \cdot a
$${#eq-lca-ip}

where $a$ is an efficiency constant which determines the fraction of snowflakes that contact the canopy and are stored in the canopy (i.e., intercepted). Theoretical basis of the $a$ value is that the association between leaf contact area and interception efficiency, as shown in @fig-lca-vs-ip, does not follow a 1:1 line as snow flakes may float through gaps in branch and/or bounce off the canopy elements. In the observations collected over the 24 hour snowfall event presented here, some downward unloading of snow may have lowered the $a$ value and in reality may be slightly higher if considering measurements of I/P without unloading.

Model error statistics are presented in @tbl-ip-mod-err, calculated between the predicted interception efficiency using @eq-lca-ip with different values of $a$, and observed interception efficiency. These statistics demonstrate that the model improved when adjusted for the hydrometeor trajectory angle with R^2 values of 0.7 and 0.61 for the FT and PWL forest plots, respectively. This adjustment represents a significant improvement from the nadir PWL model, which had an R^2 of 0.29, and a modest improvement for FT, which had an R^2 of 0.52.

![Scatter plots showing the relationship between leaf contact area and interception efficiency resampled to a 5 m grid cell resolution. The Adjusted plots (first column) show leaf contact area averaged over zenith angles (0° – 30°) and azimuth angles (170° – 220°). The Nadir plots (second column) show leaf contact area measured from a zenith angle of 0°. The rows of plots correspond to the FT and PWL forest plots respectively. The light gray line shows a 1:1 line and the red line shows the ordinary least squares linear regression fit to the observed data. ](../../analysis/lidar-processing/figs/voxrs/scatter/pwl_ft_lca_vs_ip_phi_nadir_adjusted_resample_w_mods_5m.png){#fig-lca-vs-ip}

```{r tbl-ip-mod-err, echo=FALSE}
#| label: tbl-ip-mod-err
#| tbl-cap: "Model error statistics provided for predictions of interception efficiency using @eq-lca-ip and for different $a$ values, as shown in the Model Slope column. Statistics are provided for the PWL and FT forest plots, using leaf contact area canopy metrics adjusted to zenith angles of (0° – 30°) and azimuth angles of (170° – 220°) and nadir zenith angle of 0°. The Mean bias is the difference in the model and observed values, MAE is the mean of the absolute error, RMS Error is the root mean squared error and r^2 is the coeficient of determination."

mod_error <- readRDS('../../analysis/lidar-processing/data/models/lca_vs_ip_model_error_ft_pwl_nadir_adj.rds')

mod_error |> 
  knitr::kable()
  # knitr::kable(booktabs = TRUE,
  #              format = 'latex')

```

## Combined Effects of Meteorology and Forest Structure

```{r, include=FALSE}
library(dplyr)
hemi_stats <- readRDS('../../analysis/lidar-processing/data/hemi_stats/full_voxrs_not_filtered_to_swe_traj_angle_w_lca_23_072.rds') |> 
  mutate(find_wind = abs(1-wind_speed))

select_wind_speed <- 1
pwl <- hemi_stats |> filter(plot_name == 'PWL')
ft <- hemi_stats |> filter(plot_name == 'FT')
pwl_inc <- pwl$lca_inc[which.min(abs(select_wind_speed-pwl$wind_speed))]
ft_inc <- ft$lca_inc[which.min(abs(select_wind_speed-ft$wind_speed))]
ta <- pwl$traj_angle[which.min(abs(select_wind_speed-pwl$wind_speed))]

pwl_nadir <- pwl$lca_nadir |> unique()
ft_nadir <- ft$lca_nadir |> unique()
pwl_perc_inc <- pwl_inc / pwl_nadir * 100
ft_perc_inc <- ft_inc / ft_nadir * 100

nls_coefs <- readRDS('../../analysis/lidar-processing/data/models/ta_vs_lca_nls_coefs.rds')
```

The observed increase in leaf contact area for trajectory angles [0°, 1°, ..., 90°] and wind speeds [0 to 10 (m/s)] is shown in @fig-finclca-ht-ws. Increasing the hydrometeor trajectory angle results in a substantial rise in the observed leaf contact area. For example, with a wind speed of `r select_wind_speed` m s^-1^ which leads to a trajectory angle of `r ta |> round(0)`° using @eq-ta, the leaf contact area increased by a fraction of `r pwl_inc |> round(2)` and `r ft_inc |> round(2)` for the PWL and FT forest plots respectively in @fig-lca-ht-ws (right panel). This is a percent increase in the plot leaf contact area from nadir of `r pwl_perc_inc |> round(0)`% and `r ft_perc_inc |> round(0)` for PWL and FT respectively. 

<!-- These figures are generated under the lidar-processing project using scripts 11-13. This generates 100's of GB of data on RAM and therefore scripts 11 and 12 are run on copernicus and the resulting df is sent over to local to run script 13. Can run this locally if we use a larger step across phi and theta angles.  -->

![Plots showing the increase in measured leaf contact area with hydrometeor trajectory angle (left) and mid canopy wind speed (right). Hydrometeor Trajectory Angle is measured as degrees from zenith. Mid canopy wind speed is calculated as a function of hydrometeor trajectory angle by rearanging @eq-ta. The solid lines (obs) represent the observed leaf contact area from VoxRS, the dashed lines (mod) represent predictions from a non-linear least squares regression (nls, blue) and ordinary least squares regression (lm, green) on the VoxRS observed data, and the dotted lines (HP98) represent the predictions from Equation 10 in @Hedstrom1998a. The line color represents the forest plot, FT (black), PWL (red) and the non-linear least squares regression fit to both plots in (green).](../../analysis/lidar-processing/figs/voxrs/scatter/WITH_TREEWELLS_traj_angle_and_wind_phiby_1_thetaby_2_traj_angle_wind_speed_vs_fractional_inc_lca_snow_off_w_mods_hp98_mean_sd_23_072.png){#fig-finclca-ht-ws}

The slope in the rise of leaf contact area with increasing trajectory angle, shown in @fig-finclca-ht-ws, is similar for both forest plots FT and PWL until trajectory angles reach approximately 60°. Beyond 60°, the PWL rate of increase slows as it approaches one, while the FT plot initially shows a higher rate of increase before a declining. A non-linear least squares regression using a logistic function and a ordinary least squares regression using a linear function were fit to the FT and PWL observations and are shown in @fig-finclca-ht-ws. The @Hedstrom1998a increase in leaf contact area with trajectory shown in @fig-finclca-ht-ws fails to represent the VoxRS observations. The logistic function used to model the observations is:  

$$
C_{inc} = \left(
\frac{C^{max}_{inc}}{1 + e ^ {\left(\frac{\theta_0 - \theta_h}{\text{k}}\right)}} - \frac{C^{max}_{inc}}{1 + e ^ {\left(\frac{\theta_0}{\text{k}}\right)}}
\right)
$${#eq-lca-inc}

where, $C_{inc}$ is the increase in leaf contact area, $C^{max}_{inc}$ is the maximum value of $C_p$, $\theta_0$ is the x value of the sigmoid midpoint and $k$ is the logistic growth rate or steepness of the curve. Resulting coefficients for $LCA_{max}$, $theta_0$ and $k$ derived across the VoxRS observations from the PWL and FT forest plots were `r nls_coefs['Asym'] |> as.numeric() |> round (3)`, `r nls_coefs['xmid'] |> as.numeric() |> round (3)` and `r nls_coefs['scal'] |> as.numeric() |> round (3)` respectively.

$$
C_p = C_c + C_{inc}
$${#eq-lca-ac}

Simulated leaf contact area using @eq-lca-ac is shown in @fig-lca-ht-ws for trajectory angles [0°, 1°, ..., 90°] and wind speeds [0 to 10 (m/s)] and is shown to align well with the VoxRS observations for trajectory angles below 60°. Model error statistics shown in @tbl-lca-mod-err, indicate that @eq-lca-ac demonstrated slightly better performance with a mean bias and RMSE of -0.005 and 0.033 respectively, compared to the linear regression, with a mean bias of 0.006 and an RMSE of 0.044. The @Hedstrom1998a method exhibited very poor estimates of $C_p$.

<!-- These figures are generated under the lidar-processing project using scripts 11-13. This generates 100's of GB of data on RAM and therefore scripts 11 and 12 are run on copernicus and the resulting df is sent over to local to run script 13. Can run this locally if we use a larger step across phi and theta angles.  -->

![Plots showing the relationship between hydrometeor trajectory angle (left) and mid canopy wind speed (right) with leaf contact area. Hydrometeor Trajectory Angle is measured as degrees from zenith. Mid canopy wind speed is calculated as a function of hydrometeor trajectory angle by rearanging @eq-ta. The solid lines (obs) represent the observed leaf contact area from VoxRS, the dashed lines (mod) represent predictions from @eq-lca-ac, and the dotted lines (HP98) represent the predictions from Equation 10 in @Hedstrom1998a. The line color represents the forest plot, FT (black), PWL (red) and the non-linear least squares regression fit to both plots in (green).](../../analysis/lidar-processing/figs/voxrs/scatter/WITH_TREEWELLS_traj_angle_and_wind_phiby_1_thetaby_2_traj_angle_wind_speed_vs_lca_w_mods_w_hp98_mean_sd_23_072.png){#fig-lca-ht-ws}

```{r tbl-lca-mod-err, echo=FALSE}
#| label: tbl-lca-mod-err
#| tbl-cap: "Model error statistics calculated for the prediction of leaf contact area from trajectory angle using @eq-lca-inc (nls), using a linear function from the observations in this study (lm), and Equation 10 from @Hedstrom1998a. Mean bias is the difference in the model and observed values, MAE is the mean of the absolute error, RMS Error is the root mean squared error and r^2 is the coeficient of determination."

mod_error <- readRDS('../../analysis/lidar-processing/data/models/lca_obs_mod_error_tbl.rds')

mod_error |> 
  knitr::kable()
  # knitr::kable(booktabs = TRUE,
  #              format = 'latex')
```


# Discussion

The fraction of snowfall intercepted intercepted in this discontinuous subalpine forest is shown to be governed by forest structure, wind speed and initial canopy snow load. Occasionally the meteorology of a given event was observed to outweigh the differences in forest structure between different locations.

@Satterlund1967 showed that interception efficiency increases as the canopy fills with snow bridging gaps in the canopy, while later declining due to branch bending and decreased canopy coverage and increased unloading. @Hedstrom1998a and @Storck2002 did not observe this initial increase. Observations from the subcanopy lysimeters here shown in @fig-scl-ip and @fig-lai-met-ip, despite displaying notable scatter, corroborate with the @Satterlund1967 theory. @fig-scl-ip and @fig-lai-met-ip indicate that initial canopy snow load exerted an important control on interception efficiency. A significant change of approximately 20% was detected between peak snow loads exceeding 20 mm (associated with low interception efficiency) and optimal snow loads of near 7 mm (associated with high interception efficiency). However, the decline in interception efficiency at high canopy snow loads in @fig-scl-ip and @fig-lai-met-ip was rate much slower than has been observed by previous studies [@Hedstrom1998a; @Satterlund1967; @Moeser2015]. At higher canopy snow loads, several studies suggest that interception efficiency declines [@Hedstrom1998a; @Satterlund1967; @Moeser2015], based on the premise of reduced canopy coverage due and catch efficiency to branch bending. However, the strong exponential decline in the interception efficiency observed with increasing event snowfall (see fig X in @Cebulski2024) may be a result of increased unloading rates as branches bend down. This may be attributed to the care taken in the observations presented here to minimize inclusion of unloading or ablation in the throughfall measurements. The longer duration between site visits in [@Satterlund1967; @Hedstrom1998a] increase the likelihood of ablation in their throughfall measurements compared to the automated 15 minute measurements in this study. This potential inclusion of unloading within the interception parameterizations provided in [@Hedstrom1998a; @Satterlund1967; @Moeser2015] may lead to double counting of unloading when combined with an additional unloading parameterization as in [@Hedstrom1998a]. Still, if interception efficiency is expected to decline due to an associated decrease in canopy coverage from branch bending, as observed in @fig-lai-met-ip, it may be appropriate to have some decline in interception efficiency at higher canopy loads while also having a separate parameterization to increase unloading with canopy snow load.

Existing theories suggests either a positive [@Storck2002] or negative [@Hedstrom1998a] association of air temperature with the maximum canopy storage (see fig. X @Cebulski2024). The findings presented in this study deviate from the relationships outlined in @Hedstrom1998a and @Storck2002. Specifically, both @fig-scl-ip and @fig-lai-met-ip showed an absence of a maximum canopy storage capacity. It is likely that a maximum canopy storage value does exist in the study site but was higher than the observed range of canopy storage values presented here. Additionally, in @fig-lai-met-ip, no relationship between air temperature and interception efficiency was observed. As maximum canopy storage value was not present in @fig-scl-w-sf and @fig-scl-ip, a direct link cannot be made between air temperature and $L_{max}$. However, the absence of a discernible relationship between interception efficiency and air temperature suggests that there might not be an influence on $L_{max}$. This absence could also be explained by the concurrent presence of positive [adhesive and cohesive forces, @Storck2002] and negative [branch bending, @Schmidt1990] relationships. These two opposing effects could balance each other out, resulting in no observable effect on interception efficiency in the observations presented in @fig-lai-met-ip. It is also plausible that the influence of wind on interception at this site masked any potential effect of air temperature. 

Empirical evidence to support the theory of increased in canopy contact area with increased wind speed [@Hedstrom1998a] has not been provided in the literature. Automated measurements of interception efficiency showed a slight increase in interception efficiency with increasing wind speed (below 1.5 m s^-1^). At wind speeds above 1.5 m s^-1^ interception efficiency was observed to decrease due to an associated increase in unloading. Measurements of interception efficiency collected by UAV-lidar surveys for a snowfall event with a 1.4 m s^-1^ average wind speed showed a large fraction of snow intercepted on the lee side of individual trees as a result of predominately non-vertical hydrometeor trajectory angles. The dominant hydrometeor trajectory angle was shown to be predicted using event wind speed and direction alone. The plot scale canopy coverage was shown to increase substantially as a result of increasing horizontal angle of hydrometers. The increase in plot scale canopy coverage observed in this study, of from 0.4 with zero wind to near complete coverage with midcanopy wind speeds of 2 m s^-1^ is much higher than the increase calculated using the method proposed in @Hedstrom1998a to scale canopy coverage with wind speed. Using Equation 10 in @Hedstrom1998a, an increase of in canopy coverage of 0.03 is calculated using the same wind speed and forest structure and canopy height of 10 m and forested downwind distance of 100 m. The increase in interception efficiency observed away from individual trees in @fig-lidar-ip and the measured increase plot scale canopy coverage using voxel ray sampling in @fig-lca-ht-ws show that Equation 10 in @Hedstrom1998a may not be appropriate for sparse forests. The increase in interception efficiency observed across the forest plots was larger than shown for the subcanopy lysimeters. This may be attributed to the higher canopy coverage above the subcanopy lysimeters which had less room for increased leaf contact area with increasing hydrometeor trajectory. Further investigation is required to test the relationships observed here in dense forest canopies. The large sensitivity of apparent forest cover to mid-canopy wind speed for this discontinuous subalpine forest suggests that this effect should be considered in snow interception models. While, increasing wind has been shown here to increase plot-scale interception, following the deposition of snow in the canopy wind is also known to increase rates of unloading [@Roesch2001; @Bartlett2015]. Poor performance of the @Roesch2001 and @Bartlett2015 algorithms has been shown in the literature [e.g. @Lumbrazo2022]. Since existing studies have not considered the concurrent effect of interception increasing as a result of increasing apparent forest structure due to increasing wind, validations of subsequent ablation parameterizations will likely benefit.

# Conclusions

-   No influence of air temperature, relative humidity, hydrometeor velocity, hydrometeor diameter or canopy storage on interception efficiency was observed.
-   Automated point measurements showed interception efficiency increased with wind speed and canopy snow load as a result of increasing the snow-leaf contact area ratio.
-   At the forest plot scale, UAV lidar measurements showed forest structure is the main factor governing the fraction of intercepted snowfall at a particular site, with meteorological conditions contributing less to variability.
-   Across a range of wind speeds, leaf contact area increased substantially with increasing horizontal trajectory angle but did not increase with snow load. An existing theoretical relationship failed to represent the increase in leaf contact area with wind speed at this site.
-   Snow accumulation and canopy structure metrics from a wind-driven snowfall event revealed canopy structure metrics adjusted for trajectory angle provided a better predictor of interception efficiency compared to nadir canopy coverage.
-   A new snow interception parameterization has been presented which calculates initial interception, before canopy snow ablation, as a function of snowfall rate and snow-leaf contact area ratio. 
-   A second new parameterization is proposed which calculates snow-leaf contact area ratio as a function of nadir canopy coverage, wind speed and canopy snow load.
-   Caution should be taken in using this updated interception routine with existing canopy snow ablation parameterizations as they were developed using earlier snow interception routines that also included ablative processes. 
-   Future work will will involve a canopy snow ablation routine that is revised to work with this new snow interception routine.

\pagebreak

# References
