---
title: "Supporting Information"
format: 
  # docx:
  #   reference-doc: ../config/word_template_hp.docx
  #   number-sections: true
  #   toc: false
  pdf:
    colorlinks: false
    keep-tex: true
    number-sections: true
    toc: false
    fig-pos: H # makes figs appear in the location specified. without this they sometimes appear in the middle of a paragraph.
    linestretch: 1.5 # set inline instead
editor: visual
bibliography: ../../papers/bibtex/library.bib
csl: '../../papers/bibtex/csl-styles/apa-disable-disambiguate-add-names.csl'

---

**Authors:**

A. Cebulski^1^ (ORCID ID - 0000-0001-7910-5056)

J.W. Pomeroy^1^ (ORCID ID - 0000-0002-4782-7457)

^1^Centre for Hydrology, University of Saskatchewan, Canmore, Canada

**Corresponding Author:** A. Cebulski, alexcebulski@gmail.com

```{r, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message=FALSE, warning=FALSE, fig.align='center')

source('scripts/manuscript_values.R')
```

## Detailed Description of UAV-Lidar Methodology

The REIGL miniVUX-2 laser operates at a near infrared wavelength with a laser beam footprint of 0.160 m x 0.05 mm (at 100 m above ground). The accuracy and precision of the miniVUX-2 is described by REIGL for a lab environment of 0.015 m and 0.01 m respectively (at 50 m above ground). The miniVUX-2 was configured with a laser pulse repetition rate of 200 kHz, field of view of 360°, scan speed of 31.09 revolutions s^-1^ and an angular step width of 0.0558°, resulting in an expected an average point cloud density of 107 returns m^-2^ for each flight path.

Georeferenced point clouds with x, y, and z coordinates for each laser return were generated following methods outlined by @Harder2020 and @Staines2023 to reconcile survey lidar, IMU and GNSS data. A ground-based GNSS system was positioned on a permanent monument during each survey and underwent precise point positioning (PPP) correction by @ppp2024. Differential GNSS correction of the UAV trajectory was conducted using the ground-based PPP GNSS observations and the POSPac UAV software. The UAV-lidar point clouds were then transformed from a sensor referenced coordinate system to a georeferenced coordinate system (EPSG:32611 - WGS 84 / UTM zone 11N) using the RIEGL Riprocess Software. A vertical offset of up to 6 cm between UAV-lidar flight lines was observed in the resulting point clouds on March 13^th^ and 14^th^, 2024 and was attributed to IMU position drift. This offset between flight lines was corrected using the BayesStripAlign software v2.24 [@BayesMap2024], which reduces relative and absolute uncertainties in the vertical elevation of the point cloud using the ground control points (GCP) collected across the study site using a differential GNSS rover. 

Quality control, ground classification and calculation of the change in between two UAV-lidar point clouds was conducted using the LAStools software package [@LAStools2024]. The ground classification was conducted using the "lasground_new" function [@LAStools2024] for both the pre and post snowfall event point clouds, with a step size set to 2 m and 8 substeps (ultra_fine setting). The offset and spike options were set to remove points that are more than 0.1 m above or below the initial ground surface estimate surface which "lasground_new" fits to the last returns. This function is based on an algorithm outlined by @Axelsson2000, describing the process of making the initial ground surface element.

The change in elevation between the two UAV-lidar surveys was interpreted as the increase in snow accumulation, $\Delta HS$ over the snowfall event. This change was calculated using a point-to-grid subtraction method, using the "lasheight" function from the @LAStools2024 software, as in @Deems2013 and @Staines2023. The pre snowfall event point cloud from "lasground_new" by "lasheight" to construct a "ground" TIN. Subsequently, the height of each post snowfall event point above the ground TIN, resulting in a point cloud representing $\Delta HS$. This point cloud was then converted into a raster of $\Delta HS$ with a grid cell resolution of 5 x 5 cm using the "las2dem" function. Further quality control and resampling of the 5 cm raster of $\Delta HS$ was conducted using the 'Terra' R package [@Hijmans2024]. Areas that were disturbed over the snowfall event during the in-situ snow survey and values that exceeded the .999th quantile were removed. To help remove any remaining noise a 0.25 m $\Delta HS$ raster was generated by computing the median of the 5 cm $\Delta HS$ values within each 0.25 m grid cell.

A comparison of UAV-liar and in-situ snow survey measurements over the March 13–14th snowfall event and associated error metrics are shown in @fig-lidar-vs-fsd-sd.

![UAV-liar and in-situ snow survey measurements over the March 13–14th snowfall event and associated error metrics.](figs/external_figures/23_073_v2.0.0_sa_snow_depth_Hs_insitu_vs_Hs_lidar_resamp_bias_corrected.png){#fig-lidar-vs-fsd-sd}

## Linear Regression Models Through the Origin

@Kozak1995 noted, the default *R*^2^ value provided for least squares models forced through the origin by many statistical packages can be misleading. Therefore, these *R*^2^ values were adjusted using Equation 10 in @Kozak1995 and two statistical tests as described by @Kozak1995 were used to verify whether a no-intercept model (forced through the origin) was appropriate for this data compared to a with-intercept model. The first test evaluated if the intercept of the with-intercept was significantly different from zero using p-value provided by the 'summary' function from the 'stats' package in R [@R2024]. The second test examined if there was a significant difference between the no-intercept and with-intercept models by testing if the residual sum of squares was different between the no-intercept and full model, assessed via Equation 15 in @Kozak1995. If the first test indicated a significant difference, and the second did not, the no-intercept model could be deemed statistically justified [@Kozak1995]. 

## Wind Speed Profile

The displacement height ($d_0$, m) and roughness length of momentum ($z_0$, m) were estimated over five events where the anemometers were known to be clean of snow. The mean wind speed of each event for the three different anemometers is shown in @fig-ws-events.

![Wind profiles showing the average wind speed at differing heights above the surface snowpack. Wind speeds were averaged for three anemometers over five events when the anemometers were known to be clean of snow.](figs/supplement/FFT_wind_profile_raw_obs.png){#fig-ws-events}

\pagebreak

## References
